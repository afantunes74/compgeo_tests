
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>4. Coordinate systems and vectors &#8212; Computational Geosciences</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="5. Transformations" href="ch05_transformations.html" />
    <link rel="prev" title="3. Geological features" href="ch03_geological_features.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Computational Geosciences</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to the Computational Geosciences resource
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  GET STARTED
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="preface.html">
   Preface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="changelog.html">
   Changelog
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="todo.html">
   TODOs
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  CONTENTS
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="ch01_computation_geosciences.html">
   1. Computation in Geosciences
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch02_understanding_location.html">
   2. Understanding location
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch03_geological_features.html">
   3. Geological features
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   4. Coordinate systems and vectors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch05_transformations.html">
   5. Transformations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch06_tensors.html">
   6. Tensors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch07_stress.html">
   7. Stress
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch08_strain.html">
   8. Strain
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch09_elasticity.html">
   9. Elasticity
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  THE COMPANION NOTEBOOKS
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch01/ch01_nb01.html">
   Introduction to Python and Jupyter Notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch02/ch02_nb01.html">
   Tissotâ€™s Indicatrix
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch02/ch02_nb02.html">
   Defining the coordinate reference system
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch02/ch02_nb03.html">
   Coordinate conversion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch02/ch02_nb04.html">
   Coordinate transformation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch02/ch02_nb05.html">
   Transform locations from lat-long to World Mercator
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch03/ch03_nb01.html">
   Plotting lines and poles in a stereonet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch03/ch03_nb02.html">
   Maximum strike error vs. dip graph
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch03/ch03_nb03.html">
   Maximum trend error vs. dip graph [1]
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch03/ch03_nb04.html">
   Maximum trend error vs. dip graph [2]
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch04/ch04_nb01.html">
   Vector components, magnitude, and unit vectors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch04/ch04_nb02.html">
   Vector operations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch04/ch04_nb03.html">
   Mean vector
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch04/ch04_nb04.html">
   Angles, intersections, and poles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch04/ch04_nb05.html">
   Three points problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch04/ch04_nb06.html">
   Uncertainties
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch05/ch05_nb01.html">
   Stratigraphic thickness
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch05/ch05_nb02.html">
   Stratigraphic thickness and uncertainties
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch05/ch05_nb03.html">
   Outcrop trace of a plane
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch05/ch05_nb04.html">
   Down-plunge projection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch05/ch05_nb05.html">
   Rotations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch05/ch05_nb06.html">
   Plotting great and small circles using rotations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch06/ch06_nb01.html">
   Best-fit fold axis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch06/ch06_nb02.html">
   Best-fit plane
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch07/ch07_nb01.html">
   Principal axes of stress
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch07/ch07_nb02.html">
   Normal and shear tractions on a plane
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch07/ch07_nb03.html">
   The Mohr circle for stress in 3D
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch08/ch08_nb01.html">
   P and T axes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch08/ch08_nb02.html">
   2D strain from GPS data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch08/ch08_nb03.html">
   2D finite strain from displacement data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch08/ch08_nb04.html">
   Pure shear
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch08/ch08_nb05.html">
   Simple shear
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch08/ch08_nb06.html">
   General shear
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch09/ch09_nb01.html">
   Stresses around a circular hole
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch09/ch09_nb02.html">
   Lithospheric flexure
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch09/ch09_nb03.html">
   Faults as elastic dislocations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch09/ch09_nb04.html">
   Wave propagation
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/afantunes74/compgeo_tests/master?urlpath=lab/tree/ch04_coordinate_systems_vectors.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/afantunes74/compgeo_tests"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/afantunes74/compgeo_tests/issues/new?title=Issue%20on%20page%20%2Fch04_coordinate_systems_vectors.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/ch04_coordinate_systems_vectors.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#coordinate-systems">
   4.1. Coordinate systems
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vectors">
   4.2. Vectors
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vector-components-magnitude-and-unit-vectors">
     4.2.1. Vector components, magnitude, and unit vectors
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vector-operations">
     4.2.2. Vector operations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#geological-features-as-vectors">
   4.3. Geological features as vectors
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-spherical-to-cartesian-coordinates">
     4.3.1. From spherical to Cartesian coordinates
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-cartesian-to-spherical-coordinates">
     4.3.2. From Cartesian to spherical coordinates
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#applications">
   4.4. Applications
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mean-vector">
     4.4.1. Mean vector
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#angles-intersections-and-poles">
     4.4.2. Angles, intersections, and poles
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#three-points-problem">
     4.4.3. Three points problem
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uncertainties">
   4.5. Uncertainties
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   4.6. Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   4.7. References
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Coordinate systems and vectors</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#coordinate-systems">
   4.1. Coordinate systems
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vectors">
   4.2. Vectors
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vector-components-magnitude-and-unit-vectors">
     4.2.1. Vector components, magnitude, and unit vectors
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vector-operations">
     4.2.2. Vector operations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#geological-features-as-vectors">
   4.3. Geological features as vectors
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-spherical-to-cartesian-coordinates">
     4.3.1. From spherical to Cartesian coordinates
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-cartesian-to-spherical-coordinates">
     4.3.2. From Cartesian to spherical coordinates
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#applications">
   4.4. Applications
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mean-vector">
     4.4.1. Mean vector
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#angles-intersections-and-poles">
     4.4.2. Angles, intersections, and poles
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#three-points-problem">
     4.4.3. Three points problem
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uncertainties">
   4.5. Uncertainties
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   4.6. Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   4.7. References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="coordinate-systems-and-vectors">
<span id="ch04"></span><h1><span class="section-number">4. </span>Coordinate systems and vectors<a class="headerlink" href="#coordinate-systems-and-vectors" title="Permalink to this headline">#</a></h1>
<p>Strike and dip, and trend and plunge, are a convenient way to represent the orientation of planes and lines. However, it is difficult to handle these measurements using computation. In this chapter, we will see how to convert linear features (lines and poles to planes) from spherical (trend and plunge) to Cartesian (direction cosines) coordinates, thus representing these features as vectors. This facilitates the analysis of planes and lines using linear algebra and computation, and it will allow us to solve a range of interesting problems using vector operations.</p>
<section id="coordinate-systems">
<span id="ch04-1"></span><h2><span class="section-number">4.1. </span>Coordinate systems<a class="headerlink" href="#coordinate-systems" title="Permalink to this headline">#</a></h2>
<p>Any point or location in space can be represented by the coordinates of the point with respect to the three orthogonal axes of a Cartesian coordinate system. We will call the axes of this coordinate system <span class="math notranslate nohighlight">\(\mathbf{X_1}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{X_2}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{X_3}\)</span> (<a class="reference internal" href="#ch04-fig01"><span class="std std-numref">Figure 4.1</span></a>). In addition, we will follow a right-handed naming convention: If you hold your right hand so that your thumb points in the positive direction of the first axis <span class="math notranslate nohighlight">\(\mathbf{X_1}\)</span>, your other fingers should curl from the positive direction of the second axis <span class="math notranslate nohighlight">\(\mathbf{X_2}\)</span> toward the positive direction of the third axis <span class="math notranslate nohighlight">\(\mathbf{X_3}\)</span> (<a class="reference internal" href="#ch04-fig01"><span class="std std-numref">Figure 4.1</span></a>). Such a coordinate system is called a right-handed coordinate system.</p>
<p>In geosciences, we use mainly two types of right-handed coordinate systems: An east (<strong>E</strong>), north (<strong>N</strong>), up (<strong>U</strong>) coordinate system (<a class="reference internal" href="#ch04-fig01"><span class="std std-numref">Figure 4.1</span></a>a), and a north (<strong>N</strong>), east (<strong>E</strong>), down (<strong>D</strong>) coordinate system (<a class="reference internal" href="#ch04-fig01"><span class="std std-numref">Figure 4.1</span></a>b). The <strong>ENU</strong> coordinate system is used in GIS and Geophysics when dealing with elevations (e.g. topography), while the <strong>NED</strong> coordinate system is used in Structural Geology where, by convention, angles measured downwards from the horizontal (e.g. plunge of a downward pointing line) are considered positive. In this chapter, we will use mainly the <strong>NED</strong> coordinate system, but when dealing with topography and elevations, we will use the <strong>ENU</strong> coordinate system.</p>
<figure class="align-default" id="ch04-fig01">
<a class="reference internal image-reference" href="_images/ch04_fig01.png"><img alt="_images/ch04_fig01.png" src="_images/ch04_fig01.png" style="width: 550px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.1 </span><span class="caption-text">Right-handed Cartesian coordinate systems. <strong>a.</strong> The <strong>ENU</strong> coordinate system used when dealing with topography, and <strong>b.</strong> The <strong>NED</strong> coordinate system used in Structural Geology. Modified from Allmendinger et al. (2012).</span><a class="headerlink" href="#ch04-fig01" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="vectors">
<span id="ch04-2"></span><h2><span class="section-number">4.2. </span>Vectors<a class="headerlink" href="#vectors" title="Permalink to this headline">#</a></h2>
<section id="vector-components-magnitude-and-unit-vectors">
<span id="ch04-2-1"></span><h3><span class="section-number">4.2.1. </span>Vector components, magnitude, and unit vectors<a class="headerlink" href="#vector-components-magnitude-and-unit-vectors" title="Permalink to this headline">#</a></h3>
<p>A line from the origin of the Cartesian coordinate system to a point in space is the position vector of the point. A <em>vector</em> is an object that has both a magnitude and a direction. Displacement, velocity, force, acceleration, and poles to planes, are all vectors. A vector is defined by its three components with respect to the axes of the Cartesian coordinate system; these are the projections of the vector onto the axes <span class="math notranslate nohighlight">\(\mathbf{X_1}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{X_2}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{X_3}\)</span> (<a class="reference internal" href="#ch04-fig02"><span class="std std-numref">Figure 4.2</span></a>a).</p>
<figure class="align-default" id="ch04-fig02">
<a class="reference internal image-reference" href="_images/ch04_fig02.png"><img alt="_images/ch04_fig02.png" src="_images/ch04_fig02.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.2 </span><span class="caption-text"><strong>a.</strong> Components of a vector. <strong>b.</strong> Direction cosines of a unit vector. Modified from Allmendinger et al. (2012).</span><a class="headerlink" href="#ch04-fig02" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>This is expressed by the following equation:</p>
<div class="math notranslate nohighlight" id="equation-ch04-eq01">
<span class="eqno">(4.1)<a class="headerlink" href="#equation-ch04-eq01" title="Permalink to this equation">#</a></span>\[
\mathbf{v} = [v_1,v_2,v_3]
\]</div>
<p>We use lower capital, bold letters to denote vectors. The magnitude (length) of a vector can be computed using Pythagorasâ€™ theorem:</p>
<div class="math notranslate nohighlight" id="equation-ch04-eq02">
<span class="eqno">(4.2)<a class="headerlink" href="#equation-ch04-eq02" title="Permalink to this equation">#</a></span>\[
v = \left(v_1^2 + v_2^2 + v_3^2 \right)^{1/2}
\]</div>
<p>The result is just a number or scalar. We use regular, non-capital letters to denote scalars. If we divide each of the components of a vector by its magnitude, the result is a unit vector, a vector with the same orientation but with a magnitude (length) of one (<a class="reference internal" href="#ch04-fig02"><span class="std std-numref">Figure 4.2</span></a>b):</p>
<div class="math notranslate nohighlight" id="equation-ch04-eq03">
<span class="eqno">(4.3)<a class="headerlink" href="#equation-ch04-eq03" title="Permalink to this equation">#</a></span>\[
\mathbf{\hat{v}} = \left[\frac{v_1}{v}, \frac{v_2}{v}, \frac{v_3}{v} \right]
\]</div>
<p>We use a hat to indicate unit vectors. There is a very interesting property of unit vectors; the components of a unit vector are the cosines of the angles the vector makes with the axes of the coordinate system (<a class="reference internal" href="#ch04-fig02"><span class="std std-numref">Figure 4.2</span></a>b):</p>
<div class="math notranslate nohighlight" id="equation-ch04-eq04">
<span class="eqno">(4.4)<a class="headerlink" href="#equation-ch04-eq04" title="Permalink to this equation">#</a></span>\[
\mathbf{\hat v} = [\cos\alpha,\cos\beta,\cos\gamma]
\]</div>
<p>these are called the <em>direction cosines</em> of the vector. By convention, <span class="math notranslate nohighlight">\(\cos\alpha\)</span> is the direction cosine of the vector with respect to <span class="math notranslate nohighlight">\(\mathbf{X_1}\)</span>, <span class="math notranslate nohighlight">\(\cos\beta\)</span> is the direction cosine of the vector with respect to <span class="math notranslate nohighlight">\(\mathbf{X_2}\)</span>, and <span class="math notranslate nohighlight">\(\cos\gamma\)</span> is the direction cosine of the vector with respect to <span class="math notranslate nohighlight">\(\mathbf{X_3}\)</span> (<a class="reference internal" href="#ch04-fig02"><span class="std std-numref">Figure 4.2</span></a>b).</p>
<p>In Python, we can use the NumPy <code class="docutils literal notranslate"><span class="pre">linalg.norm</span></code> function to compute the magnitude of a vector, and convert the vector to a unit vector as illustrated in the following notebook <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/notebooks/ch4-1.ipynb">ch4-1</a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import numpy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">linalg</span> <span class="k">as</span> <span class="n">la</span>  <span class="c1"># Import linear algebra functions</span>


<span class="c1"># Make vector</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Vector:&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

<span class="c1"># Magnitude of the vector</span>
<span class="n">length</span> <span class="o">=</span> <span class="n">la</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Magnitude of the vector:&quot;</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>

<span class="c1"># Unit vector</span>
<span class="n">v_hat</span> <span class="o">=</span> <span class="n">v</span> <span class="o">/</span> <span class="n">length</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unit Vector:&quot;</span><span class="p">,</span> <span class="n">v_hat</span><span class="p">)</span>

<span class="c1"># Magnitude of unit vector</span>
<span class="n">length</span> <span class="o">=</span> <span class="n">la</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v_hat</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Magnitude of the unit vector:&quot;</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Vector: [1 2 3]
Magnitude of the vector: 3.7416573867739413
Unit Vector: [0.26726124 0.53452248 0.80178373]
Magnitude of the unit vector: 1.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="vector-operations">
<span id="ch04-2-2"></span><h3><span class="section-number">4.2.2. </span>Vector operations<a class="headerlink" href="#vector-operations" title="Permalink to this headline">#</a></h3>
<p>To multiply a scalar times a vector, just multiply each component of the vector by the scalar:</p>
<div class="math notranslate nohighlight" id="equation-ch04-eq06">
<span class="eqno">(4.6)<a class="headerlink" href="#equation-ch04-eq06" title="Permalink to this equation">#</a></span>\[
x\mathbf v = [xv_1, xv_2, xv_3]
\]</div>
<p>This operation is useful, for example, to reverse the direction of a vector; just multiply the vector by -1. To add two vectors, just sum their components:</p>
<div class="math notranslate nohighlight" id="equation-ch04-eq06">
<span class="eqno">(4.6)<a class="headerlink" href="#equation-ch04-eq06" title="Permalink to this equation">#</a></span>\[
\mathbf u + \mathbf v = \mathbf v + \mathbf u = [u_1 + v_1, u_2 + v_2, u_3 + v_3]
\]</div>
<p>Vector addition is commutative but vector subtraction is not. Vector addition and subtraction obey the parallelogram rule, whereby the resulting vector bisects the two vectors to be added or subtracted (<a class="reference internal" href="#ch04-fig03"><span class="std std-numref">Figure 4.3</span></a>a).</p>
<figure class="align-default" id="ch04-fig03">
<a class="reference internal image-reference" href="_images/ch04_fig03.png"><img alt="_images/ch04_fig03.png" src="_images/ch04_fig03.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.3 </span><span class="caption-text"><strong>a.</strong> Vector addition and subtraction. <strong>b.</strong> Cross product of two unit vectors. Modified from Allmendinger et al. (2012).</span><a class="headerlink" href="#ch04-fig03" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>There are two operations that are unique to vectors: the <em>dot product</em> and the <em>cross product</em>. The result of the dot product is a scalar and is equal to the magnitude of the first vector times the magnitude of the second vector times the cosine of the angle between the vectors:</p>
<div class="math notranslate nohighlight" id="equation-ch04-eq07">
<span class="eqno">(4.7)<a class="headerlink" href="#equation-ch04-eq07" title="Permalink to this equation">#</a></span>\[
\mathbf u \cdot\mathbf v = \mathbf v \cdot\mathbf u = uv\cos\theta = u_1v_1 + u_2v_2 + u_3v_3 = u_iv_i
\]</div>
<p>The dot product is commutative. If the two vectors are unit vectors, you can easily see that the dot product is the cosine of the angle between the vectors:</p>
<div class="math notranslate nohighlight" id="equation-ch04-eq08">
<span class="eqno">(4.8)<a class="headerlink" href="#equation-ch04-eq08" title="Permalink to this equation">#</a></span>\[
\mathbf{\hat u} \cdot\mathbf{\hat v} = \cos\theta = u_1v_1 + u_2v_2 + u_3v_3
\]</div>
<p>or in terms of the direction cosines of the vectors:</p>
<div class="math notranslate nohighlight" id="equation-ch04-eq09">
<span class="eqno">(4.9)<a class="headerlink" href="#equation-ch04-eq09" title="Permalink to this equation">#</a></span>\[
\mathbf{\hat u} \cdot\mathbf{\hat v} = \cos\theta = cos\alpha_1\cos\alpha_2 + \cos\beta_1\cos\beta_2 + \cos\gamma_1\cos\gamma_2
\]</div>
<p>which as we will see later, it is a great way to find the angle between two unit vectors.</p>
<p>The result of the cross product is another vector. This vector is perpendicular to the other two vectors, and it has a magnitude equal to the product of the magnitudes of the vectors times the sine of the angle between the vectors:</p>
<div class="math notranslate nohighlight" id="equation-ch04-eq10">
<span class="eqno">(4.10)<a class="headerlink" href="#equation-ch04-eq10" title="Permalink to this equation">#</a></span>\[
\mathbf u\times\mathbf v = uv\sin\theta\mathbf{\hat l} = [u_2v_3 - u_3v_2, u_3v_1 - u_1v_3, u_1v_2 - u_2v_1]
\]</div>
<p>The cross product is not commutative. If the vectors are unit vectors, the length of the resulting vector is equal to the sine of the angle between the vectors (<a class="reference internal" href="#ch04-fig03"><span class="std std-numref">Figure 4.3</span></a>b). The new vector obeys a right-hand rule; for <span class="math notranslate nohighlight">\(\mathbf u\times\mathbf v\)</span>, the fingers curl from <span class="math notranslate nohighlight">\(\mathbf u\)</span> towards <span class="math notranslate nohighlight">\(\mathbf v\)</span> and the thumb points in the direction of the resulting vector, and vice versa (<a class="reference internal" href="#ch04-fig03"><span class="std std-numref">Figure 4.3</span></a>b).</p>
<p>In Python, these operations are easy to perform using the NumPy library as shown in the following notebook <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/notebooks/ch4-2.ipynb">ch4-2</a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import numpy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="c1"># Make vectors</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;u =&quot;</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;v =&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

<span class="c1"># Scalar multiplication of vector</span>
<span class="n">sv</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">u</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3 * u =&quot;</span><span class="p">,</span> <span class="n">sv</span><span class="p">)</span>

<span class="c1"># Sum of vectors</span>
<span class="n">vsum</span> <span class="o">=</span> <span class="n">u</span> <span class="o">+</span> <span class="n">v</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;u + v =&quot;</span><span class="p">,</span> <span class="n">vsum</span><span class="p">)</span>

<span class="c1">#  Dot product of vectors</span>
<span class="n">dotp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;u . v =&quot;</span><span class="p">,</span> <span class="n">dotp</span><span class="p">)</span>

<span class="c1"># Cross product of vectors</span>
<span class="n">crossp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;u x v =&quot;</span><span class="p">,</span> <span class="n">crossp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>u = [1 2 3]
v = [3 2 1]
3 * u = [3 6 9]
u + v = [4 4 4]
u . v = 10
u x v = [-4  8 -4]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="geological-features-as-vectors">
<span id="ch04-3"></span><h2><span class="section-number">4.3. </span>Geological features as vectors<a class="headerlink" href="#geological-features-as-vectors" title="Permalink to this headline">#</a></h2>
<p>We have now all the mathematical tools needed to represent geological features as vectors. Since we are only interested in the orientation of these features, we will treat lines (and poles to planes) as unit vectors. We will also use the Structural Geology <strong>NED</strong> coordinate system.</p>
<section id="from-spherical-to-cartesian-coordinates">
<span id="ch04-3-1"></span><h3><span class="section-number">4.3.1. </span>From spherical to Cartesian coordinates<a class="headerlink" href="#from-spherical-to-cartesian-coordinates" title="Permalink to this headline">#</a></h3>
<p><a class="reference internal" href="#ch04-fig04"><span class="std std-numref">Figure 4.4</span></a> shows a line as a unit vector <span class="math notranslate nohighlight">\(\mathbf{\hat{v}}\)</span> in the <strong>NED</strong> coordinate system. Clearly, the angle that the line makes with the <strong>D</strong> axis is <span class="math notranslate nohighlight">\(90^o - \textit{plunge}\)</span>, therefore:</p>
<figure class="align-default" id="ch04-fig04">
<a class="reference internal image-reference" href="_images/ch04_fig04.png"><img alt="_images/ch04_fig04.png" src="_images/ch04_fig04.png" style="width: 450px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.4 </span><span class="caption-text">Diagram showing the relations between the trend and plunge and the direction cosines in the <strong>NED</strong> coordinate system. Gray plane is the vertical plane in which the plunge is measured. Modified from Allmendinger et al. (2012).</span><a class="headerlink" href="#ch04-fig04" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="math notranslate nohighlight" id="equation-ch04-eq11">
<span class="eqno">(4.11)<a class="headerlink" href="#equation-ch04-eq11" title="Permalink to this equation">#</a></span>\[
\cos\gamma=\cos(90^o - plunge) = \sin(plunge)
\]</div>
<p>The horizontal projection of the line is <span class="math notranslate nohighlight">\(\cos(plunge)\)</span> (<a class="reference internal" href="#ch04-fig04"><span class="std std-numref">Figure 4.4</span></a>). <span class="math notranslate nohighlight">\(\cos\alpha\)</span> and <span class="math notranslate nohighlight">\(\cos\beta\)</span> are just the <strong>N</strong> and <strong>E</strong> components of this horizontal line and (<a class="reference internal" href="#ch04-fig04"><span class="std std-numref">Figure 4.4</span></a>):</p>
<div class="math notranslate nohighlight" id="equation-ch04-eq12">
<span class="eqno">(4.12)<a class="headerlink" href="#equation-ch04-eq12" title="Permalink to this equation">#</a></span>\[
\cos\alpha = \cos(trend)\cos(plunge)
\]</div>
<div class="math notranslate nohighlight" id="equation-ch04-eq13">
<span class="eqno">(4.13)<a class="headerlink" href="#equation-ch04-eq13" title="Permalink to this equation">#</a></span>\[
\cos\beta = \cos(90^o - trend)\cos(plunge) = \sin(trend)\cos(plunge)
\]</div>
<p><a class="reference internal" href="#ch04-tab01"><span class="std std-numref">Table 4.1</span></a> summarizes these equations.</p>
<table class="table" id="ch04-tab01">
<caption><span class="caption-number">Table 4.1 </span><span class="caption-text">From spherical to Cartesian coordinates of lines and poles.</span><a class="headerlink" href="#ch04-tab01" title="Permalink to this table">#</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Axis</p></th>
<th class="head"><p>Direction cosines</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>N</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\cos\alpha=\cos(trend)\cos(plunge)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><strong>E</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\cos\beta=\sin(trend)\cos(plunge)\)</span></p></td>
</tr>
<tr class="row-even"><td><p><strong>D</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\cos\gamma=\sin(plunge)\)</span></p></td>
</tr>
</tbody>
</table>
<p>The magnitude and sign of the direction cosines tell us a lot about the orientation of the line (<a class="reference internal" href="#ch04-fig05"><span class="std std-numref">Figure 4.5</span></a>). A horizontal line (plunge = 0) has <span class="math notranslate nohighlight">\(\cos\gamma=0\)</span>, a downward line (plunge <span class="math notranslate nohighlight">\(&gt;0\)</span>) has positive <span class="math notranslate nohighlight">\(\cos\gamma\)</span>, and a vertical line (plunge = 90) has <span class="math notranslate nohighlight">\(\cos\gamma=1\)</span> (<span class="math notranslate nohighlight">\(\cos\alpha\)</span> and <span class="math notranslate nohighlight">\(\cos\beta\)</span> are 0). A horizontal or downward line has positive <span class="math notranslate nohighlight">\(\cos\alpha\)</span> if it trends to the north (first or fourth quadrants), and positive <span class="math notranslate nohighlight">\(\cos\beta\)</span> if it trends to the east (first or second quadrants). If the line trends exactly N or S, <span class="math notranslate nohighlight">\(\cos\beta=0\)</span>; and if the line trends exactly E or W, <span class="math notranslate nohighlight">\(\cos\alpha=0\)</span>.</p>
<figure class="align-default" id="ch04-fig05">
<a class="reference internal image-reference" href="_images/ch04_fig05.png"><img alt="_images/ch04_fig05.png" src="_images/ch04_fig05.png" style="width: 450px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.5 </span><span class="caption-text">Lower hemisphere stereonet showing the sign of the direction cosines in each quadrant. In the NE quadrant, all three direction cosines are positive. Modified from Allmendinger et al. (2012).</span><a class="headerlink" href="#ch04-fig05" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The function <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/functions/sph_to_cart.py">sph_to_cart</a> converts a line from spherical to Cartesian coordinates. Notice that the <code class="docutils literal notranslate"><span class="pre">trd</span></code> and <code class="docutils literal notranslate"><span class="pre">plg</span></code> of the line should be entered in radians:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>


<span class="k">def</span> <span class="nf">sph_to_cart</span><span class="p">(</span><span class="n">trd</span><span class="p">,</span><span class="n">plg</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    sph_to_cart converts line from spherical (trend </span>
<span class="sd">    and plunge) to Cartesian (direction cosines) </span>
<span class="sd">    coordinates</span>
<span class="sd">    </span>
<span class="sd">    sph_to_cart(trd,plg) returns the north (cn),</span>
<span class="sd">    east (ce), and down (cd) direction cosines of </span>
<span class="sd">    a line with trend = trd and plunge = plg</span>
<span class="sd">    </span>
<span class="sd">    NOTE: Angles should be entered in radians</span>
<span class="sd">    </span>
<span class="sd">    Python function based on the Matlab function</span>
<span class="sd">    SphToCart in Allmendinger et al. (2012)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Compute direction cosines from trend and plunge</span>
    <span class="n">cn</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">trd</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">plg</span><span class="p">)</span>
    <span class="n">ce</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">trd</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">plg</span><span class="p">)</span>
    <span class="n">cd</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">plg</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">cn</span><span class="p">,</span> <span class="n">ce</span><span class="p">,</span> <span class="n">cd</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="from-cartesian-to-spherical-coordinates">
<span id="ch04-3-2"></span><h3><span class="section-number">4.3.2. </span>From Cartesian to spherical coordinates<a class="headerlink" href="#from-cartesian-to-spherical-coordinates" title="Permalink to this headline">#</a></h3>
<p>Converting from direction cosines (Cartesian coordinates) to trend and plunge (spherical coordinates) is a little less straightforward. The plunge is easy:</p>
<div class="math notranslate nohighlight" id="equation-ch04-eq14">
<span class="eqno">(4.14)<a class="headerlink" href="#equation-ch04-eq14" title="Permalink to this equation">#</a></span>\[
plunge = \sin^{-1}(\cos\gamma)
\]</div>
<p>The trend can be determined as follows:</p>
<div class="math notranslate nohighlight" id="equation-ch04-eq15">
<span class="eqno">(4.15)<a class="headerlink" href="#equation-ch04-eq15" title="Permalink to this equation">#</a></span>\[
\frac{\cos\beta}{\cos\alpha} = \frac{\sin(trend)\cos(plunge)}{\cos(trend)\cos(plunge)} = \tan(trend)
\]</div>
<p>or:</p>
<div class="math notranslate nohighlight" id="equation-ch04-eq16">
<span class="eqno">(4.16)<a class="headerlink" href="#equation-ch04-eq16" title="Permalink to this equation">#</a></span>\[
trend = \tan^{-1}\left(\frac{\cos\beta}{\cos\alpha}\right)
\]</div>
<p>The problem is that the trend varies from 0 and 360. For the <span class="math notranslate nohighlight">\(\tan^{-1}\)</span> function, there are two possible angles between 0 and 360. Which one should we use? The answer is to use the signs of the direction cosines to determine in which quadrant the trend lies within. By inspection of <a class="reference internal" href="#ch04-fig05"><span class="std std-numref">Figure 4.5</span></a>, one can see that:</p>
<div class="math notranslate nohighlight" id="equation-ch04-eq17">
<span class="eqno">(4.17)<a class="headerlink" href="#equation-ch04-eq17" title="Permalink to this equation">#</a></span>\[
trend = \tan^{-1}\left(\frac{\cos\beta}{\cos\alpha}\right),\textit{if}\, \cos\alpha &gt; 0
\]</div>
<div class="math notranslate nohighlight" id="equation-ch04-eq18">
<span class="eqno">(4.18)<a class="headerlink" href="#equation-ch04-eq18" title="Permalink to this equation">#</a></span>\[
trend = 180^o + \tan^{-1}\left(\frac{\cos\beta}{\cos\alpha}\right),\textit{if}\, \cos\alpha &lt; 0
\]</div>
<p>One should also check for the special case of <span class="math notranslate nohighlight">\(\cos\alpha=0\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-ch04-eq19">
<span class="eqno">(4.19)<a class="headerlink" href="#equation-ch04-eq19" title="Permalink to this equation">#</a></span>\[
trend = 90^o,\textit{if}\, \cos\alpha = 0\,\textit{and}\, \cos(\beta)\geq 0
\]</div>
<div class="math notranslate nohighlight" id="equation-ch04-eq20">
<span class="eqno">(4.20)<a class="headerlink" href="#equation-ch04-eq20" title="Permalink to this equation">#</a></span>\[
trend = 270^o, \textit{if}\, \cos\alpha = 0\, \textit{and}\, \cos(\beta) &lt; 0
\]</div>
<p>The function <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/functions/cart_to_sph.py">cart_to_sph</a> converts a line from Cartesian to spherical coordinates. Notice that the trend and plunge of the line are returned in radians:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>

<span class="kn">from</span> <span class="nn">compgeo.zero_twopi</span> <span class="kn">import</span> <span class="n">zero_twopi</span>


<span class="k">def</span> <span class="nf">cart_to_sph</span><span class="p">(</span><span class="n">cn</span><span class="p">,</span><span class="n">ce</span><span class="p">,</span><span class="n">cd</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    cart_to_sph converts from Cartesian to spherical coordinates</span>
<span class="sd">    </span>
<span class="sd">    cart_to_sph(cn,ce,cd) returns the trend (trd)</span>
<span class="sd">    and plunge (plg) of a line with north (cn),</span>
<span class="sd">    east (ce), and down (cd) direction cosines</span>
<span class="sd">    </span>
<span class="sd">    NOTE: Trend and plunge are returned in radians</span>
<span class="sd">    </span>
<span class="sd">    Python function translated from the Matlab function</span>
<span class="sd">    CartToSph in Allmendinger et al. (2012)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pi</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>
    <span class="c1"># Plunge </span>
    <span class="n">plg</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">asin</span><span class="p">(</span><span class="n">cd</span><span class="p">)</span> 
    
    <span class="c1"># Trend: If north direction cosine is zero, trend</span>
    <span class="c1"># is east or west. Choose which one by the sign of</span>
    <span class="c1"># the east direction cosine</span>
    <span class="k">if</span> <span class="n">cn</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ce</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">trd</span> <span class="o">=</span> <span class="mf">3.0</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">pi</span> <span class="c1"># trend is west</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">trd</span> <span class="o">=</span> <span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span> <span class="c1"># trend is east</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">trd</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan</span><span class="p">(</span><span class="n">ce</span><span class="o">/</span><span class="n">cn</span><span class="p">)</span> 
        <span class="k">if</span> <span class="n">cn</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">trd</span> <span class="o">=</span> <span class="n">trd</span> <span class="o">+</span> <span class="n">pi</span> 
        <span class="c1"># Make sure trend is between 0 and 2*pi</span>
        <span class="n">trd</span> <span class="o">=</span> <span class="n">zero_twopi</span><span class="p">(</span><span class="n">trd</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">trd</span><span class="p">,</span> <span class="n">plg</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="applications">
<span id="ch04-4"></span><h2><span class="section-number">4.4. </span>Applications<a class="headerlink" href="#applications" title="Permalink to this headline">#</a></h2>
<section id="mean-vector">
<span id="ch04-4-1"></span><h3><span class="section-number">4.4.1. </span>Mean vector<a class="headerlink" href="#mean-vector" title="Permalink to this headline">#</a></h3>
<p>An important problem in geosciences is to determine the average or mean vector that represents a group of lines. These lines can be for example poles to bedding, paleocurrent directions, paleomagnetic poles, or slip vectors on a fault surface. This problem can be solved using vector addition. The resultant vector <span class="math notranslate nohighlight">\(\mathbf{r}\)</span> of the sum of the <span class="math notranslate nohighlight">\(N\)</span> unit vectors representing the lines has components:</p>
<div class="math notranslate nohighlight" id="equation-ch04-eq21">
<span class="eqno">(4.21)<a class="headerlink" href="#equation-ch04-eq21" title="Permalink to this equation">#</a></span>\[
r_1 = \sum_{i = 1}^{N}\alpha_i\qquad r_2 = \sum_{i = 1}^{N}\beta_i\qquad r_3 = \sum_{i = 1}^{N}\gamma_i
\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span> and <span class="math notranslate nohighlight">\(\gamma\)</span> are the direction cosines of the unit vectors. The length of the resultant vector <span class="math notranslate nohighlight">\(\mathbf{r}\)</span> is:</p>
<div class="math notranslate nohighlight" id="equation-ch04-eq22">
<span class="eqno">(4.22)<a class="headerlink" href="#equation-ch04-eq22" title="Permalink to this equation">#</a></span>\[
r = \sqrt{r_1^2 + r_2^2 + r_3^2}
\]</div>
<p>and the direction cosines of the unit vector that is parallel to the mean of the individual vectors are:</p>
<div class="math notranslate nohighlight" id="equation-ch04-eq23">
<span class="eqno">(4.23)<a class="headerlink" href="#equation-ch04-eq23" title="Permalink to this equation">#</a></span>\[
\overline{\alpha} = \frac{r_1}{r}\qquad \overline{\beta} = \frac{r_2}{r}\qquad \overline{\gamma} = \frac{r_3}{r}
\]</div>
<p>These direction cosines define the orientation of the mean vector. The mean resultant length <span class="math notranslate nohighlight">\(\overline{r}\)</span> measures how concentrated the individual vectors are or how representative the mean vector is:</p>
<div class="math notranslate nohighlight" id="equation-ch04-eq24">
<span class="eqno">(4.24)<a class="headerlink" href="#equation-ch04-eq24" title="Permalink to this equation">#</a></span>\[
\overline{r} = \frac{r}{N}\qquad where\qquad 0\leq\overline{r}\leq 1
\]</div>
<p>The closer this value is to 1, the better the concentration. The function <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/functions/calc_mv.py">calc_mv</a> calculates the mean vector for a series of lines. It also calculates the Fisher statistics for the mean vector (Fisher et al., 1987), which is the standard way to represent uncertainties in this analysis. Notice that <code class="docutils literal notranslate"><span class="pre">calc_mv</span></code> uses our two previous functions <code class="docutils literal notranslate"><span class="pre">sph_to_cart</span></code> and <code class="docutils literal notranslate"><span class="pre">cart_to_sph</span></code> to convert from spherical to Cartesian coordinates, and vice versa.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>

<span class="kn">from</span> <span class="nn">compgeo.sph_to_cart</span> <span class="kn">import</span> <span class="n">sph_to_cart</span>
<span class="kn">from</span> <span class="nn">compgeo.cart_to_sph</span> <span class="kn">import</span> <span class="n">cart_to_sph</span>


<span class="k">def</span> <span class="nf">calc_mv</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    calc_mv calculates the mean vector for a group of lines.</span>
<span class="sd">    It calculates the trend (trd) and plunge (plg) of the</span>
<span class="sd">    mean vector, its mean resultant length (rave), and</span>
<span class="sd">    Fisher statistics (concentration factor (conc), 99 (d99)</span>
<span class="sd">    and 95 (d95) % uncertainty cones); for a series of lines</span>
<span class="sd">    whose trends and plunges are stored in the arrays T and P</span>
<span class="sd">    </span>
<span class="sd">    NOTE: Input/Output values are in radians</span>
<span class="sd">    </span>
<span class="sd">    Python function translated from the Matlab function</span>
<span class="sd">    CalcMV in Allmendinger et al. (2012)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Number of lines</span>
    <span class="n">nlines</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    
    <span class="c1"># Initialize the 3 direction cosines which contain the</span>
    <span class="c1"># sums of the individual vectors </span>
    <span class="n">cn_sum</span> <span class="o">=</span> <span class="n">ce_sum</span> <span class="o">=</span> <span class="n">cd_sum</span> <span class="o">=</span> <span class="mf">0.0</span>
    
    <span class="c1">#Now add up all the individual vectors</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlines</span><span class="p">):</span>
        <span class="n">cn</span><span class="p">,</span><span class="n">ce</span><span class="p">,</span><span class="n">cd</span> <span class="o">=</span> <span class="n">sph_to_cart</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">cn_sum</span> <span class="o">+=</span> <span class="n">cn</span>
        <span class="n">ce_sum</span> <span class="o">+=</span> <span class="n">ce</span>
        <span class="n">cd_sum</span> <span class="o">+=</span> <span class="n">cd</span>
    
    <span class="c1"># r is the length of the resultant vector and</span>
    <span class="c1"># rave is the mean resultant length</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cn_sum</span><span class="o">*</span><span class="n">cn_sum</span><span class="o">+</span><span class="n">ce_sum</span><span class="o">*</span><span class="n">ce_sum</span><span class="o">+</span><span class="n">cd_sum</span><span class="o">*</span><span class="n">cd_sum</span><span class="p">)</span>
    <span class="n">rave</span> <span class="o">=</span> <span class="n">r</span><span class="o">/</span><span class="n">nlines</span>
    <span class="c1"># If rave is lower than 0.1, the mean vector is</span>
    <span class="c1"># insignificant, return error</span>
    <span class="k">if</span> <span class="n">rave</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Mean vector is insignificant&quot;</span><span class="p">)</span>
    <span class="c1">#Else </span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Divide the resultant vector by its length to get</span>
        <span class="c1"># the direction cosines of the unit vector</span>
        <span class="n">cn_sum</span> <span class="o">/=</span> <span class="n">r</span>
        <span class="n">ce_sum</span> <span class="o">/=</span> <span class="n">r</span>
        <span class="n">cd_sum</span> <span class="o">/=</span> <span class="n">r</span>
        <span class="c1"># Convert the mean vector to the lower hemisphere</span>
        <span class="k">if</span> <span class="n">cd_sum</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">cn_sum</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1.0</span>
            <span class="n">ce_sum</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1.0</span>
            <span class="n">cd_sum</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1.0</span>
        <span class="c1"># Convert the mean vector to trend and plunge</span>
        <span class="n">trd</span><span class="p">,</span> <span class="n">plg</span> <span class="o">=</span> <span class="n">cart_to_sph</span><span class="p">(</span><span class="n">cn_sum</span><span class="p">,</span><span class="n">ce_sum</span><span class="p">,</span><span class="n">cd_sum</span><span class="p">)</span>
        <span class="c1"># If there are enough measurements calculate the</span>
        <span class="c1"># Fisher statistics (Fisher et al., 1987)</span>
        <span class="n">conc</span> <span class="o">=</span> <span class="n">d99</span> <span class="o">=</span> <span class="n">d95</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">nlines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">nlines</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
                <span class="n">afact</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">-</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">nlines</span><span class="p">)</span>
                <span class="n">conc</span> <span class="o">=</span> <span class="p">(</span><span class="n">nlines</span><span class="o">/</span><span class="p">(</span><span class="n">nlines</span><span class="o">-</span><span class="n">r</span><span class="p">))</span><span class="o">*</span><span class="n">afact</span><span class="o">**</span><span class="mi">2</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">conc</span> <span class="o">=</span> <span class="p">(</span><span class="n">nlines</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">nlines</span><span class="o">-</span><span class="n">r</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rave</span> <span class="o">&gt;=</span> <span class="mf">0.65</span> <span class="ow">and</span> <span class="n">rave</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="n">afact</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="mf">0.01</span>
            <span class="n">bfact</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="n">nlines</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
            <span class="n">d99</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="p">((</span><span class="n">nlines</span><span class="o">-</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">r</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">afact</span><span class="o">**</span><span class="n">bfact</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span>
            <span class="n">afact</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="mf">0.05</span>
            <span class="n">d95</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">acos</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="p">((</span><span class="n">nlines</span><span class="o">-</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">r</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">afact</span><span class="o">**</span><span class="n">bfact</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">trd</span><span class="p">,</span> <span class="n">plg</span><span class="p">,</span> <span class="n">rave</span><span class="p">,</span> <span class="n">conc</span><span class="p">,</span> <span class="n">d99</span><span class="p">,</span> <span class="n">d95</span>
</pre></div>
</div>
</div>
</div>
<p>The notebook <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/notebooks/ch4-3.ipynb">ch4-3</a> solves the mean vector problem in Ragan (2009, pp. 147), which involves finding the mean orientation of 10 poles to bedding:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">compgeo.st_coord_line</span> <span class="kn">import</span> <span class="n">st_coord_line</span>
<span class="kn">from</span> <span class="nn">compgeo.calc_mv</span> <span class="kn">import</span> <span class="n">calc_mv</span>


<span class="c1"># Arrays T and P contain the trend (T) </span>
<span class="c1"># and plunge (P) of the 10 poles</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">([</span><span class="mi">206</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">204</span><span class="p">,</span> <span class="mi">198</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">188</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> 
                <span class="mi">228</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">218</span><span class="p">])</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">([</span><span class="mi">32</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">44</span><span class="p">])</span>

<span class="c1"># Compute the mean vector and print orientation</span>
<span class="c1"># and mean resultant length</span>
<span class="n">trd</span><span class="p">,</span> <span class="n">plg</span><span class="p">,</span> <span class="n">rave</span><span class="p">,</span> <span class="n">conc</span><span class="p">,</span> <span class="n">d99</span><span class="p">,</span> <span class="n">d95</span> <span class="o">=</span> <span class="n">calc_mv</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
<span class="n">pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean vector trend = </span><span class="si">{:.1f}</span><span class="s2">, plunge </span><span class="si">{:.1f}</span><span class="s2">&quot;</span>
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">trd</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">,</span><span class="n">plg</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean resultant length = </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rave</span><span class="p">))</span>

<span class="c1"># Make a figure</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># Plot the primitive of the stereonet</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1"># unit radius</span>
<span class="n">th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">361</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="c1"># Plot center of circle</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;k+&quot;</span><span class="p">)</span>
<span class="c1"># Make axes equal and remove them</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>

<span class="c1"># Plot the poles as black points</span>
<span class="c1"># on an equal angle stereonet</span>
<span class="n">npoles</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="n">eq_angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">npoles</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npoles</span><span class="p">):</span>
    <span class="c1"># Equal angle coordinates</span>
    <span class="n">eq_angle</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">eq_angle</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">st_coord_line</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eq_angle</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">eq_angle</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s2">&quot;ko&quot;</span><span class="p">)</span>

<span class="c1"># Plot the mean vector as a red point</span>
<span class="n">mvx</span><span class="p">,</span> <span class="n">mvy</span> <span class="o">=</span> <span class="n">st_coord_line</span><span class="p">(</span><span class="n">trd</span><span class="p">,</span><span class="n">plg</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mvx</span><span class="p">,</span><span class="n">mvy</span><span class="p">,</span><span class="s2">&quot;ro&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean vector trend = 208.6, plunge 40.0
Mean resultant length = 0.963
</pre></div>
</div>
<img alt="_images/ch04_coordinate_systems_vectors_26_1.png" src="_images/ch04_coordinate_systems_vectors_26_1.png" />
</div>
</div>
<p>Notice that the mean resultant length is close to 1.0, so that the mean vector (red dot) is a representative orientation of the individual vectors (black dots).</p>
</section>
<section id="angles-intersections-and-poles">
<span id="ch04-4-2"></span><h3><span class="section-number">4.4.2. </span>Angles, intersections, and poles<a class="headerlink" href="#angles-intersections-and-poles" title="Permalink to this headline">#</a></h3>
<p>Many interesting problems can be solved using the dot and cross product operations. The dot product can be used to find the angle between two lines or planes, while the cross product can be used to find a plane from two lines, or the intersection of two planes. <a class="reference internal" href="#ch04-tab02"><span class="std std-numref">Table 4.2</span></a> lists some problems that can be solved using these operations.</p>
<table class="table" id="ch04-tab02">
<caption><span class="caption-number">Table 4.2 </span><span class="caption-text">Some problems that can be solved using the dot and cross product operations.</span><a class="headerlink" href="#ch04-tab02" title="Permalink to this table">#</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Problem</p></th>
<th class="head"><p>Solution</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Angle between two lines</p></td>
<td><p><span class="math notranslate nohighlight">\(\arccos\)</span> of dot product between lines</p></td>
</tr>
<tr class="row-odd"><td><p>Angle between two planes</p></td>
<td><p>Supplement of <span class="math notranslate nohighlight">\(\arccos\)</span> of dot product between poles to planes</p></td>
</tr>
<tr class="row-even"><td><p>Intersection of two planes</p></td>
<td><p>Cross product of poles to planes</p></td>
</tr>
<tr class="row-odd"><td><p>Plane containing two lines</p></td>
<td><p>Pole to plane is cross product of lines</p></td>
</tr>
<tr class="row-even"><td><p>Apparent dip of plane</p></td>
<td><p>Intersection of plane and vertical section of a given orientation</p></td>
</tr>
<tr class="row-odd"><td><p>Plane from two apparent dips</p></td>
<td><p>Plane containing the two apparent dips (lines)</p></td>
</tr>
</tbody>
</table>
<p>The functions in the module <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/functions/angles.py">angles</a> compute the angle between two lines (<code class="docutils literal notranslate"><span class="pre">angle_bw_lines</span></code>), the angle between two planes (<code class="docutils literal notranslate"><span class="pre">angle_bw_planes</span></code>), the plane from two lines (<code class="docutils literal notranslate"><span class="pre">plane_from_app_dips</span></code>), or the intersection of two planes (<code class="docutils literal notranslate"><span class="pre">int_bw_planes</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">compgeo.sph_to_cart</span> <span class="kn">import</span> <span class="n">sph_to_cart</span>
<span class="kn">from</span> <span class="nn">compgeo.cart_to_sph</span> <span class="kn">import</span> <span class="n">cart_to_sph</span>
<span class="kn">from</span> <span class="nn">compgeo.pole</span> <span class="kn">import</span> <span class="n">pole_from_plane</span><span class="p">,</span> <span class="n">plane_from_pole</span>


<span class="c1"># Python functions based on the Matlab function</span>
<span class="c1"># Angles in Allmendinger et al. (2012)</span>
<span class="k">def</span> <span class="nf">angle_bw_lines</span><span class="p">(</span><span class="n">trd1</span><span class="p">,</span> <span class="n">plg1</span><span class="p">,</span> <span class="n">trd2</span><span class="p">,</span> <span class="n">plg2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    angle_bw_lines returns the angle between two lines</span>
<span class="sd">    of trend and plunge trd1, plg1, trd2, and plg2</span>
<span class="sd">    Input and output angles are in radians</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># convert lines to directions cosines and numpy arrays</span>
    <span class="n">cn1</span><span class="p">,</span> <span class="n">ce1</span><span class="p">,</span> <span class="n">cd1</span> <span class="o">=</span> <span class="n">sph_to_cart</span><span class="p">(</span><span class="n">trd1</span><span class="p">,</span> <span class="n">plg1</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cn1</span><span class="p">,</span> <span class="n">ce1</span><span class="p">,</span> <span class="n">cd1</span><span class="p">])</span>
    <span class="n">cn2</span><span class="p">,</span> <span class="n">ce2</span><span class="p">,</span> <span class="n">cd2</span> <span class="o">=</span> <span class="n">sph_to_cart</span><span class="p">(</span><span class="n">trd2</span><span class="p">,</span> <span class="n">plg2</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cn2</span><span class="p">,</span> <span class="n">ce2</span><span class="p">,</span> <span class="n">cd2</span><span class="p">])</span>
    <span class="c1"># angle between lines is arccosine of their dot product</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">angle_bw_planes</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span> <span class="n">dip1</span><span class="p">,</span> <span class="n">str2</span><span class="p">,</span> <span class="n">dip2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    angle_bw_planes returns the angle between two planes</span>
<span class="sd">    of strike and dip str1, dip1, str2, and dip2</span>
<span class="sd">    Input and output angles are in radians</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># compute poles to lines</span>
    <span class="n">pole1_trd</span><span class="p">,</span> <span class="n">pole1_plg</span> <span class="o">=</span> <span class="n">pole_from_plane</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span> <span class="n">dip1</span><span class="p">)</span>
    <span class="n">pole2_trd</span><span class="p">,</span> <span class="n">pole2_plg</span> <span class="o">=</span> <span class="n">pole_from_plane</span><span class="p">(</span><span class="n">str2</span><span class="p">,</span> <span class="n">dip2</span><span class="p">)</span>
    <span class="c1"># find angle between poles</span>
    <span class="n">angle</span> <span class="o">=</span> <span class="n">angle_bw_lines</span><span class="p">(</span><span class="n">pole1_trd</span><span class="p">,</span> <span class="n">pole1_plg</span><span class="p">,</span> 
        <span class="n">pole2_trd</span><span class="p">,</span> <span class="n">pole2_plg</span><span class="p">)</span>
    <span class="c1"># angle between planes is the complementary angle</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">angle</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">pole_from_lines</span><span class="p">(</span><span class="n">trd1</span><span class="p">,</span> <span class="n">plg1</span><span class="p">,</span> <span class="n">trd2</span><span class="p">,</span> <span class="n">plg2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    pole_from_lines compute the pole to a plane given</span>
<span class="sd">    two lines on the plane, with trend and plunge trd1, plg1,</span>
<span class="sd">    trd2, and plg2</span>
<span class="sd">    Input and output angles are in radians</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># convert lines to direction cosines and numpy arrays</span>
    <span class="n">cn1</span><span class="p">,</span> <span class="n">ce1</span><span class="p">,</span> <span class="n">cd1</span> <span class="o">=</span> <span class="n">sph_to_cart</span><span class="p">(</span><span class="n">trd1</span><span class="p">,</span> <span class="n">plg1</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cn1</span><span class="p">,</span> <span class="n">ce1</span><span class="p">,</span> <span class="n">cd1</span><span class="p">])</span>
    <span class="n">cn2</span><span class="p">,</span> <span class="n">ce2</span><span class="p">,</span> <span class="n">cd2</span> <span class="o">=</span> <span class="n">sph_to_cart</span><span class="p">(</span><span class="n">trd2</span><span class="p">,</span> <span class="n">plg2</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cn2</span><span class="p">,</span> <span class="n">ce2</span><span class="p">,</span> <span class="n">cd2</span><span class="p">])</span>
    <span class="c1"># normal is cross product between vectors</span>
    <span class="n">pole</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    <span class="c1"># make pole a unit vector</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">pole</span><span class="p">)</span>
    <span class="n">pole</span> <span class="o">=</span> <span class="n">pole</span><span class="o">/</span><span class="n">norm</span>
    <span class="c1"># if pole points upwards, make it point downwards</span>
    <span class="k">if</span> <span class="n">pole</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">pole</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="c1"># return trend and plunge of pole</span>
    <span class="k">return</span> <span class="n">cart_to_sph</span><span class="p">(</span><span class="n">pole</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pole</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pole</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">plane_from_app_dips</span><span class="p">(</span><span class="n">trd1</span><span class="p">,</span> <span class="n">plg1</span><span class="p">,</span> <span class="n">trd2</span><span class="p">,</span> <span class="n">plg2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    plane_from_app_dips returns the strike and dip of a plane</span>
<span class="sd">    from two apparent dips with trend and plunge trd1, plg1,</span>
<span class="sd">    trd2, and plg2</span>
<span class="sd">    Input and output angles are in radians</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Compute pole to plane from apparent dips (lines)</span>
    <span class="n">pole_trd</span><span class="p">,</span> <span class="n">pole_plg</span> <span class="o">=</span> <span class="n">pole_from_lines</span><span class="p">(</span><span class="n">trd1</span><span class="p">,</span><span class="n">plg1</span><span class="p">,</span><span class="n">trd2</span><span class="p">,</span><span class="n">plg2</span><span class="p">)</span>
    <span class="c1"># return strike and dip of plane</span>
    <span class="k">return</span> <span class="n">plane_from_pole</span><span class="p">(</span><span class="n">pole_trd</span><span class="p">,</span> <span class="n">pole_plg</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">int_bw_planes</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span> <span class="n">dip1</span><span class="p">,</span> <span class="n">str2</span><span class="p">,</span> <span class="n">dip2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    int_bw_planes returns the intersection between two planes</span>
<span class="sd">    of strike and dip str1, dip1, str2, dip2</span>
<span class="sd">    Input and output angles are in radians</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># compute poles to planes</span>
    <span class="n">pole1_trd</span><span class="p">,</span> <span class="n">pole1_plg</span> <span class="o">=</span> <span class="n">pole_from_plane</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span> <span class="n">dip1</span><span class="p">)</span>
    <span class="n">pole2_trd</span><span class="p">,</span> <span class="n">pole2_plg</span> <span class="o">=</span> <span class="n">pole_from_plane</span><span class="p">(</span><span class="n">str2</span><span class="p">,</span> <span class="n">dip2</span><span class="p">)</span>
    <span class="c1"># intersection is normal to poles</span>
    <span class="k">return</span> <span class="n">pole_from_lines</span><span class="p">(</span><span class="n">pole1_trd</span><span class="p">,</span> <span class="n">pole1_plg</span><span class="p">,</span> <span class="n">pole2_trd</span><span class="p">,</span> 
        <span class="n">pole2_plg</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The notebook <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/notebooks/ch4-4.ipynb">ch4-4</a> illustrates the use of these functions to solve several problems. Letâ€™s start with the following problem from Leyshon and Lisle (1996): Two limbs of a chevron fold (A and B) have orientations (RHR) as follows: Limb A = 120/40, Limb B = 250/60. Determine: (a) the trend and plunge of the hinge line of the fold, (b) the rake of the hinge line in limb A, (c) the rake of the hinge line in limb B.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

<span class="kn">from</span> <span class="nn">compgeo.angles</span> <span class="kn">import</span> <span class="n">angle_bw_lines</span>
<span class="kn">from</span> <span class="nn">compgeo.angles</span> <span class="kn">import</span> <span class="n">int_bw_planes</span>


<span class="c1"># Strike and dip of the limbs in radians</span>
<span class="n">str1</span><span class="p">,</span> <span class="n">dip1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">([</span><span class="mi">120</span><span class="p">,</span> <span class="mi">40</span><span class="p">])</span>
<span class="n">str2</span><span class="p">,</span> <span class="n">dip2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">([</span><span class="mi">250</span><span class="p">,</span> <span class="mi">60</span><span class="p">])</span>

<span class="c1"># (a) Chevron folds have planar limbs. The hinge</span>
<span class="c1"># of the fold is the intersection of the limbs</span>
<span class="n">htrd</span><span class="p">,</span> <span class="n">hplg</span> <span class="o">=</span> <span class="n">int_bw_planes</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span><span class="n">dip1</span><span class="p">,</span><span class="n">str2</span><span class="p">,</span><span class="n">dip2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hinge trend = </span><span class="si">{:.1f}</span><span class="s2">, plunge </span><span class="si">{:.1f}</span><span class="s2">&quot;</span>
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">htrd</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">,</span><span class="n">hplg</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">))</span>

<span class="c1"># The rake of the hinge on either limb is the angle </span>
<span class="c1"># between the hinge and the strike line on the limb. </span>
<span class="c1"># This line is horizontal and has plunge = 0</span>
<span class="n">plg</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># (b) For the SW dipping limb</span>
<span class="n">ang</span> <span class="o">=</span> <span class="n">angle_bw_lines</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span><span class="n">plg</span><span class="p">,</span><span class="n">htrd</span><span class="p">,</span><span class="n">hplg</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Rake of hinge in SW dipping limb = </span><span class="si">{:.1f}</span><span class="s2"> E&quot;</span>
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ang</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">))</span>

<span class="c1"># (c) And for the NW dipping limb</span>
<span class="n">ang</span> <span class="o">=</span> <span class="n">angle_bw_lines</span><span class="p">(</span><span class="n">str2</span><span class="p">,</span><span class="n">plg</span><span class="p">,</span><span class="n">htrd</span><span class="p">,</span><span class="n">hplg</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Rake of hinge in NW dipping limb = </span><span class="si">{:.1f}</span><span class="s2"> W&quot;</span>
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ang</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Hinge trend = 265.8, plunge 25.3
Rake of hinge in SW dipping limb = 138.4 E
Rake of hinge in NW dipping limb = 29.5 W
</pre></div>
</div>
</div>
</div>
<p>Letâ€™s do another problem from the same book: A quarry has two walls, one trending 002 and the other 135. The apparent dip of bedding on the faces are 40N and 30SE respectively. Calculate the strike and dip of bedding.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import function</span>
<span class="kn">from</span> <span class="nn">compgeo.angles</span> <span class="kn">import</span> <span class="n">plane_from_app_dips</span>


<span class="c1"># The apparent dips are just two lines on bedding</span>
<span class="c1"># These lines have orientations:</span>
<span class="n">trd1</span><span class="p">,</span> <span class="n">plg1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">40</span><span class="p">])</span>
<span class="n">trd2</span><span class="p">,</span> <span class="n">plg2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">([</span><span class="mi">135</span><span class="p">,</span> <span class="mi">30</span><span class="p">])</span>

<span class="c1"># Calculate bedding from these two apparent dips</span>
<span class="n">strike</span><span class="p">,</span> <span class="n">dip</span> <span class="o">=</span> <span class="n">plane_from_app_dips</span><span class="p">(</span><span class="n">trd1</span><span class="p">,</span><span class="n">plg1</span><span class="p">,</span><span class="n">trd2</span><span class="p">,</span><span class="n">plg2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bedding strike = </span><span class="si">{:.1f}</span><span class="s2">, dip </span><span class="si">{:.1f}</span><span class="s2">&quot;</span>
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">strike</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">,</span><span class="n">dip</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bedding strike = 333.9, dip 60.7
</pre></div>
</div>
</div>
</div>
<p>And the final problem also from the same book: Slickenside lineations trending 074occur on a fault with orientation 300/50 (RHR). Determine the plunge of these lineations and their rake in the plane of the fault.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The lineation on the fault is just the intersection</span>
<span class="c1"># of a vertical plane with a strike equal to</span>
<span class="c1"># the trend of the lineation, and the fault</span>
<span class="n">str1</span><span class="p">,</span> <span class="n">dip1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">([</span><span class="mi">74</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span>
<span class="n">str2</span><span class="p">,</span> <span class="n">dip2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">([</span><span class="mi">300</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>

<span class="c1"># Find the intersection of these two planes which is</span>
<span class="c1"># the lineation on the fault</span>
<span class="n">ltrd</span><span class="p">,</span> <span class="n">lplg</span> <span class="o">=</span> <span class="n">int_bw_planes</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span><span class="n">dip1</span><span class="p">,</span><span class="n">str2</span><span class="p">,</span><span class="n">dip2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Slickensides trend = </span><span class="si">{:.1f}</span><span class="s2">, plunge </span><span class="si">{:.1f}</span><span class="s2">&quot;</span>
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ltrd</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">,</span><span class="n">lplg</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">))</span>

<span class="c1"># And the rake of this lineation is the angle</span>
<span class="c1"># between the lineation and the strike line on the fault</span>
<span class="n">plg</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">ang</span> <span class="o">=</span> <span class="n">angle_bw_lines</span><span class="p">(</span><span class="n">str2</span><span class="p">,</span><span class="n">plg</span><span class="p">,</span><span class="n">ltrd</span><span class="p">,</span><span class="n">lplg</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Rake of slickensides = </span><span class="si">{:.1f}</span><span class="s2"> W&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ang</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Slickensides trend = 74.0, plunge 40.6
Rake of slickensides = 121.8 W
</pre></div>
</div>
</div>
</div>
<p>There are many interesting problems you can solve using these functions. You will find more problems in <a class="reference internal" href="#ch04-6"><span class="std std-ref">Section 4.6</span></a>.</p>
</section>
<section id="three-points-problem">
<span id="ch04-4-3"></span><h3><span class="section-number">4.4.3. </span>Three points problem<a class="headerlink" href="#three-points-problem" title="Permalink to this headline">#</a></h3>
<p>The three points problem is a fundamental problem in geology. It is based on the fact that three non-collinear points on a plane define the orientation of the plane. The graphical solution to this problem is introduced early in Geosciences. It involves finding the strike line (a line connecting two points of equal elevation) on the plane, and the dip from two strike lines (two structure contours) on the plane.</p>
<p>However, there is an easier and more accurate solution to this problem using linear algebra: The three points on the plane define two lines, and the cross product between these lines is parallel to the pole to the plane, from which the orientation of the plane can be estimated. The function <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/functions/three_points.py">three_points</a> computes the strike and dip of a plane from the east (<strong>E</strong>), north (<strong>N</strong>), and up (<strong>U</strong>) coordinates of three points on the plane:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">compgeo.cart_to_sph</span> <span class="kn">import</span> <span class="n">cart_to_sph</span>
<span class="kn">from</span> <span class="nn">compgeo.pole</span> <span class="kn">import</span> <span class="n">plane_from_pole</span>


<span class="k">def</span> <span class="nf">three_points</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">p3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    three_points calculates the strike (strike) and dip (dip)</span>
<span class="sd">    of a plane given the east (E), north (N), and up (U)</span>
<span class="sd">    coordinates of three non-collinear points on the plane</span>
<span class="sd">    </span>
<span class="sd">    p1, p2 and p3 are 1 x 3 arrays defining the location</span>
<span class="sd">    of the points in an ENU coordinate system. For each one</span>
<span class="sd">    of these arrays the first, second and third entries are </span>
<span class="sd">    the E, N and U coordinates, respectively</span>
<span class="sd">    </span>
<span class="sd">    NOTE: strike and dip are returned in radians and they</span>
<span class="sd">    follow the right-hand rule format</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># make vectors v (p1 - p3) and u (p2 - p3)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">-</span> <span class="n">p2</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">p2</span> <span class="o">-</span> <span class="n">p3</span>
    <span class="c1"># take the cross product of v and u</span>
    <span class="n">vcu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">u</span><span class="p">)</span>
    
    <span class="c1"># make this vector a unit vector</span>
    <span class="n">mvcu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">vcu</span><span class="p">)</span> <span class="c1"># magnitude of the vector</span>
    <span class="k">if</span> <span class="n">mvcu</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># If points collinear</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error: points are collinear&quot;</span><span class="p">)</span>
    
    <span class="n">vcu</span> <span class="o">=</span> <span class="n">vcu</span><span class="o">/</span><span class="n">mvcu</span> <span class="c1"># unit vector</span>
    
    <span class="c1"># make the pole vector in NED coordinates</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vcu</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">vcu</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">vcu</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
    
    <span class="c1"># Make pole point downwards</span>
    <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1.0</span>
    
    <span class="c1"># find the trend and plunge of the pole</span>
    <span class="n">trd</span><span class="p">,</span> <span class="n">plg</span> <span class="o">=</span> <span class="n">cart_to_sph</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    
    <span class="c1"># find strike and dip of plane</span>
    <span class="n">strike</span><span class="p">,</span> <span class="n">dip</span> <span class="o">=</span> <span class="n">plane_from_pole</span><span class="p">(</span><span class="n">trd</span><span class="p">,</span> <span class="n">plg</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">strike</span><span class="p">,</span> <span class="n">dip</span>
</pre></div>
</div>
</div>
</div>
<p>Letâ€™s use this function in the following problem. The geologic map in <a class="reference internal" href="#ch04-fig06"><span class="std std-numref">Figure 4.6</span></a> shows a sequence of sedimentary units dipping south (you can deduce this by the outcrop V in the valley). Points 1, 2 and 3 are located on the base of unit S and their <strong>ENU</strong> coordinates are:</p>
<p>point1 = [509, 2041, 400]</p>
<p>point2 = [1323, 2362, 500]</p>
<p>point3 = [2003, 2913, 700]</p>
<p>Calculate the strike and dip of the plane. The notebook <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/notebooks/ch4-5.ipynb">ch4-5</a> shows the solution to this problem:</p>
<figure class="align-default" id="ch04-fig06">
<a class="reference internal image-reference" href="_images/ch04_fig06.png"><img alt="_images/ch04_fig06.png" src="_images/ch04_fig06.png" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.6 </span><span class="caption-text">Geologic map of sedimentary units dipping south (Bennison et al., 2011). Points 1 to 3 on the base of unit S are used to estimate the orientation of bedding. Notice that the origin is at the map lower left corner.</span><a class="headerlink" href="#ch04-fig06" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

<span class="c1"># Import function three_points</span>
<span class="kn">from</span> <span class="nn">compgeo.three_points</span> <span class="kn">import</span> <span class="n">three_points</span>


<span class="c1"># ENU coordinates of the three points</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">509</span><span class="p">,</span> <span class="mi">2041</span><span class="p">,</span> <span class="mi">400</span><span class="p">])</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1323</span><span class="p">,</span> <span class="mi">2362</span><span class="p">,</span> <span class="mi">500</span><span class="p">])</span>
<span class="n">p3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2003</span><span class="p">,</span> <span class="mi">2913</span><span class="p">,</span> <span class="mi">700</span><span class="p">])</span>

<span class="c1"># Compute the orientation of the plane</span>
<span class="n">strike</span><span class="p">,</span> <span class="n">dip</span> <span class="o">=</span> <span class="n">three_points</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">p3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Plane strike = </span><span class="si">{:.1f}</span><span class="s2">, dip = </span><span class="si">{:.1f}</span><span class="s2">&quot;</span>
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">strike</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">,</span><span class="n">dip</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Plane strike = 84.5, dip = 22.5
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="uncertainties">
<span id="ch04-5"></span><h2><span class="section-number">4.5. </span>Uncertainties<a class="headerlink" href="#uncertainties" title="Permalink to this headline">#</a></h2>
<p>As we saw in <a class="reference internal" href="ch03_geological_features.html#ch03-2-5"><span class="std std-ref">Section 3.2.5</span></a>, the strike and dip or trend and plunge measurements have errors (<a class="reference internal" href="ch03_geological_features.html#ch03-fig06"><span class="std std-numref">Figure 3.6</span></a> and <a class="reference internal" href="ch03_geological_features.html#ch03-fig07"><span class="std std-numref">Figure 3.7</span></a>), and these errors propagate in any computation making use of these angles. Also, as accurate as GPS and elevation measurements are today, they also have errors. Thus, the functions in the module <code class="docutils literal notranslate"><span class="pre">angles</span></code> and the function <code class="docutils literal notranslate"><span class="pre">three_points</span></code> lack this important element of uncertainty.</p>
<p>Suppose that <span class="math notranslate nohighlight">\(x, ..., z\)</span> are measured with uncertainties (or errors) <span class="math notranslate nohighlight">\(\delta x, ..., \delta z\)</span> and the measured values are used to compute the function <span class="math notranslate nohighlight">\(q(x,...,z)\)</span>. If the uncertainties in <span class="math notranslate nohighlight">\(x, ..., z\)</span> are independent and random, then the uncertainty (or error) in <span class="math notranslate nohighlight">\(q\)</span> is (Taylor, 1997):</p>
<div class="math notranslate nohighlight" id="equation-ch04-eq25">
<span class="eqno">(4.25)<a class="headerlink" href="#equation-ch04-eq25" title="Permalink to this equation">#</a></span>\[
\delta q=\sqrt{\left(\frac{\partial q}{\partial x}\delta x \right)^2+...+\left(\frac{\partial q}{\partial z}\delta z \right)^2}
\]</div>
<p>This formula is easy to calculate for a few operations, but it can become quite difficult for a long chain of operations. Fortunately, there is a Python package that handles calculations with numbers with uncertainties. This package is called <code class="docutils literal notranslate"><span class="pre">uncertainties</span></code> and it was developed by Eric Lebigot. You can find details about the package as well as instructions for installing it in the <a class="reference external" href="https://pythonhosted.org/uncertainties/">uncertainties</a> website. You can install the uncertainties package by entering in a terminal:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>uncertainties
</pre></div>
</div>
<p>After this, you can use the uncertainties package. The module <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/functions/angles_u.py">angles_u</a> and the function <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/functions/three_points_u.py">three_points_u</a> in the resource git repository, are the corresponding <code class="docutils literal notranslate"><span class="pre">angles</span></code> module and <code class="docutils literal notranslate"><span class="pre">three_points</span></code> function with uncertainties. We donâ€™t list these here, but rather illustrate their use in the following notebook <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/notebooks/ch4-6.ipynb">ch4-6</a>.</p>
<p>In the first problem on page 64, the uncertainty in strike is 4and in dip is 2. What is the uncertainty in the hinge orientation and its rake on the limbs? This problem can be solved as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

<span class="kn">from</span> <span class="nn">uncertainties</span> <span class="kn">import</span> <span class="n">ufloat</span>

<span class="c1"># Import functions</span>
<span class="kn">from</span> <span class="nn">compgeo.angles_u</span> <span class="kn">import</span> <span class="n">angle_bw_lines_u</span>
<span class="kn">from</span> <span class="nn">compgeo.angles_u</span> <span class="kn">import</span> <span class="n">int_bw_planes_u</span>


<span class="c1"># Strike and dip of the limbs in radians</span>
<span class="n">str1</span><span class="p">,</span> <span class="n">dip1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">([</span><span class="mi">120</span><span class="p">,</span> <span class="mi">40</span><span class="p">])</span> <span class="c1"># SW dipping limb</span>
<span class="n">str2</span><span class="p">,</span> <span class="n">dip2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">([</span><span class="mi">250</span><span class="p">,</span> <span class="mi">60</span><span class="p">])</span> <span class="c1"># NW dipping limb</span>

<span class="c1"># Errors in strike and dip in radians</span>
<span class="n">ustr</span><span class="p">,</span> <span class="n">udip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="c1"># Create the input values with uncertainties</span>
<span class="n">str1</span> <span class="o">=</span> <span class="n">ufloat</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span> <span class="n">ustr</span><span class="p">)</span>  <span class="c1"># str1 = str1 +/-ustr</span>
<span class="n">dip1</span> <span class="o">=</span> <span class="n">ufloat</span><span class="p">(</span><span class="n">dip1</span><span class="p">,</span> <span class="n">udip</span><span class="p">)</span>  <span class="c1"># dip1 = dip1 +/-udip</span>
<span class="n">str2</span> <span class="o">=</span> <span class="n">ufloat</span><span class="p">(</span><span class="n">str2</span><span class="p">,</span> <span class="n">ustr</span><span class="p">)</span>  <span class="c1"># str2 = str2 +/-ustr</span>
<span class="n">dip2</span> <span class="o">=</span> <span class="n">ufloat</span><span class="p">(</span><span class="n">dip2</span><span class="p">,</span> <span class="n">udip</span><span class="p">)</span>  <span class="c1"># dip2 = dip2 +/-udip</span>

<span class="c1"># (a) Chevron folds have planar limbs. The hinge</span>
<span class="c1"># of the fold is the intersection of the limbs</span>
<span class="n">htrd</span><span class="p">,</span> <span class="n">hplg</span> <span class="o">=</span> <span class="n">int_bw_planes_u</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span><span class="n">dip1</span><span class="p">,</span><span class="n">str2</span><span class="p">,</span><span class="n">dip2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hinge trend = </span><span class="si">{:.1f}</span><span class="s2">, plunge </span><span class="si">{:.1f}</span><span class="s2">&quot;</span>
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">htrd</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">,</span><span class="n">hplg</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">))</span>

<span class="c1"># The rake of the hinge on either limb is the angle </span>
<span class="c1"># between the hinge and the strike line on the limb. </span>
<span class="c1"># This line is horizontal and has plunge = 0</span>
<span class="n">plg</span> <span class="o">=</span> <span class="n">ufloat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">udip</span><span class="p">)</span>  <span class="c1"># plg = 0 +/-udip</span>

<span class="c1"># (b) For the SW dipping limb</span>
<span class="n">ang</span> <span class="o">=</span> <span class="n">angle_bw_lines_u</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span><span class="n">plg</span><span class="p">,</span><span class="n">htrd</span><span class="p">,</span><span class="n">hplg</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Rake of hinge in SW dipping limb = </span><span class="si">{:.1f}</span><span class="s2"> E&quot;</span>
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ang</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">))</span>

<span class="c1"># (c) And for the NW dipping limb</span>
<span class="n">ang</span> <span class="o">=</span> <span class="n">angle_bw_lines_u</span><span class="p">(</span><span class="n">str2</span><span class="p">,</span><span class="n">plg</span><span class="p">,</span><span class="n">htrd</span><span class="p">,</span><span class="n">hplg</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Rake of hinge in NW dipping limb = </span><span class="si">{:.1f}</span><span class="s2"> W&quot;</span>
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ang</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Hinge trend = 265.8+/-3.3, plunge 25.3+/-2.6
Rake of hinge in SW dipping limb = 138.4+/-4.6 E
Rake of hinge in NW dipping limb = 29.5+/-3.5 W
</pre></div>
</div>
</div>
</div>
<p>In the map of <a class="reference internal" href="#ch04-fig06"><span class="std std-numref">Figure 4.6</span></a>, the error in east and north coordinates is 10 m, and in elevation is 5 m. What is uncertainty in the strike and dip of the T-S contact?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import function three_points_u</span>
<span class="kn">from</span> <span class="nn">compgeo.three_points_u</span> <span class="kn">import</span> <span class="n">three_points_u</span>


<span class="c1"># ENU coordinates of the three points</span>
<span class="c1"># with uncertainties in E-N = 10, and U = 5</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ufloat</span><span class="p">(</span><span class="mi">509</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">ufloat</span><span class="p">(</span><span class="mi">2041</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> 
               <span class="n">ufloat</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">5</span><span class="p">)])</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ufloat</span><span class="p">(</span><span class="mi">1323</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">ufloat</span><span class="p">(</span><span class="mi">2362</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> 
               <span class="n">ufloat</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">5</span><span class="p">)])</span>
<span class="n">p3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ufloat</span><span class="p">(</span><span class="mi">2003</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">ufloat</span><span class="p">(</span><span class="mi">2913</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> 
               <span class="n">ufloat</span><span class="p">(</span><span class="mi">700</span><span class="p">,</span> <span class="mi">5</span><span class="p">)])</span>

<span class="c1"># Compute the orientation of the plane</span>
<span class="n">strike</span><span class="p">,</span> <span class="n">dip</span> <span class="o">=</span> <span class="n">three_points_u</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">p3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Plane strike = </span><span class="si">{:.1f}</span><span class="s2">, dip = </span><span class="si">{:.1f}</span><span class="s2">&quot;</span>
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">strike</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">,</span><span class="n">dip</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Plane strike = 84.5+/-3.5, dip = 22.5+/-2.7
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercises">
<span id="ch04-6"></span><h2><span class="section-number">4.6. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">#</a></h2>
<p>Problems 1-3 are from Marshak and Mitra (1988). Solve these problems using the module <code class="docutils literal notranslate"><span class="pre">angles</span></code>.</p>
<ol>
<li><p>A fault surface has an orientation (RHR) 190/80. Slickenlines on the fault trend 300.</p>
<ol class="simple">
<li><p>What is the plunge of the lineation?</p></li>
<li><p>What is the rake of the lineation on the fault?</p></li>
</ol>
</li>
<li><p>A shale bed has an orientation (RHR) 115/42. What is the apparent dip of the bed in the direction 265?</p></li>
<li><p>A sandstone bed strikes 140across a stream. The stream flows down a narrow gorge with vertical walls. The apparent dip of the bed on the walls of the gorge is 095/25. What is the true dip of the bed?</p></li>
<li><p>In the geologic map of <a class="reference internal" href="#ch04-fig07"><span class="std std-numref">Figure 4.7</span></a>, points 1 to 9 have the following <strong>ENU</strong> coordinates:</p>
<ul class="simple">
<li><p>point1 = [1580, 379, 400]</p></li>
<li><p>point2 = [1234, 992, 300]</p></li>
<li><p>point3 = [2054, 1753, 400]</p></li>
<li><p>point4 = [448, 1424, 600]</p></li>
<li><p>point5 = [1921, 2195, 500]</p></li>
<li><p>point6 = [1408, 3737, 300]</p></li>
<li><p>point7 = [536, 2196, 700]</p></li>
<li><p>point8 = [743, 2963, 600]</p></li>
<li><p>point9 = [2720, 2963, 600]</p></li>
</ul>
<ol class="simple">
<li><p>Compute the strike and dip of the coal seam (points 1-3).</p></li>
<li><p>Compute the strike and dip of the contact where the blue points 4-6 are located. What kind of contact is this? Is the coal seam below or above this contact?</p></li>
<li><p>Compute the strike and dip of the contact between units Y and Z (points 7-9). Is this contact below or above the contact in b?</p></li>
<li><p>The line of section V-W has a trend of 142. What is the apparent dip of the three contacts above along the section?</p></li>
<li><p>Draw a schematic cross section along line V-W</p></li>
</ol>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Use function <code class="docutils literal notranslate"><span class="pre">three_points</span></code> to solve a, b and c. Use the module <code class="docutils literal notranslate"><span class="pre">angles</span></code> to solve d.</p>
</div>
<figure class="align-default" id="ch04-fig07">
<a class="reference internal image-reference" href="_images/ch04_fig07.png"><img alt="_images/ch04_fig07.png" src="_images/ch04_fig07.png" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.7 </span><span class="caption-text">Map for exercise 4. This is map 10 of Bennison et al. (2011).</span><a class="headerlink" href="#ch04-fig07" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</li>
<li><p>The map of <a class="reference internal" href="#ch04-fig08"><span class="std std-numref">Figure 4.8</span></a> shows an area of a reconnaissance survey in the Appalachian Valley and Ridge Province of western Maryland, USA. On the western half of the map, the contact between a shale horizon (B) and a sandstone unit (C) has been located in two areas. Three points on this contact have the following <strong>ENU</strong> coordinates:</p>
<ul class="simple">
<li><p>point1 = [862, 943, 500]</p></li>
<li><p>point2 = [692, 1212, 600]</p></li>
<li><p>point3 = [1050, 2205, 600]</p></li>
</ul>
<figure class="align-default" id="ch04-fig08">
<a class="reference internal image-reference" href="_images/ch04_fig08.png"><img alt="_images/ch04_fig08.png" src="_images/ch04_fig08.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.8 </span><span class="caption-text">Map for exercise 5.</span><a class="headerlink" href="#ch04-fig08" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>On the eastern half of the map, the contact between B and C was found exposed at three locations labelled x, y, and z. The <strong>ENU</strong> coordinates of these points are:</p>
<ul class="simple">
<li><p>pointx = [3298, 1487, 300]</p></li>
<li><p>pointy = [3203, 1031, 200]</p></li>
<li><p>pointz = [3894, 590, 400]</p></li>
</ul>
<ol class="simple">
<li><p>Compute the strike and dip of the contact on the western half of the map.</p></li>
<li><p>Compute the strike and dip of the contact on the eastern half of the map.</p></li>
<li><p>What kind of structure is present on the map?</p></li>
<li><p>Compute the intersection of the western and eastern contacts. What does this line represent?</p></li>
</ol>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Use function <code class="docutils literal notranslate"><span class="pre">three_points</span></code> to solve a and b. Use the module <code class="docutils literal notranslate"><span class="pre">angles</span></code> to solve d.</p>
</div>
</li>
<li><p>In problem 3, the error in azimuth is 5 and in apparent dip is 3. What is the uncertainty in the true dip of the bed? <em>Hint</em>: Use the module <code class="docutils literal notranslate"><span class="pre">angles_u</span></code>.</p></li>
<li><p>In the map of <a class="reference internal" href="#ch04-fig07"><span class="std std-numref">Figure 4.7</span></a>, the east and north coordinates of the points have 15 m error, and the elevations have 5 m error.</p>
<ol class="simple">
<li><p>What is the uncertainty in the strike and dip of the coal seam?</p></li>
<li><p>What is the uncertainty in the strike and dip of the unconformity?</p></li>
<li><p>What is the angle between the unconformity and the coal seam and what is the uncertainty in this angle?</p></li>
</ol>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Use function <code class="docutils literal notranslate"><span class="pre">three_points_u</span></code> to     solve a and b, and the module <code class="docutils literal notranslate"><span class="pre">angles_u</span></code> to solve c.</p>
</div>
</li>
</ol>
</section>
<section id="references">
<span id="ch04-7"></span><h2><span class="section-number">4.7. </span>References<a class="headerlink" href="#references" title="Permalink to this headline">#</a></h2>
<p>Allmendinger, R.W., Cardozo, N. and Fisher, D.W. 2012. Structural
Geology Algorithms: Vectors and Tensors. Cambridge University Press.</p>
<p>Bennison, G.M., Olver, P.A. and Moseley, K.A. 2011. An Introduction to
Geological Structures and Maps, 8th edition. Hodder Education.</p>
<p>Fisher, N.I., Lewis, T. and Embleton, B.J.J. 1987. Statistical analysis
of spherical data. Cambridge University Press.</p>
<p>Leyshon, P.R. and Lisle, R.J. 1996. Stereographic Projection Techniques
in Structural Geology. Butterworth Heinemann.</p>
<p>Marshak, S. and Mitra, G. 1988. Basic Methods of Structural Geology.
Prentice Hall.</p>
<p>Ragan, D.M. 2009. Structural Geology: An Introduction to Geometrical
Techniques. Cambridge University Press.</p>
<p>Taylor, J.R. 1997. An Introduction to Error Analysis, 2nd edition.
University Science Books.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "afantunes74/compgeo_tests",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="ch03_geological_features.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">3. </span>Geological features</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="ch05_transformations.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">5. </span>Transformations</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Nestor Cardozo<br/>
  
      &copy; Copyright 2023.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>