
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>9. Elasticity &#8212; Computational Geosciences</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Introduction to Python and Jupyter Notebooks" href="notebooks/ch01/ch01_nb01.html" />
    <link rel="prev" title="8. Strain" href="ch08_strain.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Computational Geosciences</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to the Computational Geosciences resource
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  GET STARTED
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="preface.html">
   Preface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="changelog.html">
   Changelog
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="todo.html">
   TODOs
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  CONTENTS
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="ch01_computation_geosciences.html">
   1. Computation in Geosciences
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch02_understanding_location.html">
   2. Understanding location
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch03_geological_features.html">
   3. Geological features
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch04_coordinate_systems_vectors.html">
   4. Coordinate systems and vectors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch05_transformations.html">
   5. Transformations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch06_tensors.html">
   6. Tensors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch07_stress.html">
   7. Stress
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch08_strain.html">
   8. Strain
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   9. Elasticity
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  THE COMPANION NOTEBOOKS
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch01/ch01_nb01.html">
   Introduction to Python and Jupyter Notebooks
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=lab/tree/docs/ch09_elasticity.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fch09_elasticity.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/ch09_elasticity.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#theory">
   9.1. Theory
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#horizontal-stress-in-the-crust">
     9.1.1. Horizontal stress in the crust
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#applications">
   9.2. Applications
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stresses-around-a-circular-hole">
     9.2.1. Stresses around a circular hole
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lithospheric-flexure">
     9.2.2. Lithospheric flexure
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#faults-as-elastic-dislocations">
     9.2.3. Faults as elastic dislocations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#wave-propagation">
     9.2.4. Wave propagation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   9.3. Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   9.4. References
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Elasticity</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#theory">
   9.1. Theory
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#horizontal-stress-in-the-crust">
     9.1.1. Horizontal stress in the crust
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#applications">
   9.2. Applications
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stresses-around-a-circular-hole">
     9.2.1. Stresses around a circular hole
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lithospheric-flexure">
     9.2.2. Lithospheric flexure
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#faults-as-elastic-dislocations">
     9.2.3. Faults as elastic dislocations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#wave-propagation">
     9.2.4. Wave propagation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   9.3. Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   9.4. References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="elasticity">
<span id="ch09"></span><h1><span class="section-number">9. </span>Elasticity<a class="headerlink" href="#elasticity" title="Permalink to this headline">#</a></h1>
<p>We have covered stress and strain separately, but now we should consider how stress and strain are related in rocks. This relationship depends on the rock mechanical properties, which themselves depend on physical conditions such as the state of stress, temperature, and strain rate. The mathematical models that describe the relationship between stress and strain are known as constitutive models. In this chapter, we will cover the simplest constitutive model, namely elasticity. Because rocks in the upper crust fracture (deform non-elastically) at even modest strains, elasticity is closely related to the concepts of infinitesimal strain (<a class="reference internal" href="ch08_strain.html#ch08-3"><span class="std std-ref">Section 8.3</span></a>), and it is ideal to solve infinitesimal-strain problems such as the propagation of seismic waves through the Earth. However, elasticity is also useful to understand other geological problems such as the processes leading to rock fractures, the flexure of the lithosphere under crustal loads, and even fault related folding, which can be envisioned as the summation of small deformation, elastic increments through time.</p>
<section id="theory">
<span id="ch09-1"></span><h2><span class="section-number">9.1. </span>Theory<a class="headerlink" href="#theory" title="Permalink to this headline">#</a></h2>
<p>In or study of elasticity, we will make some basic assumptions (Gudmunsson, 2011):</p>
<ul class="simple">
<li><p>The rock is homogeneous; this means that its properties do not vary with location.</p></li>
<li><p>The rock is isotropic; this means that its properties are the same regardless of direction.</p></li>
<li><p>The relation between stress and strain in the rock is linear and it is described by an elastic modulus (<a class="reference internal" href="#ch09-fig01"><span class="std std-numref">Figure 9.1</span></a>a).</p></li>
<li><p>The strains are infinitesimal (<a class="reference internal" href="ch08_strain.html#ch08-3"><span class="std std-ref">Section 8.3</span></a>).</p></li>
<li><p>When the rock is stressed it instantaneously becomes strained. When the stress is removed, the strain disappears immediately (double arrows in <a class="reference internal" href="#ch09-fig01"><span class="std std-numref">Figure 9.1</span></a>a).</p></li>
</ul>
<figure class="align-default" id="ch09-fig01">
<a class="reference internal image-reference" href="_images/ch09_fig01.png"><img alt="_images/ch09_fig01.png" src="_images/ch09_fig01.png" style="width: 550px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 9.1 </span><span class="caption-text"><strong>a.</strong> Linear-elastic, versus <strong>b.</strong> Actual strain-stress behavior of a rock sample under compression. Modified from Gudmunsson (2011) and Zoback (2010).</span><a class="headerlink" href="#ch09-fig01" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Thus, elastic deformation is linear and independent of both, the loading path and time. This facilitates the solution of elastic problems, as we will see in <a class="reference internal" href="#ch09-2"><span class="std std-ref">Section 9.2</span></a>. Since elasticity is path-independent, it is also possible to run elastic models forwards and backwards, which is convenient for solving inverse problems (<span class="xref myst">Chapter 10</span>). However, rocks are not linear elastic materials, and their behavior is more complex than that (<a class="reference internal" href="#ch09-fig01"><span class="std std-numref">Figure 9.1</span></a>b). Upon compressional loading in the lab, a rock sample experiences initially inelastic crack closing, followed by elastic behavior at very small strains, non-elastic permanent deformation, and finally failure (Zoback, 2010; <a class="reference internal" href="#ch09-fig01"><span class="std std-numref">Figure 9.1</span></a>b). Elasticity captures just a small portion of that.</p>
<p>For the basic assumptions above, the elastic model is expressed by the following equation in indicial format:</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq01">
<span class="eqno">(9.1)<a class="headerlink" href="#equation-ch09-eq01" title="Permalink to this equation">#</a></span>\[
\label{eq9.1}
\varepsilon_{ij}=\frac{1+\nu}{E}\sigma_{ij}-\frac{\nu}{E}\sigma_{kk}\delta_{ij}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{\varepsilon}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{\sigma}\)</span> are the strain and stress tensors, <span class="math notranslate nohighlight">\(E\)</span> is the Young’s modulus, <span class="math notranslate nohighlight">\(\nu\)</span> is the Poisson’s ratio, and <span class="math notranslate nohighlight">\(\delta_{ij}\)</span> is the Kronecker delta (1 if <span class="math notranslate nohighlight">\(i = j\)</span>, 0 otherwise). This equation is also known as the Hooke’s law.</p>
<p><span class="math notranslate nohighlight">\(E\)</span> and <span class="math notranslate nohighlight">\(\nu\)</span> become more clear if we consider a cube of rock under uniaxial stress (<span class="math notranslate nohighlight">\(\sigma_{11}=\sigma_1\)</span>, all other tractions = 0; <a class="reference internal" href="#ch09-fig02"><span class="std std-numref">Figure 9.2</span></a>a). Under this condition and from Eq. <a class="reference internal" href="#equation-ch09-eq01">(9.1)</a>, the strains are:</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq02">
<span class="eqno">(9.2)<a class="headerlink" href="#equation-ch09-eq02" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{gathered}
    \varepsilon_{11}=\frac{1}{E}\sigma_{11} \\
    \varepsilon_{22} = \varepsilon_{33} = \frac{-\nu}{E}\sigma_{11} = -\nu\varepsilon_{11}
\end{gathered}
\end{split}\]</div>
<figure class="align-default" id="ch09-fig02">
<a class="reference internal image-reference" href="_images/ch09_fig02.png"><img alt="_images/ch09_fig02.png" src="_images/ch09_fig02.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 9.2 </span><span class="caption-text">Cube of rock under <strong>a.</strong> Uniaxial stress, <strong>b.</strong> Simple shear, and <strong>c.</strong> Triaxial stress. Blue is initial and red is final configuration. Formulas show the elastic moduli <span class="math notranslate nohighlight">\(E\)</span>, <span class="math notranslate nohighlight">\(\nu\)</span>, <span class="math notranslate nohighlight">\(G\)</span> and <span class="math notranslate nohighlight">\(K\)</span>. Modified from Zoback (2010).</span><a class="headerlink" href="#ch09-fig02" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Therefore, <span class="math notranslate nohighlight">\(E\)</span> is the ratio of the axial stress to the axial strain, <span class="math notranslate nohighlight">\(\sigma_{11}/\varepsilon_{11}\)</span>. Since strain is adimensional, <span class="math notranslate nohighlight">\(E\)</span> has units of stress. In consolidated rocks, <span class="math notranslate nohighlight">\(E\)</span> can vary greatly from <span class="math notranslate nohighlight">\(\sim\)</span> 1 to 100 GPa (Gudmunsson, 2011, his Appendix D).</p>
<p><span class="math notranslate nohighlight">\(\nu\)</span> is the negative ratio of the lateral strain to the axial strain, <span class="math notranslate nohighlight">\(-\varepsilon_{33}/\varepsilon_{11}\)</span>. <span class="math notranslate nohighlight">\(\nu\)</span> is adimensional, and it can have values between 0 and 0.5. A nearly incompressible material such as rubber has a <span class="math notranslate nohighlight">\(\nu \sim 0.5\)</span>. Rubber maintains a nearly constant volume by laterally expanding just enough to compensate for a given shortening. A perfectly compressible material such as cork has a <span class="math notranslate nohighlight">\(\nu \sim 0.0\)</span>. Cork can be shortened without much lateral expanding. Rocks are somewhat compressible, they have a <span class="math notranslate nohighlight">\(\nu \sim 0.25\)</span> (Pollard and Fletcher, 2005).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A nice analogy for <span class="math notranslate nohighlight">\(\nu\)</span> is a bottle stopper. A cork stopper can be cylindrical, while a rubber stopper must be tapered.</p>
</div>
<p>Now, let’s look at the case of simple shear (all tractions 0 except <span class="math notranslate nohighlight">\(\sigma_{13}\)</span>, <a class="reference internal" href="#ch09-fig02"><span class="std std-numref">Figure 9.2</span></a>b). In this case, the strain is given by:</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq03">
<span class="eqno">(9.3)<a class="headerlink" href="#equation-ch09-eq03" title="Permalink to this equation">#</a></span>\[
\varepsilon_{13}=\frac{1+\nu}{E}\sigma_{13}
\]</div>
<p>which can be written in terms of the shear strain <span class="math notranslate nohighlight">\(\gamma_{13}\)</span> as (<a class="reference internal" href="ch08_strain.html#ch08-3"><span class="std std-ref">Section 8.3</span></a>):</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq04">
<span class="eqno">(9.4)<a class="headerlink" href="#equation-ch09-eq04" title="Permalink to this equation">#</a></span>\[\begin{split}
\label{eq9.4}
\begin{gathered}
    \gamma_{13}=\frac{2(1+\nu)}{E}\sigma_{13}\quad \\
    \frac{\sigma_{13}}{\gamma_{13}}=\frac{E}{2(1+\nu)}=G
\end{gathered}
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(G\)</span> is called the shear modulus (the ratio of the shear stress to the shear strain). For perfectly compressible material, <span class="math notranslate nohighlight">\(\nu=0\)</span> so <span class="math notranslate nohighlight">\(G=E/2\)</span>, and for incompressible material, <span class="math notranslate nohighlight">\(\nu=0.5\)</span> so <span class="math notranslate nohighlight">\(G=E/3\)</span>. For a rock with <span class="math notranslate nohighlight">\(\nu=0.25\)</span>, <span class="math notranslate nohighlight">\(G=E/2.5\)</span>.</p>
<p>Finally, let’s look at the more general case of triaxial stress (principal stress coordinate system and non-zero principal stresses, <a class="reference internal" href="#ch09-fig02"><span class="std std-numref">Figure 9.2</span></a>c). In this case, the axial strains are:</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq05">
<span class="eqno">(9.5)<a class="headerlink" href="#equation-ch09-eq05" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{gathered}
    \varepsilon_{11}=\frac{1}{E}\sigma_{11}-\frac{\nu}{E}\sigma_{22}-\frac{\nu}{E}\sigma_{33} \\
    \varepsilon_{22}=-\frac{\nu}{E}\sigma_{11}+\frac{1}{E}\sigma_{22}-\frac{\nu}{E}\sigma_{33} \\
    \varepsilon_{33}=-\frac{\nu}{E}\sigma_{11}-\frac{\nu}{E}\sigma_{22}+\frac{1}{E}\sigma_{33}
\end{gathered}
\end{split}\]</div>
<p>To visualize this deformation in terms of volumetric changes, we can compute the mean stress, <span class="math notranslate nohighlight">\(\sigma_m\)</span> (<a class="reference internal" href="ch07_stress.html#ch07-3"><span class="std std-ref">Section 7.3</span></a>), and the volumetric strain, <span class="math notranslate nohighlight">\(\Delta\)</span> (also called dilatation), as shown in <a class="reference internal" href="#ch09-fig02"><span class="std std-numref">Figure 9.2</span></a>c. The ratio of the mean stress to the volumetric strain, <span class="math notranslate nohighlight">\(\sigma_m/\Delta\)</span>, is called the bulk modulus, <span class="math notranslate nohighlight">\(K\)</span>, and it is given by:</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq06">
<span class="eqno">(9.6)<a class="headerlink" href="#equation-ch09-eq06" title="Permalink to this equation">#</a></span>\[
K=\frac{E}{3(1-2\nu)}
\]</div>
<p>The bulk modulus, <span class="math notranslate nohighlight">\(K\)</span>, approaches an infinite value as <span class="math notranslate nohighlight">\(\nu\)</span> approaches 0.5, i.e. as the material becomes incompressible. For a perfectly compressible material, <span class="math notranslate nohighlight">\(\nu=0\)</span> and <span class="math notranslate nohighlight">\(K=E/3\)</span>. Liquids are nearly incompressible, whereas gases are highly compressible. High porosity rocks are somewhat compressible (low <span class="math notranslate nohighlight">\(K\)</span>), whereas low porosity rocks tend to be less compressible (high <span class="math notranslate nohighlight">\(K\)</span>).</p>
<p><span class="math notranslate nohighlight">\(E\)</span>, <span class="math notranslate nohighlight">\(\nu\)</span>, <span class="math notranslate nohighlight">\(G\)</span> and <span class="math notranslate nohighlight">\(K\)</span> control the propagation of seismic waves in the Earth (<a class="reference internal" href="#ch09-2-4"><span class="std std-ref">Section 9.2.4</span></a>). If one can measure the velocity of compressional, <span class="math notranslate nohighlight">\(V_p\)</span>, and shear, <span class="math notranslate nohighlight">\(V_s\)</span>, seismic waves at a given depth, the Poisson’s ratio can be calculated from them (Fossen, 2016).</p>
<section id="horizontal-stress-in-the-crust">
<span id="ch09-1-1"></span><h3><span class="section-number">9.1.1. </span>Horizontal stress in the crust<a class="headerlink" href="#horizontal-stress-in-the-crust" title="Permalink to this headline">#</a></h3>
<p>Elasticity provides a first estimate of the horizontal stress, <span class="math notranslate nohighlight">\(\sigma_h\)</span>, in the crust. Consider a cube of rock in the subsurface. The cube is subject to an overburden vertical stress, <span class="math notranslate nohighlight">\(\sigma_v\)</span>, given by Eq. <a class="reference internal" href="ch07_stress.html#equation-ch07-eq02">(7.2)</a>. Due to this stress, the cube will shorten vertically and tend to expand laterally (<a class="reference internal" href="#ch09-fig02"><span class="std std-numref">Figure 9.2</span></a>a), but because it is confined by the rocks around, the horizontal strains will be zero. Since strain is only along the vertical, this condition is known as uniaxial strain.</p>
<p>Let’s assume <span class="math notranslate nohighlight">\(\sigma_{11}=\sigma_v\)</span> and <span class="math notranslate nohighlight">\(\sigma_{22}=\sigma_{33}=\sigma_h\)</span>. If the horizontal strains are zero, then we have <span class="math notranslate nohighlight">\(\varepsilon_h=\varepsilon_{22}=\varepsilon_{33}=0\)</span>. From Eq. <a class="reference internal" href="#equation-ch09-eq05">(9.5)</a> it follows that:</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq07">
<span class="eqno">(9.7)<a class="headerlink" href="#equation-ch09-eq07" title="Permalink to this equation">#</a></span>\[
\varepsilon_{22}=0=\frac{1}{E}[\sigma_h-\nu(\sigma_h+\sigma_v)]
\]</div>
<p>Since <span class="math notranslate nohighlight">\(1/E\neq 0\)</span>, then:</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq08">
<span class="eqno">(9.8)<a class="headerlink" href="#equation-ch09-eq08" title="Permalink to this equation">#</a></span>\[
\sigma_h-\nu\sigma_h-\nu\sigma_v=0
\]</div>
<p>or:</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq09">
<span class="eqno">(9.9)<a class="headerlink" href="#equation-ch09-eq09" title="Permalink to this equation">#</a></span>\[
\sigma_h=\frac{\nu}{1-\nu}\sigma_v
\]</div>
<p>Thus, according to elasticity, the ratio of the horizontal stress to the vertical stress, <span class="math notranslate nohighlight">\(\sigma_h/\sigma_v\)</span>, is a function of the Poisson’s ratio. This stress ratio is also known as <span class="math notranslate nohighlight">\(k\)</span> in rock mechanics (Hoek, 2006). In incompressible materials, <span class="math notranslate nohighlight">\(\nu = 0.5\)</span> and <span class="math notranslate nohighlight">\(k\)</span> reaches its maximum value of 1.0. In rocks, <span class="math notranslate nohighlight">\(\nu\sim 0.25\)</span> and <span class="math notranslate nohighlight">\(k\sim 0.33\)</span>. Eq. <a class="reference internal" href="#equation-ch09-eq09">(9.9)</a> may be applicable to young sedimentary rocks in large stable basins, or young volcanic areas with lava flows close to the surface. However, over geological time there will be tectonic stresses in active areas, which make the uniaxial assumption invalid (Gudmunsson, 2011). In fact, in the crust at a given depth instead of a single value of horizontal stress <span class="math notranslate nohighlight">\(\sigma_h\)</span>, we have a maximum, <span class="math notranslate nohighlight">\(\sigma_H\)</span>, and minimum, <span class="math notranslate nohighlight">\(\sigma_h\)</span>, horizontal stress (Ragan, 2009; Zoback, 2010). In crustal areas under tectonic compression, <span class="math notranslate nohighlight">\(\sigma_H&gt;\sigma_v\)</span> and <span class="math notranslate nohighlight">\(k&gt;1.0\)</span> (Hoek, 2006).</p>
</section>
</section>
<section id="applications">
<span id="ch09-2"></span><h2><span class="section-number">9.2. </span>Applications<a class="headerlink" href="#applications" title="Permalink to this headline">#</a></h2>
<p>In this section, we will discuss four applications of the theory of elasticity. These applications are varied and encompass the fields of geomechanics, basin analysis, structural geology, and geophysics. As in the rest of the book, we introduce briefly the theory and move directly to the code implementation. More details about the applications and the derivation of the equations can be found in the references provided.</p>
<section id="stresses-around-a-circular-hole">
<span id="ch09-2-1"></span><h3><span class="section-number">9.2.1. </span>Stresses around a circular hole<a class="headerlink" href="#stresses-around-a-circular-hole" title="Permalink to this headline">#</a></h3>
<p>The problem of the stresses around a circular hole in a material is one of the most important problems in rock mechanics (Jaeger et al., 2007, their section 8.5). Since most holes drilled through rock are of circular cross section (e.g. tunnels and boreholes), it is not hard to see why this is the case. This problem was first solved by the German engineer Kirsch in 1898. <a class="reference internal" href="#ch09-fig03"><span class="std std-numref">Figure 9.3</span></a>a shows the principal stress trajectories around a cylindrical hole in a biaxial stress field based on the Kirsch equations. Since the hole is a free surface, the principal stress trajectories are parallel and perpendicular to it. Where the trajectories of <span class="math notranslate nohighlight">\(\sigma_1\)</span> converge, stresses are more compressive (at the azimuth of <span class="math notranslate nohighlight">\(\sigma_3\)</span>). Where the trajectories of <span class="math notranslate nohighlight">\(\sigma_1\)</span> diverge, the stresses are less compressive (at the azimuth of <span class="math notranslate nohighlight">\(\sigma_1\)</span>).</p>
<figure class="align-default" id="ch09-fig03">
<a class="reference internal image-reference" href="_images/ch09_fig03.png"><img alt="_images/ch09_fig03.png" src="_images/ch09_fig03.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 9.3 </span><span class="caption-text"><strong>a.</strong> Principal stress trajectories around a cylindrical hole under far-field stresses. Continuous lines are <span class="math notranslate nohighlight">\(\sigma_{1}\)</span> and dashed lines are <span class="math notranslate nohighlight">\(\sigma_{3}\)</span> trajectories. <strong>b.</strong> Plate with a circular hole under far-field stresses. To solve this problem we use a polar coordinate system as indicated in the inset. Modified from Zoback (2010) and Allmendinger (2020).</span><a class="headerlink" href="#ch09-fig03" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>To solve this problem, we use a polar coordinate system as indicated in <a class="reference internal" href="#ch09-fig03"><span class="std std-numref">Figure 9.3</span></a>b. The hole has a radius, <span class="math notranslate nohighlight">\(a\)</span>, and the stresses are calculated at a distance, <span class="math notranslate nohighlight">\(r\)</span>, from the center of the hole. Any orientation is defined by an angle, <span class="math notranslate nohighlight">\(\theta\)</span>, measured counterclockwise from <span class="math notranslate nohighlight">\(\sigma_3\)</span>. For the case where <span class="math notranslate nohighlight">\(\sigma_{11} = \sigma_1\)</span> and <span class="math notranslate nohighlight">\(\sigma_{33} = \sigma_3\)</span> and there is fluid pressure, <span class="math notranslate nohighlight">\(P_f\)</span>, in the hole, the radial and tangential normal stresses are (Jaeger et al., 2007):</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq10">
<span class="eqno">(9.10)<a class="headerlink" href="#equation-ch09-eq10" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{gathered}
    \sigma_{r r}=\frac{\left(\sigma_{1}+\sigma_{3}\right)}{2}\left[1-\left(\frac{a}{r}\right)^{2}\right]+\frac{\left(\sigma_{3}-\sigma_{1}\right)}{2}\left[1-4\left(\frac{a}{r}\right)^{2}+3\left(\frac{a}{r}\right)^{4}\right] \cos 2 \theta+P_{f}\left(\frac{a}{r}\right)^{2} \\ \\
    \sigma_{\theta \theta}=\frac{\left(\sigma_{1}+\sigma_{3}\right)}{2}\left[1+\left(\frac{a}{r}\right)^{2}\right]-\frac{\left(\sigma_{3}-\sigma_{1}\right)}{2}\left[1+3\left(\frac{a}{r}\right)^{4}\right] \cos 2 \theta-P_{f}\left(\frac{a}{r}\right)^{2}
\end{gathered}
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(\sigma_{\theta\theta}\)</span> is commonly referred to as the <em>hoop stress</em>.</p>
<p>The function <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/functions/hoop.py">hoop</a> computes the hoop and radial stresses near a circular hole, assuming the hole is on a principal plane, <span class="math notranslate nohighlight">\(\sigma_3\)</span> is at <span class="math notranslate nohighlight">\(\theta=0\,\textrm{or}\, 180\)</span>, and <span class="math notranslate nohighlight">\(\sigma_1\)</span> is at <span class="math notranslate nohighlight">\(\theta=90\,\textrm{or}\, 270\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>


<span class="k">def</span> <span class="nf">hoop</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span><span class="n">stress</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    hoop computes the hoop and radial stresses </span>
<span class="sd">    around a circular hole. assuming that </span>
<span class="sd">    the circle is on a principal plane,</span>
<span class="sd">    smax (s1) is N-S (theta = 90 or 270), </span>
<span class="sd">    and smin (s3) is E-W (theta = 0 or 180)</span>
<span class="sd">    Based on Jaeger et al. (2007)</span>

<span class="sd">    USE: shm, srm, fig, ax = hoop(geom,stress)</span>

<span class="sd">    geom: A 1 x 2 vector with the number of points </span>
<span class="sd">        along the radius, and the number of points </span>
<span class="sd">        around the circle. These values are used</span>
<span class="sd">        to construct the grid around the circle</span>
<span class="sd">    stress: A 1 x 3 vector with the value of s1, s3,</span>
<span class="sd">        and fluid pressure (pf), all in MPa</span>
<span class="sd">    shm, srm: maximum hoop and radial stresses and</span>
<span class="sd">        their theta orientations</span>

<span class="sd">    fig and ax are handles to the figure and axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="c1"># pi </span>

    <span class="c1"># Geometry</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">geom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># points along radius</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">geom</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># points around circle</span>
    <span class="n">R1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1"># radius of hole = 1.0 </span>
    <span class="n">R2</span> <span class="o">=</span> <span class="n">R1</span> <span class="o">*</span> <span class="mi">5</span> <span class="c1"># outer radius = 5.0</span>
    <span class="n">nR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">R1</span><span class="p">,</span><span class="n">R2</span><span class="p">,</span><span class="n">M</span><span class="p">)</span>
    <span class="n">nT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
    <span class="n">R</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">nR</span><span class="p">,</span><span class="n">nT</span><span class="p">)</span>
    
    <span class="c1"># Convert grid to cartesian coordintes</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">m</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>

    <span class="c1"># Principal stresses and pore pressure (MPa)</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="n">stress</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
    <span class="n">s3</span> <span class="o">=</span> <span class="n">stress</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">pf</span> <span class="o">=</span> <span class="n">stress</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Initialize hoop and radial stresses</span>
    <span class="n">sh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="c1"># Initialize maximum hoop and radial stresses</span>
    <span class="n">shm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">srm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Compute hoop and radial stresses</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            
            <span class="c1"># Hoop stress</span>
            <span class="n">sh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1</span><span class="o">+</span><span class="n">s3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">R1</span><span class="o">/</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> \
                <span class="o">-</span><span class="p">(</span><span class="n">s3</span><span class="o">-</span><span class="n">s1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">R1</span><span class="o">/</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> \
                <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span> <span class="o">-</span> <span class="n">pf</span><span class="o">*</span><span class="p">(</span><span class="n">R1</span><span class="o">/</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
            
            <span class="c1"># Radial stress</span>
            <span class="n">sr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1</span><span class="o">+</span><span class="n">s3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="n">R1</span><span class="o">/</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> \
                <span class="o">+</span><span class="p">(</span><span class="n">s3</span><span class="o">-</span><span class="n">s1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">R1</span><span class="o">/</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">R1</span><span class="o">/</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> \
                <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="n">pf</span><span class="o">*</span><span class="p">(</span><span class="n">R1</span><span class="o">/</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
            
            <span class="c1"># maximum hoop stress</span>
            <span class="k">if</span> <span class="n">sh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">shm</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">shm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
                <span class="n">shm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span>
            
            <span class="c1"># maximum radial stress</span>
            <span class="k">if</span> <span class="n">sr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">srm</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">srm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
                <span class="n">srm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span>

    <span class="c1"># Create figure</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

    <span class="c1"># Plot hoop stress</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>  
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">Y</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;k&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">Y</span><span class="p">[:,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="s2">&quot;k&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">sh</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>    
    <span class="n">cstr</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">sh</span><span class="p">,</span> <span class="n">colors</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cbar</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MPa&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Hoop stress&quot;</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>

    <span class="c1"># Plot radial stress</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>  
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">Y</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;k&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">Y</span><span class="p">[:,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="s2">&quot;k&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">)</span>
    <span class="n">cstr</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">sr</span><span class="p">,</span> <span class="n">colors</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cbar</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MPa&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Radial stress&quot;</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>

    <span class="c1"># Plot variation of hoop and radial stress along s3</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">/</span><span class="n">R1</span><span class="p">,</span><span class="n">sh</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="s2">&quot;r.-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Hoop&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">/</span><span class="n">R1</span><span class="p">,</span><span class="n">sr</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="s2">&quot;b.-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Radial&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Normalized radial distance&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Stress (MPa)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Stress variation along s3&quot;</span><span class="p">,</span>
        <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>

    <span class="c1"># Plot variation of hoop and radial stress around circle</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">,</span><span class="n">sh</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;r.-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Hoop&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">,</span><span class="n">sr</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="s2">&quot;b.-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Radial&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">270</span><span class="p">,</span> <span class="mi">360</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Angle around the hole (deg)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Stress (MPa)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Stress variation around circle&quot;</span><span class="p">,</span>
        <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">shm</span><span class="p">,</span> <span class="n">srm</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s use this function to compute the hoop and radial stresses near a circular hole, for <span class="math notranslate nohighlight">\(\sigma_1 = 50\)</span> and <span class="math notranslate nohighlight">\(\sigma_3 = 25\)</span> MPa. The notebook <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/notebooks/ch9-1.ipynb">ch9-1</a> shows the solution to this problem:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import function hoop</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">compgeo.hoop</span> <span class="kn">import</span> <span class="n">hoop</span>

<span class="c1"># Define the geometry, 50 points along radius</span>
<span class="c1"># 100 points around circle</span>
<span class="n">geom</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>

<span class="c1"># Define stress: sigma1 = 50, sigma3 = 25, Pf = 0 MPa </span>
<span class="n">stress</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># Compute and plot hoop and radial stresses</span>
<span class="n">shm</span><span class="p">,</span> <span class="n">srm</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">hoop</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="n">stress</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ch09_elasticity_33_0.png" src="_images/ch09_elasticity_33_0.png" />
</div>
</div>
<p>Around the hole, the hoop stress is maximum (<span class="math notranslate nohighlight">\(\sigma_{\theta\theta}=2.5\sigma_1\)</span>) at the azimuth of <span class="math notranslate nohighlight">\(\sigma_3\)</span> (<span class="math notranslate nohighlight">\(\theta=0\,\textrm{or}\, 180\)</span>), and it is minimum (<span class="math notranslate nohighlight">\(\sigma_{\theta\theta}=\sigma_3\)</span>) at the azimuth of <span class="math notranslate nohighlight">\(\sigma_1\)</span> (<span class="math notranslate nohighlight">\(\theta=90\,\textrm{or}\, 270\)</span>) (right graph). However, the hoop stress decreases quite rapidly to the far-field stress values. At <span class="math notranslate nohighlight">\(\theta=0\,\textrm{or}\, 180\)</span>, the hoop stress reaches the far-field value of <span class="math notranslate nohighlight">\(\sigma_1\)</span> at a distance <span class="math notranslate nohighlight">\(5r\)</span> (left graph). The radial stress, <span class="math notranslate nohighlight">\(\sigma_{rr}\)</span>, is zero around the hole, and reaches the far-field stress values at a distance <span class="math notranslate nohighlight">\(5r\)</span>. Try experimenting with different values of principal stresses and pore pressure.</p>
<p>Since in a circular hole, the hoop stress is maximum at the azimuth of <span class="math notranslate nohighlight">\(\sigma_3\)</span>, and minimum at the azimuth of <span class="math notranslate nohighlight">\(\sigma_1\)</span>, one would expect the rock to fail by compression near <span class="math notranslate nohighlight">\(\sigma_3\)</span>, and by tension near <span class="math notranslate nohighlight">\(\sigma_1\)</span>. This is exactly what happens in a borehole (<a class="reference internal" href="#ch09-fig04"><span class="std std-numref">Figure 9.4</span></a>a). In the regions of maximum hoop stress, the rock fails by compression and shear, forming shattered rock areas called <em>breakouts</em>. Near the regions of minimum hoop stress, the rock fails by tension, forming tension cracks. This allows determining from borehole images, the orientation of <span class="math notranslate nohighlight">\(\sigma_3\)</span>, and if the borehole is vertical, the orientation of <span class="math notranslate nohighlight">\(\sigma_H\)</span> and <span class="math notranslate nohighlight">\(\sigma_h\)</span> (<a class="reference internal" href="#ch09-fig04"><span class="std std-numref">Figure 9.4</span></a>b).</p>
<figure class="align-default" id="ch09-fig04">
<a class="reference internal image-reference" href="_images/ch09_fig04.png"><img alt="_images/ch09_fig04.png" src="_images/ch09_fig04.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 9.4 </span><span class="caption-text"><strong>a.</strong> Breakouts and tension cracks around a vertical borehole. <strong>b.</strong> Breakouts in ultrasonic borehole image appear as dark bands. Inset shows a cross-sectional view of the well made with televiewer data. Breakouts indicate a SE-NW <span class="math notranslate nohighlight">\(\sigma_{3}\)</span> orientation. Modified from Allmendinger (2020) and Zoback (2010).</span><a class="headerlink" href="#ch09-fig04" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="lithospheric-flexure">
<span id="ch09-2-2"></span><h3><span class="section-number">9.2.2. </span>Lithospheric flexure<a class="headerlink" href="#lithospheric-flexure" title="Permalink to this headline">#</a></h3>
<p>The deflection of the surface of the Earth under crustal loads (e.g. a fold-thrust belt; <a class="reference internal" href="#ch09-fig05"><span class="std std-numref">Figure 9.5</span></a>a) can be reasonably estimated by an elastic or flexural model. In this model, the uppermost layer of the Earth (i.e. the elastic lithosphere) responds to crustal loads as an elastic beam floating in a weaker, fluid-like foundation, the astenospheric mantle (<a class="reference internal" href="#ch09-fig05"><span class="std std-numref">Figure 9.5</span></a>b) (Turcotte and Schubert, 1982; Watts, 2001).</p>
<figure class="align-default" id="ch09-fig05">
<a class="reference internal image-reference" href="_images/ch09_fig05.png"><img alt="_images/ch09_fig05.png" src="_images/ch09_fig05.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 9.5 </span><span class="caption-text"><strong>a.</strong> Fold-thrust belt and foreland basin. <strong>b.</strong> Conceptual elastic model for <strong>a</strong>. <strong>c.</strong> Uniformly distributed load over an infinite beam. The figures show the situation for a point <span class="math notranslate nohighlight">\(C\)</span> under, to the left, and to the right of the load. <strong>a</strong> and <strong>b</strong> are from Van Der Pluijm and Marshak (2004) and <strong>c</strong> from Hetenyi (1946).</span><a class="headerlink" href="#ch09-fig05" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>This flexural model provides insight into how tectonic loads (e.g. fold-thrust belts) and sedimentary basins (e.g. foreland basins) are linked, and how the crust and mantle support loads. The flexural model has allowed geologists to understand the regional variations of strength of the lithosphere, and the implications these variations have for mountain building, sedimentary basin formation, and earthquakes (Watts, 2001).</p>
<p>The physics of this model is the same as that of an elastic beam on an elastic foundation. If the thickness of the beam is constant, the beam is infinite, and the height of the load is constant, the solution is relatively simple (Hetenyi, 1946). We first use the flexural ridigidity, <span class="math notranslate nohighlight">\(D\)</span>, to express the strength of the elastic lithosphere:</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq11">
<span class="eqno">(9.11)<a class="headerlink" href="#equation-ch09-eq11" title="Permalink to this equation">#</a></span>\[
D=\frac{ETe^3}{12(1-\nu^2)}
\]</div>
<p>where <span class="math notranslate nohighlight">\(Te\)</span> is the thickness of the elastic lithosphere (<a class="reference internal" href="#ch09-fig05"><span class="std std-numref">Figure 9.5</span></a>b). We then invent a term <span class="math notranslate nohighlight">\(D_{(\alpha,x)}\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq12">
<span class="eqno">(9.12)<a class="headerlink" href="#equation-ch09-eq12" title="Permalink to this equation">#</a></span>\[
\label{eq9.12}
D_{(\alpha,x)}=\exp(-x/\alpha)\cos(x/\alpha)
\]</div>
<p>where <span class="math notranslate nohighlight">\(x\)</span> is the horizontal coordinate and <span class="math notranslate nohighlight">\(\alpha\)</span> is a length parameter given by:</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq13">
<span class="eqno">(9.13)<a class="headerlink" href="#equation-ch09-eq13" title="Permalink to this equation">#</a></span>\[
\alpha=\left[\frac{4D}{\rho_f g}\right]^{\frac{1}{4}}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho_f\)</span> is the density of the foundation, which is the difference between the density of the mantle, <span class="math notranslate nohighlight">\(\rho_m\)</span>, and the density of the material filling the basin, <span class="math notranslate nohighlight">\(\rho_s\)</span>. <span class="math notranslate nohighlight">\(g\)</span> is gravity. The deflection <span class="math notranslate nohighlight">\(u\)</span> of any point <span class="math notranslate nohighlight">\(C\)</span> along the beam can then be computed as (<a class="reference internal" href="#ch09-fig05"><span class="std std-numref">Figure 9.5</span></a>c):</p>
<ul>
<li><p>If the point is under the load:</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq14">
<span class="eqno">(9.14)<a class="headerlink" href="#equation-ch09-eq14" title="Permalink to this equation">#</a></span>\[
    u = \frac{q}{2k}(2-D_{(\alpha,a)}-D_{(\alpha,b)})
    \]</div>
</li>
<li><p>If the point is to the left of the load:
$<span class="math notranslate nohighlight">\(
  u = \frac{q}{2k}(D_{(\alpha,a)}-D_{(\alpha,b)})
  \)</span>$ (ch09_eq15)</p></li>
<li><p>If the point is to the right of the load:
$<span class="math notranslate nohighlight">\(
  u = -\frac{q}{2k}(D_{(\alpha,a)}-D_{(\alpha,b)})
  \)</span>$ (ch09_eq16)</p></li>
</ul>
<p>where <span class="math notranslate nohighlight">\(\frac{q}{k}=h\frac{\rho}{\rho_f}\)</span>, <span class="math notranslate nohighlight">\(h\)</span> is the height of the load, and <span class="math notranslate nohighlight">\(\rho\)</span> is the load density. <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are measured as absolute distances from the point to the left and right borders of the load (<a class="reference internal" href="#ch09-fig05"><span class="std std-numref">Figure 9.5</span></a>c).</p>
<p>Although these equations allow us to compute only the deflection produced by a rectangular load column, we can approximate any load profile by discretizing it into narrower load columns. Since the deformation is elastic, the total deflection profile is the sum of the deflection profiles of the load columns (principle of superposition).</p>
<p>The function <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/functions/flex2d.py">flex2d</a> computes the deflection profile produced by a group of load columns on an elastic lithosphere resting on a fluid-like foundation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="k">as</span> <span class="nn">ticker</span>


<span class="k">def</span> <span class="nf">flex2d</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span><span class="n">elas</span><span class="p">,</span><span class="n">loads</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    flex2d computes the deflection profile produced by </span>
<span class="sd">    a group of load columns on an elastic lithosphere </span>
<span class="sd">    resting on a fluid-like foundation </span>
<span class="sd">    (i.e. astenosphere). The program is based on </span>
<span class="sd">    Hetenyi (1946) solution for an infinite elastic </span>
<span class="sd">    beam on a fluid-like foundation</span>

<span class="sd">    USE: w, wp, fig, ax = flex2d(geom,elas,loads)</span>

<span class="sd">    geom: A 1 x 2 vector with the lateral extent of the </span>
<span class="sd">        domain in meters, and the distance between</span>
<span class="sd">        points (x interval) in meters where the</span>
<span class="sd">        deflection will be computed</span>
<span class="sd">    elas: A 1 x 4 vector with the Young Modulus (in Pa), </span>
<span class="sd">        Poisson ratio, Elastic thickness in meters, </span>
<span class="sd">        and density of the foundation in kg/m^3</span>
<span class="sd">    loads: A nloads x 4 vector with the left x coordinate,</span>
<span class="sd">        right x coordinate, height, and density of each</span>
<span class="sd">        load column. Lengths should be in meters and </span>
<span class="sd">        density in kg/m^3</span>
<span class="sd">    w: The deflection of the lithosphere in meters at the </span>
<span class="sd">        points specified by the extent and x interval</span>
<span class="sd">    wp: 3 x 2 matrix with key deflection parameters: </span>
<span class="sd">        1st row is the maximum deflection (maximum basin</span>
<span class="sd">        depth) and x at this location</span>
<span class="sd">        2nd row is the zero deflection and x at this </span>
<span class="sd">        location (basin width)</span>
<span class="sd">        3rd row is the minimum deflection (forebulge) </span>
<span class="sd">        and x at this location</span>

<span class="sd">    fig and ax are handles to the figure and axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Geometry</span>
    <span class="n">extent</span> <span class="o">=</span> <span class="n">geom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># Extent in x</span>
    <span class="n">xint</span> <span class="o">=</span> <span class="n">geom</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Interval in x</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">extent</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">xint</span><span class="p">)</span> <span class="c1"># points in x</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="c1"># initialize displacement</span>

    <span class="c1"># Elastic and flexural parameters</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">elas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># Young Modulus</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">elas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Poisson ratio</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">elas</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># Elastic thickness</span>
    
    <span class="c1"># Flexural rigidity</span>
    <span class="n">rigid</span> <span class="o">=</span> <span class="p">(</span><span class="n">E</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">h</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">12</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">v</span><span class="o">*</span><span class="n">v</span><span class="p">))</span> 
    <span class="n">densup</span> <span class="o">=</span> <span class="n">elas</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># Density of foundation</span>
    <span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span> <span class="c1"># Gravity</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">densup</span><span class="o">*</span><span class="n">g</span> <span class="c1"># Support of foundation</span>
    
    <span class="c1"># Flexural parameter</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="p">((</span><span class="mi">4</span><span class="o">*</span><span class="n">rigid</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> 

    <span class="c1"># Loads</span>
    <span class="n">lxmin</span> <span class="o">=</span> <span class="n">loads</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">lxmax</span> <span class="o">=</span> <span class="n">loads</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">lh</span> <span class="o">=</span> <span class="n">loads</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">ldens</span> <span class="o">=</span> <span class="n">loads</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>

    <span class="c1"># Compute deflection profile</span>
    <span class="c1"># for all the loads columns</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lxmin</span><span class="p">)):</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">lh</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">ldens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="mf">9.81</span>
        
        <span class="c1"># for all points in x</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
            <span class="n">tolf</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">lxmin</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">tort</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">lxmax</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">dA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">tolf</span><span class="o">/</span><span class="n">alpha</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">tolf</span><span class="o">/</span><span class="n">alpha</span><span class="p">)</span>
            <span class="n">dB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">tort</span><span class="o">/</span><span class="n">alpha</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">tort</span><span class="o">/</span><span class="n">alpha</span><span class="p">)</span>
            
            <span class="c1"># If below the load</span>
            <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">lxmin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">and</span> <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">lxmax</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">w</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">q</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mf">2.0</span><span class="o">-</span><span class="n">dA</span><span class="o">-</span><span class="n">dB</span><span class="p">)</span>
            
            <span class="c1"># If to the left of the load</span>
            <span class="k">elif</span> <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lxmin</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">w</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">q</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">dA</span><span class="o">-</span><span class="n">dB</span><span class="p">)</span>
            
            <span class="c1"># If to the right of the load</span>
            <span class="k">elif</span> <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">lxmax</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">w</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">q</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">dA</span><span class="o">-</span><span class="n">dB</span><span class="p">)</span>

    <span class="c1"># Key deflection parameters</span>
    <span class="n">wp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    
    <span class="c1"># maximum basin depth</span>
    <span class="n">v</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span>
    <span class="n">wp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
    <span class="n">wp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
    
    <span class="c1"># basin width</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">w</span> <span class="o">&lt;=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">wp</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">wp</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    
    <span class="c1"># forebulge</span>
    <span class="n">v</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
    <span class="n">wp</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
    <span class="n">wp</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>

    <span class="c1"># Plot</span>
    <span class="c1"># Input loads profile</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>    

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lxmin</span><span class="p">)):</span>
        <span class="n">xcol</span> <span class="o">=</span> <span class="p">[</span><span class="n">lxmin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lxmin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lxmax</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lxmax</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">ycol</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">lh</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lh</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">,</span><span class="s2">&quot;k-&quot;</span><span class="p">)</span>
    
    <span class="n">maxlh</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">lh</span><span class="p">)</span><span class="o">*</span><span class="mf">1.25</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">geom</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">maxlh</span><span class="p">,</span> <span class="n">maxlh</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;m&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;m&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">FormatStrFormatter</span>
        <span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.0e</span><span class="s2">&quot;</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Input loads&quot;</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>

    <span class="c1"># Deflected loads plus deflection</span>
    <span class="n">wl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">lxmin</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>
    <span class="n">wr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">lxmax</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lxmin</span><span class="p">)):</span>
        <span class="n">xcol</span> <span class="o">=</span> <span class="p">[</span><span class="n">lxmin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lxmin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lxmax</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lxmax</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">ycol</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">wl</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lh</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">wl</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lh</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">wr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">-</span><span class="n">wr</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">,</span><span class="s2">&quot;k-&quot;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="n">w</span><span class="p">,</span><span class="s2">&quot;b-&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">geom</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">maxlh</span><span class="p">,</span> <span class="n">maxlh</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;m&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;m&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">FormatStrFormatter</span>
        <span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.0e</span><span class="s2">&quot;</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Deflected loads&quot;</span><span class="p">,</span><span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">w</span><span class="p">,</span> <span class="n">wp</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s use this function to compute the deflection produced by a group of crustal loads. The file <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/data/ch9-2/loads.txt">loads.txt</a> contains the load columns. Each column is specified by the left and right <span class="math notranslate nohighlight">\(x\)</span> coordinates, height and density. The notebook <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/notebooks/ch9-2.ipynb">ch9-2</a> shows the solution to this problem:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Import function flex2d</span>
<span class="kn">from</span> <span class="nn">compgeo.flex2d</span> <span class="kn">import</span> <span class="n">flex2d</span>

<span class="c1"># Geometry</span>
<span class="n">geom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">geom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">500e3</span> <span class="c1"># extent = 500 km</span>
<span class="n">geom</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">5e3</span> <span class="c1"># Interval in x =  5 km</span>

<span class="c1"># Elastic and flexural parameters</span>
<span class="n">elas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">elas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">70e9</span> <span class="c1"># Young Modulus = 70 GPa</span>
<span class="n">elas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="c1"># Poisson&quot;s ratio = 0.25</span>
<span class="n">elas</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">30e3</span> <span class="c1"># Elastic thickness = 30 km</span>
<span class="n">elas</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3300</span> <span class="c1"># Density of mantle in kg/m^3</span>

<span class="c1"># loads</span>
<span class="n">loads</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s2">&quot;data/ch9-2/loads.txt&quot;</span><span class="p">))</span>

<span class="c1"># Compute deflection profile</span>
<span class="n">w</span><span class="p">,</span> <span class="n">wp</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">flex2d</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="n">elas</span><span class="p">,</span> <span class="n">loads</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ch09_elasticity_49_0.png" src="_images/ch09_elasticity_49_0.png" />
</div>
</div>
</section>
<section id="faults-as-elastic-dislocations">
<span id="ch09-2-3"></span><h3><span class="section-number">9.2.3. </span>Faults as elastic dislocations<a class="headerlink" href="#faults-as-elastic-dislocations" title="Permalink to this headline">#</a></h3>
<p>One of the simplest ways to model a fault is as an elastic dislocation. A dislocation element consists of a line segment in 2D or a polygon (typically a triangle or rectangle) in 3D across which displacement is discontinuous. In the case of a fault, the value of the dislocation is the amount of slip on the fault. A dislocation element representing a fault is typically embedded in an elastic half space, which is a medium that deforms elastically and has infinite extent downward but a horizontal upper surface (the ground surface) along which no shear stress is allowed. By specifying the position and size of the dislocation element and the amount of slip on it, the displacements, strains, and stresses anywhere in the half space can be calculated.</p>
<p><a class="reference internal" href="#ch09-fig06"><span class="std std-numref">Figure 9.6</span></a>a-b is a great example from a normal fault earthquake, the M = 7.0, October 28, 1983, Bora Peak, Idaho, earthquake on the Lost River fault (Stein and Barrientos, 1985). The dots in <a class="reference internal" href="#ch09-fig06"><span class="std std-numref">Figure 9.6</span></a>a are elevation changes measured at ground locations in a 50 years period. These can be considered coseismic displacements (Stein and Barrientos, 1985). The blue line is the elastic dislocation model for the elevation changes. As you can see, the model fit is quite good. <a class="reference internal" href="#ch09-fig06"><span class="std std-numref">Figure 9.6</span></a>b shows the modelled fault in cross section. The fault dips <span class="math notranslate nohighlight">\(\sim\)</span><!-- -->45, extends from the surface to a depth of <span class="math notranslate nohighlight">\(\sim\)</span><!-- -->14 km, and is consistent with aftershocks (circles) and the earthquake focal mechanism. <a class="reference internal" href="#ch09-fig06"><span class="std std-numref">Figure 9.6</span></a>c shows a geologic cross section along the same profile. Notice that the top basement profile is similar to the displacement profile (<a class="reference internal" href="#ch09-fig06"><span class="std std-numref">Figure 9.6</span></a>a) but enlarged <span class="math notranslate nohighlight">\(\sim\)</span><!-- -->1000 times, as if it were the result of many similar earthquakes over geologic time!</p>
<figure class="align-default" id="ch09-fig06">
<a class="reference internal image-reference" href="_images/ch09_fig06.png"><img alt="_images/ch09_fig06.png" src="_images/ch09_fig06.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 9.6 </span><span class="caption-text"><strong>a.</strong> Elevation changes (dots) produced by the Bora Peak earthquake, and elastic dislocation model (blue). <strong>b.</strong> Cross section including the modelled fault (red), aftershocks (circles), and earthquake focal mechanism. <strong>c.</strong> Geologic cross section. <strong>d.</strong> Geometry of edge dislocation at depth in an elastic half space. Symbols are explained in the text. <strong>a</strong>-<strong>c</strong> are from Stein and Barrientos (1985) and d from Segall (2010).</span><a class="headerlink" href="#ch09-fig06" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>To model faults as elastic dislocation elements in 2D, we use the geometry illustrated in <a class="reference internal" href="#ch09-fig06"><span class="std std-numref">Figure 9.6</span></a>d. The dislocation is located at <span class="math notranslate nohighlight">\(\xi_1 = 0\)</span>, <span class="math notranslate nohighlight">\(\xi_2\)</span>. The displacements along <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> are (Segall, 2010):</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq17">
<span class="eqno">(9.15)<a class="headerlink" href="#equation-ch09-eq17" title="Permalink to this equation">#</a></span>\[\begin{split}
%\resizebox{1.05\hsize}{!}
{\begin{aligned} u_{1}=&amp; -\frac{s_{1}}{\pi(1-\nu)}\left\{\frac{(1-\nu)}{2}\left(\theta_{2}-\theta_{1}\right)+\frac{x_{1}\left(x_{2}-\xi_{2}\right)}{4 r_{1}^{2}}-\frac{x_{1}\left[x_{2}+(3-4 \nu) \xi_{2}\right]}{4 r_{2}^{2}}+\frac{\xi_{2} x_{2} x_{1}\left(x_{2}+\xi_{2}\right)}{r_{2}^{4}}\right\} \\ &amp;+\frac{s_{2}}{\pi(1-\nu)}\left\{\frac{(1-2 \nu)}{4} \log \left(r_{2} / r_{1}\right)-\frac{\left(x_{2}-\xi_{2}\right)^{2}}{4 r_{1}^{2}}+\frac{\left[x_{2}^{2}+\xi_{2}^{2}-4(1-\nu) \xi_{2}\left(x_{2}+\xi_{2}\right)\right]}{4 r_{2}^{2}}\right.\\ &amp;\left.+\frac{x_{2} \xi_{2}\left(x_{2}+\xi_{2}\right)^{2}}{r_{2}^{4}}\right\} \\ u_{2}=&amp; -\frac{s_{1}}{\pi(1-\nu)}\left\{\frac{(1-2 \nu)}{4} \log \left(r_{2} / r_{1}\right)+\frac{\left(x_{2}-\xi_{2}\right)^{2}}{4 r_{1}^{2}}-\frac{\left[\left(x_{2}+\xi_{2}\right)^{2}-2 \xi_{2}^{2}-2(1-2 \nu) \xi_{2}\left(x_{2}+\xi_{2}\right)\right]}{4 r_{2}^{2}}\right.\\ &amp;\left.+\frac{x_{2} \xi_{2}\left(x_{2}+\xi_{2}\right)^{2}}{r_{2}^{4}}\right\}+\frac{s_{2}}{\pi(1-\nu)}\left\{\frac{(1-\nu)}{2}\left(\theta_{1}-\theta_{2}\right)+\frac{x_{1}\left(x_{2}-\xi_{2}\right)}{4 r_{1}^{2}}-\frac{x_{1}\left[x_{2}+(3-4 \nu) \xi_{2}\right]}{4 r_{2}^{2}}\right.\\ &amp;\left.-\frac{\xi_{2} x_{2} x_{1}\left(x_{2}+\xi_{2}\right)}{r_{2}^{4}}\right\} \end{aligned}$}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(s_1\)</span> and <span class="math notranslate nohighlight">\(s_2\)</span> are the slip components along <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span>, and:</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq18">
<span class="eqno">(9.16)<a class="headerlink" href="#equation-ch09-eq18" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{array}{l}r_{1}^{2}=x_{1}^{2}+\left(x_{2}-\xi_{2}\right)^{2} \\ \\ r_{2}^{2}=x_{1}^{2}+\left(x_{2}+\xi_{2}\right)^{2}\end{array}
\end{split}\]</div>
<p>measure the squared distance from the observation point to the dislocation and the image dislocation (a mirror image of the dislocation above the ground surface), respectively (<a class="reference internal" href="#ch09-fig06"><span class="std std-numref">Figure 9.6</span></a>d). <span class="math notranslate nohighlight">\(\theta_1\)</span> refers to the angle about the dislocation, and <span class="math notranslate nohighlight">\(\theta_2\)</span> refers to the angle about the image dislocation (<a class="reference internal" href="#ch09-fig06"><span class="std std-numref">Figure 9.6</span></a>d):</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq19">
<span class="eqno">(9.17)<a class="headerlink" href="#equation-ch09-eq19" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{gathered}
    \theta_{1}=\tan ^{-1}\left(\frac{x_{1}-\xi_{1}}{x_{2}-\xi_{2}}\right) \\
    \theta_{2}=\tan ^{-1}\left(\frac{x_{1}-\xi_{1}}{x_{2}+\xi_{2}}\right)
\end{gathered}
\end{split}\]</div>
<p>Notice that in terms of elastic moduli, the displacements in Eq. <a class="reference internal" href="#equation-ch09-eq17">(9.15)</a> depend only on the Poisson’s ratio <span class="math notranslate nohighlight">\(\nu\)</span>. Also for a dislocation not at <span class="math notranslate nohighlight">\(\xi_1 = 0\)</span>, simply replace <span class="math notranslate nohighlight">\(x_1\)</span> with <span class="math notranslate nohighlight">\(x_1 - \xi_1\)</span> in Eq. <a class="reference internal" href="#equation-ch09-eq17">(9.15)</a>.</p>
<p>The function <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/functions/disloc2d.py">disloc2d</a> computes the displacements on a 2D planar fault of finite extent, modeled by two edge dislocations in an elastic half space. Notice that <code class="docutils literal notranslate"><span class="pre">disloc2d</span></code> uses the function <code class="docutils literal notranslate"><span class="pre">displacement</span></code>, which computes Eqs. <a class="reference internal" href="#equation-ch09-eq17">(9.15)</a>-<a class="reference internal" href="#equation-ch09-eq19">(9.17)</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">arctan</span><span class="p">,</span><span class="n">arctan2</span><span class="p">,</span><span class="n">sin</span><span class="p">,</span><span class="n">cos</span><span class="p">,</span><span class="n">sign</span><span class="p">,</span><span class="n">sqrt</span><span class="p">,</span><span class="n">pi</span><span class="p">,</span><span class="n">mod</span><span class="p">,</span><span class="n">log</span>


<span class="k">def</span> <span class="nf">disloc2d</span><span class="p">(</span><span class="n">tip</span><span class="p">,</span><span class="n">base</span><span class="p">,</span><span class="n">slip</span><span class="p">,</span><span class="n">nu</span><span class="p">,</span><span class="n">obsx</span><span class="p">,</span><span class="n">obsy</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function calculates displacements on a 2D planar </span>
<span class="sd">    fault of finite extent, modeled by two edge dislocations </span>
<span class="sd">    in a homogeneous, isotropic elastic half space</span>

<span class="sd">    Arguments:</span>
<span class="sd">        tip = tuple of (x,y) coordinates of the fault tip</span>
<span class="sd">        base = tuple of (x,y) coordinates of the fault base</span>
<span class="sd">        slip = slip on the fault, + for reverse, - for normal</span>
<span class="sd">        nu = Poisson&#39;s ratio (scalar)</span>
<span class="sd">        obsx = x coordinates of observation points </span>
<span class="sd">        obsy = y coordinates of observation points</span>
<span class="sd">    Returns:</span>
<span class="sd">        ux = x components of displ. vectors at obs. points </span>
<span class="sd">        uy = y components of displ. vectors at obs. points</span>

<span class="sd">    disloc2d uses function displacement</span>

<span class="sd">    Written by David Oakley (david.o.oakley@uis.no)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dip</span> <span class="o">=</span> <span class="n">arctan2</span><span class="p">(</span><span class="n">tip</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">base</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">tip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">base</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="n">slip</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">dip</span><span class="p">)</span>
    <span class="n">s2</span> <span class="o">=</span> <span class="n">slip</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">dip</span><span class="p">)</span>
    
    <span class="p">[</span><span class="n">ux_part1</span><span class="p">,</span><span class="n">uy_part1</span><span class="p">]</span> <span class="o">=</span> <span class="n">displacement</span><span class="p">(</span><span class="n">tip</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">tip</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span>
        <span class="n">nu</span><span class="p">,</span><span class="n">obsx</span><span class="p">,</span><span class="n">obsy</span><span class="p">)</span>
    <span class="p">[</span><span class="n">ux_part2</span><span class="p">,</span><span class="n">uy_part2</span><span class="p">]</span> <span class="o">=</span> <span class="n">displacement</span><span class="p">(</span><span class="n">base</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">base</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="o">-</span><span class="n">s1</span><span class="p">,</span><span class="o">-</span><span class="n">s2</span><span class="p">,</span>
        <span class="n">nu</span><span class="p">,</span><span class="n">obsx</span><span class="p">,</span><span class="n">obsy</span><span class="p">)</span>
    
    <span class="n">ux</span> <span class="o">=</span> <span class="n">ux_part1</span><span class="o">+</span><span class="n">ux_part2</span>
    <span class="n">uy</span> <span class="o">=</span> <span class="n">uy_part1</span><span class="o">+</span><span class="n">uy_part2</span>
    
    <span class="k">return</span> <span class="n">ux</span><span class="p">,</span><span class="n">uy</span>


<span class="k">def</span> <span class="nf">displacement</span><span class="p">(</span><span class="n">xi1</span><span class="p">,</span><span class="n">xi2</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">nu</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate displacements (u1,u2) in 2D in a half space at</span>
<span class="sd">    points (x1,x2) due to an edge dislocation at (xi1,xi2) with </span>
<span class="sd">    slip vector (s1,s2). This uses Eqs from Segall (2010), </span>
<span class="sd">    as corrected in the Errata to that book. Indices 1 and 2 </span>
<span class="sd">    correspond to the x and y directions respectively.</span>
<span class="sd">    Arguments:</span>
<span class="sd">        xi1 = x coordinate of the dislocation tip </span>
<span class="sd">        xi2 = y coordinate of the dislocation tip </span>
<span class="sd">        x1 = x coordinates of observation points </span>
<span class="sd">        x2 = y coordinates of observation points </span>
<span class="sd">        s1 = x component of slip vector </span>
<span class="sd">        s2 = y component of slip vector </span>
<span class="sd">        nu = Poisson&quot;s ratio </span>
<span class="sd">    Returns:</span>
<span class="sd">        ux = x components of displ. vectors at obs. points </span>
<span class="sd">        uy = y components of displ. vectors at obs. points </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># This occurs if the fault dips to the left</span>
    <span class="k">if</span> <span class="n">sign</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span><span class="o">==</span><span class="n">sign</span><span class="p">(</span><span class="n">s2</span><span class="p">):</span> 
        <span class="c1"># Flip to the sign convention that Segall&quot;s equations use</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="o">-</span><span class="n">s1</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="o">-</span><span class="n">s2</span>
    
    <span class="c1"># These equations are written for xi1 = 0. If that&#39;s not </span>
    <span class="c1"># the case, this makes it equivalent to that case</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">x1</span><span class="o">-</span><span class="n">xi1</span> 
    <span class="n">r1_sq</span> <span class="o">=</span> <span class="n">x1</span><span class="o">**</span><span class="mf">2.</span><span class="o">+</span><span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">xi2</span><span class="p">)</span><span class="o">**</span><span class="mf">2.</span>
    <span class="n">r2_sq</span> <span class="o">=</span> <span class="n">x1</span><span class="o">**</span><span class="mf">2.</span><span class="o">+</span><span class="p">(</span><span class="n">x2</span><span class="o">+</span><span class="n">xi2</span><span class="p">)</span><span class="o">**</span><span class="mf">2.</span>
    <span class="n">r1</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">r1_sq</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">r2_sq</span><span class="p">)</span>
    <span class="n">log_r2_r1</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">r2</span><span class="o">/</span><span class="n">r1</span><span class="p">)</span>
    
    <span class="c1"># Calculate the angles relative to the vertical axis</span>
    <span class="n">theta1</span> <span class="o">=</span> <span class="n">arctan2</span><span class="p">(</span><span class="n">x1</span><span class="p">,(</span><span class="n">x2</span><span class="o">-</span><span class="n">xi2</span><span class="p">))</span>
    <span class="n">theta2</span> <span class="o">=</span> <span class="n">arctan2</span><span class="p">(</span><span class="n">x1</span><span class="p">,(</span><span class="n">x2</span><span class="o">+</span><span class="n">xi2</span><span class="p">))</span>
    <span class="n">dip</span> <span class="o">=</span> <span class="n">arctan</span><span class="p">(</span><span class="n">s2</span><span class="o">/</span><span class="n">s1</span><span class="p">)</span>
    
    <span class="c1"># This puts dip in the range [0,pi]</span>
    <span class="k">if</span> <span class="n">dip</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">dip</span><span class="o">=</span><span class="n">dip</span><span class="o">+</span><span class="n">pi</span> 
    
    <span class="c1"># The following puts the atan branch cuts along the fault </span>
    <span class="c1"># by rotating theta1 to point down the fault and theta2 to </span>
    <span class="c1"># point up (above the half space) along it</span>
    <span class="c1"># Shift theta1 to be measured up from the fault</span>
    <span class="n">theta1</span> <span class="o">=</span> <span class="n">theta1</span><span class="o">+</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="o">+</span><span class="n">dip</span>
    
    <span class="c1"># Shift theta2 to be measured from a line pointing up </span>
    <span class="c1"># opposite the fault from the image dislocation</span>
    <span class="n">theta2</span> <span class="o">=</span> <span class="n">theta2</span><span class="o">+</span><span class="n">dip</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span> 
    <span class="n">theta1</span> <span class="o">=</span> <span class="n">mod</span><span class="p">(</span><span class="n">theta1</span><span class="p">,</span><span class="mf">2.</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">theta2</span> <span class="o">=</span> <span class="n">mod</span><span class="p">(</span><span class="n">theta2</span><span class="p">,</span><span class="mf">2.</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span>
    
    <span class="c1"># Make a correction for rounding errors that can occur </span>
    <span class="c1"># when theta1 or theta2 is very close to 0 or 2*pi.</span>
    <span class="n">theta1</span><span class="p">[</span><span class="mf">2.</span><span class="o">*</span><span class="n">pi</span><span class="o">-</span><span class="n">theta1</span><span class="o">&lt;</span><span class="mf">1e-10</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">theta2</span><span class="p">[</span><span class="mf">2.</span><span class="o">*</span><span class="n">pi</span><span class="o">-</span><span class="n">theta2</span><span class="o">&lt;</span><span class="mf">1e-10</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">theta_diff</span> <span class="o">=</span> <span class="n">theta1</span><span class="o">-</span><span class="n">theta2</span>
    
    <span class="c1"># These are two very long equations....</span>
    <span class="n">u1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">s1</span><span class="o">/</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">nu</span><span class="p">)))</span><span class="o">*</span><span class="p">(((</span><span class="mf">1.</span><span class="o">-</span><span class="n">nu</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">theta_diff</span><span class="p">)</span><span class="o">+</span><span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">xi2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">4.</span><span class="o">*</span><span class="n">r1_sq</span><span class="p">)</span> <span class="o">-</span> <span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="n">x2</span><span class="o">+</span><span class="p">(</span><span class="mf">3.</span><span class="o">-</span><span class="mf">4.</span><span class="o">*</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="n">xi2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">4.</span><span class="o">*</span><span class="n">r2_sq</span><span class="p">)</span><span class="o">+</span><span class="n">xi2</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="n">x2</span><span class="o">+</span><span class="n">xi2</span><span class="p">)</span><span class="o">/</span><span class="n">r2_sq</span><span class="o">**</span><span class="mf">2.</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">s2</span><span class="o">/</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">nu</span><span class="p">)))</span><span class="o">*</span><span class="p">(((</span><span class="mf">1.</span><span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="n">nu</span><span class="p">)</span><span class="o">/</span><span class="mf">4.</span><span class="p">)</span><span class="o">*</span><span class="n">log_r2_r1</span><span class="o">-</span><span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">xi2</span><span class="p">)</span><span class="o">**</span><span class="mf">2.</span><span class="o">/</span><span class="p">(</span><span class="mf">4.</span><span class="o">*</span><span class="n">r1_sq</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x2</span><span class="o">**</span><span class="mf">2.</span><span class="o">+</span><span class="n">xi2</span><span class="o">**</span><span class="mf">2.</span><span class="o">-</span><span class="mf">4.</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="n">xi2</span><span class="o">*</span><span class="p">(</span><span class="n">x2</span><span class="o">+</span><span class="n">xi2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mf">4.</span><span class="o">*</span><span class="n">r2_sq</span><span class="p">)</span><span class="o">+</span><span class="n">x2</span><span class="o">*</span><span class="n">xi2</span><span class="o">*</span><span class="p">(</span><span class="n">x2</span><span class="o">+</span><span class="n">xi2</span><span class="p">)</span><span class="o">**</span><span class="mf">2.</span><span class="o">/</span><span class="n">r2_sq</span><span class="o">**</span><span class="mf">2.</span><span class="p">)</span>
    <span class="n">u2</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">s1</span><span class="o">/</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">nu</span><span class="p">)))</span><span class="o">*</span><span class="p">(((</span><span class="mf">1.</span><span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="n">nu</span><span class="p">)</span><span class="o">/</span><span class="mf">4.</span><span class="p">)</span><span class="o">*</span><span class="n">log_r2_r1</span><span class="o">+</span><span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">xi2</span><span class="p">)</span><span class="o">**</span><span class="mf">2.</span><span class="o">/</span><span class="p">(</span><span class="mf">4.</span><span class="o">*</span><span class="n">r1_sq</span><span class="p">)</span> <span class="o">-</span> <span class="p">((</span><span class="n">x2</span><span class="o">+</span><span class="n">xi2</span><span class="p">)</span><span class="o">**</span><span class="mf">2.</span><span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="n">xi2</span><span class="o">**</span><span class="mf">2.</span><span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="n">xi2</span><span class="o">*</span><span class="p">(</span><span class="n">x2</span><span class="o">+</span><span class="n">xi2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mf">4.</span><span class="o">*</span><span class="n">r2_sq</span><span class="p">)</span> <span class="o">+</span> <span class="n">x2</span><span class="o">*</span><span class="n">xi2</span><span class="o">*</span><span class="p">(</span><span class="n">x2</span><span class="o">+</span><span class="n">xi2</span><span class="p">)</span><span class="o">**</span><span class="mf">2.</span><span class="o">/</span><span class="n">r2_sq</span><span class="o">**</span><span class="mf">2.</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">s2</span><span class="o">/</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">nu</span><span class="p">)))</span><span class="o">*</span><span class="p">(((</span><span class="mf">1.</span><span class="o">-</span><span class="n">nu</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">theta_diff</span><span class="p">)</span> <span class="o">+</span> <span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">xi2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">4.</span><span class="o">*</span><span class="n">r1_sq</span><span class="p">)</span><span class="o">-</span><span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="n">x2</span><span class="o">+</span><span class="p">(</span><span class="mf">3.</span><span class="o">-</span><span class="mf">4.</span><span class="o">*</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="n">xi2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">4.</span><span class="o">*</span><span class="n">r2_sq</span><span class="p">)</span><span class="o">-</span><span class="n">xi2</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="n">x2</span><span class="o">+</span><span class="n">xi2</span><span class="p">)</span><span class="o">/</span><span class="n">r2_sq</span><span class="o">**</span><span class="mf">2.</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">u1</span><span class="p">,</span> <span class="n">u2</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s use this function to compute the surface deformation, displacement vectors, and fold growth produced by a 30reverse fault. The notebook <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/notebooks/ch9-3.ipynb">ch9-3</a> shows the solution to this problem. First, we import the required libraries and functions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="c1"># Import function disloc2d</span>
<span class="kn">from</span> <span class="nn">compgeo.disloc2d</span> <span class="kn">import</span> <span class="n">disloc2d</span>
</pre></div>
</div>
</div>
</div>
<p>Then, we define the geometry of the fault (upper and lower tips), Poisson’s ratio, and fault slip. The units of length are meters. In this case, we define a blind (non-surface breaking) 30dipping reverse fault, with its upper tip 500 m below the surface (and at <span class="math notranslate nohighlight">\(x = 0\)</span> m) and its lower tip 1500 m below the surface. The fault slip is 2 m:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the fault:</span>
<span class="n">dip</span> <span class="o">=</span> <span class="mf">30.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.0</span> <span class="c1">#Fault dip in radians</span>
<span class="n">xt</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">yt</span> <span class="o">=</span> <span class="o">-</span><span class="mf">500.0</span>
<span class="n">yb</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1500.0</span>
<span class="n">xb</span> <span class="o">=</span> <span class="n">xt</span><span class="o">-</span><span class="p">(</span><span class="n">yt</span><span class="o">-</span><span class="n">yb</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">dip</span><span class="p">)</span>
<span class="n">tip</span> <span class="o">=</span> <span class="p">(</span><span class="n">xt</span><span class="p">,</span><span class="n">yt</span><span class="p">)</span>
<span class="n">base</span> <span class="o">=</span> <span class="p">(</span><span class="n">xb</span><span class="p">,</span><span class="n">yb</span><span class="p">)</span>
<span class="n">nu</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="c1">#Poisson&#39;s ratio</span>
<span class="n">slip</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="c1">#Positive for reverse, negative for normal</span>
</pre></div>
</div>
</div>
</div>
<p>To compute the deformation at the Earth’s surface produced by this fault, we create observation points at the surface on a transect perpendicular to the fault. We apply the elastic deformation, and plot the uplift of the points. We observe a maximum uplift of about 0.8 m above the fault as well as a small amount of subsidence away from the fault. Deformation of the Earth’s surface such as modeled here is often observed after an earthquake and can be used to make inferences about the geometry of and amount of slip on the fault that caused the earthquake.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Define the observation points at the surface</span>
<span class="n">obsx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">3000.0</span><span class="p">,</span><span class="mf">3100.0</span><span class="p">,</span><span class="mf">10.0</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">obsy1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">obsx1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1">#Apply slip and deform the surface</span>
<span class="n">ux</span><span class="p">,</span><span class="n">uy</span> <span class="o">=</span> <span class="n">disloc2d</span><span class="p">(</span><span class="n">tip</span><span class="p">,</span><span class="n">base</span><span class="p">,</span><span class="n">slip</span><span class="p">,</span><span class="n">nu</span><span class="p">,</span><span class="n">obsx1</span><span class="p">,</span><span class="n">obsy1</span><span class="p">)</span>
<span class="n">obsx1</span> <span class="o">=</span> <span class="n">obsx1</span><span class="o">+</span><span class="n">ux</span>
<span class="n">obsy1</span> <span class="o">=</span> <span class="n">obsy1</span><span class="o">+</span><span class="n">uy</span>

<span class="c1">#Plot the result</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">obsx1</span><span class="p">,</span><span class="n">obsy1</span><span class="p">,</span><span class="s2">&quot;k-&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Distance (m)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Uplift (m)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Surface Deformation&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ch09_elasticity_65_0.png" src="_images/ch09_elasticity_65_0.png" />
</div>
</div>
<p>We now create a two-dimensional grid of observation points around the fault and display the displacement vectors at these points. From the resulting figure, we can clearly see that material moves upward in the hanging wall of the fault and downward in its footwall with displacements greatest near the fault and continuous everywhere except across the fault.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Define observation points in a region around the fault.</span>
<span class="n">obsx2</span><span class="p">,</span> <span class="n">obsy2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">2500.0</span><span class="p">,</span><span class="mf">1100.0</span><span class="p">,</span><span class="mf">100.0</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">2500.0</span><span class="p">,</span><span class="mf">100.0</span><span class="p">,</span><span class="mf">100.0</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">))</span>

<span class="c1">#Ignore divide by zero error for point right at fault tip.</span>
<span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> 
<span class="c1">#Apply slip and calculate displacement vectors.</span>
<span class="n">ux</span><span class="p">,</span><span class="n">uy</span> <span class="o">=</span> <span class="n">disloc2d</span><span class="p">(</span><span class="n">tip</span><span class="p">,</span><span class="n">base</span><span class="p">,</span><span class="n">slip</span><span class="p">,</span><span class="n">nu</span><span class="p">,</span><span class="n">obsx2</span><span class="p">,</span><span class="n">obsy2</span><span class="p">)</span>

<span class="c1">#Plot the result.</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xt</span><span class="p">,</span><span class="n">xb</span><span class="p">],[</span><span class="n">yt</span><span class="p">,</span><span class="n">yb</span><span class="p">],</span><span class="s1">&#39;r-&#39;</span><span class="p">)</span> <span class="c1">#Plot the fault</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">obsx2</span><span class="p">,</span> <span class="n">obsy2</span><span class="p">,</span> <span class="n">ux</span><span class="p">,</span> <span class="n">uy</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiverkey</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;1 m displacement&#39;</span><span class="p">,</span> <span class="n">labelpos</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Distance (m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Elevation (m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Displacement Vectors&#39;</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ch09_elasticity_67_0.png" src="_images/ch09_elasticity_67_0.png" />
</div>
</div>
<p>While the plots above are from a single earthquake, repeated slip on a fault will cause much larger cumulative deformation (<a class="reference internal" href="#ch09-fig06"><span class="std std-numref">Figure 9.6</span></a>c). The rocks above blind faults are frequently folded, and elastic dislocation theory provides a way to model the formation of such folds in response to faulting. We create three horizontal rows of observation points, representing stratigraphic horizons, and we then apply 200 increments of slip (of 2 m each) to the fault. The result is that the stratigraphic layers above the fault are folded into an asymmetric anticline.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Define the observation points as horizontal beds</span>
<span class="n">obsx3</span><span class="p">,</span> <span class="n">obsy3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">2500.0</span><span class="p">,</span><span class="mf">1100.0</span><span class="p">,</span>
    <span class="mf">100.0</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),[</span><span class="o">-</span><span class="mf">400.0</span><span class="p">,</span><span class="o">-</span><span class="mf">300.0</span><span class="p">,</span><span class="o">-</span><span class="mf">200.0</span><span class="p">])</span>

<span class="c1">#Plot the initial state:</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xt</span><span class="p">,</span><span class="n">xb</span><span class="p">],[</span><span class="n">yt</span><span class="p">,</span><span class="n">yb</span><span class="p">],</span><span class="s1">&#39;r-&#39;</span><span class="p">)</span> <span class="c1">#Plot the fault</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">obsx3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">obsx3</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span><span class="n">obsy3</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Elevation (m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Initial State&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="c1">#Apply repeated slip increments and displace </span>
<span class="c1">#the observation points.</span>
<span class="n">n_inc</span> <span class="o">=</span> <span class="mi">200</span> <span class="c1">#Total number of increments.</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_inc</span><span class="p">):</span>
    <span class="n">ux</span><span class="p">,</span><span class="n">uy</span> <span class="o">=</span> <span class="n">disloc2d</span><span class="p">(</span><span class="n">tip</span><span class="p">,</span><span class="n">base</span><span class="p">,</span><span class="n">slip</span><span class="p">,</span><span class="n">nu</span><span class="p">,</span><span class="n">obsx3</span><span class="p">,</span><span class="n">obsy3</span><span class="p">)</span>
    <span class="n">obsx3</span> <span class="o">=</span> <span class="n">obsx3</span><span class="o">+</span><span class="n">ux</span>
    <span class="n">obsy3</span> <span class="o">=</span> <span class="n">obsy3</span><span class="o">+</span><span class="n">uy</span>
    
<span class="c1">#Plot the final state:</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xt</span><span class="p">,</span><span class="n">xb</span><span class="p">],[</span><span class="n">yt</span><span class="p">,</span><span class="n">yb</span><span class="p">],</span><span class="s1">&#39;r-&#39;</span><span class="p">)</span> <span class="c1">#Plot the fault</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">obsx3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">obsx3</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span><span class="n">obsy3</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Distance (m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Elevation (m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Final State&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ch09_elasticity_69_0.png" src="_images/ch09_elasticity_69_0.png" />
</div>
</div>
<p>Try a normal fault dipping 60.</p>
</section>
<section id="wave-propagation">
<span id="ch09-2-4"></span><h3><span class="section-number">9.2.4. </span>Wave propagation<a class="headerlink" href="#wave-propagation" title="Permalink to this headline">#</a></h3>
<p>The propagation of waves in elastic media can be derived from the equation of motion and Hooke’s law. The equation of motion relates the displacements, <span class="math notranslate nohighlight">\(\mathbf{u}\)</span>, to the stresses, <span class="math notranslate nohighlight">\(\boldsymbol{\sigma}\)</span>. Combining Hooke’s law with the equation of motion leads to a system of equations describing the propagation of stresses and displacements in a continuum. The equation of motion is given by (Pollard and Fletcher, 2005):</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq20">
<span class="eqno">(9.18)<a class="headerlink" href="#equation-ch09-eq20" title="Permalink to this equation">#</a></span>\[
\rho\frac{\partial^2 u_i}{\partial t^2} = \frac{\partial \sigma_{ij}}{\partial X_j}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho\)</span> is density. The Hooke’s law (Eq. <a class="reference internal" href="#equation-ch09-eq01">(9.1)</a>) can also be written as (Pollard and Fletcher, 2005):</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq21">
<span class="eqno">(9.19)<a class="headerlink" href="#equation-ch09-eq21" title="Permalink to this equation">#</a></span>\[
\sigma_{ij}= 2G \varepsilon_{ij} + \lambda \varepsilon_{kk}\delta_{ij}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda = \frac{E\nu}{(1 + \nu)(1-2\nu)}\)</span> is the Lamé’s constant, <span class="math notranslate nohighlight">\(G\)</span> is the shear modulus (Eq. <a class="reference internal" href="#equation-ch09-eq04">(9.4)</a>), and <span class="math notranslate nohighlight">\(\varepsilon_{ij} = \frac{1}{2}\left(\frac{\partial u_i}{\partial X_j}+\frac{\partial u_j}{\partial X_i}\right)\)</span> is the infinitesimal strain tensor (Eq. <a class="reference internal" href="ch08_strain.html#equation-ch08-eq15">(8.15)</a>).</p>
<p>Let’s assume a 2-D isotropic and linearly elastic medium with a horizontal axis, <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>, and a vertical axis, <span class="math notranslate nohighlight">\(\mathbf{z}\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For simplicity, we use in this section <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{z}\)</span> instead of <span class="math notranslate nohighlight">\(\mathbf{X_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{X_2}\)</span>.</p>
</div>
<p>Eqs. <a class="reference internal" href="#equation-ch09-eq20">(9.18)</a> and <a class="reference internal" href="#equation-ch09-eq21">(9.19)</a> become:</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq22">
<span class="eqno">(9.20)<a class="headerlink" href="#equation-ch09-eq22" title="Permalink to this equation">#</a></span>\[
\rho\frac{\partial^2u_x}{\partial t^2}=\frac{\partial\sigma_{xx}}{\partial x}+\frac{\partial\sigma_{xz}}{\partial z}
\]</div>
<div class="math notranslate nohighlight" id="equation-ch09-eq23">
<span class="eqno">(9.21)<a class="headerlink" href="#equation-ch09-eq23" title="Permalink to this equation">#</a></span>\[
\rho\frac{\partial^2u_z}{\partial t^2}=\frac{\partial\sigma_{xz}}{\partial x}+\frac{\partial\sigma_{zz}}{\partial z}
\]</div>
<div class="math notranslate nohighlight" id="equation-ch09-eq24">
<span class="eqno">(9.22)<a class="headerlink" href="#equation-ch09-eq24" title="Permalink to this equation">#</a></span>\[
\sigma_{xx}=\left(\lambda+2G\right)\frac{\partial u_x}{\partial x}+\lambda\frac{\partial u_z}{\partial z}
\]</div>
<div class="math notranslate nohighlight" id="equation-ch09-eq25">
<span class="eqno">(9.23)<a class="headerlink" href="#equation-ch09-eq25" title="Permalink to this equation">#</a></span>\[
\sigma_{zz}=\left(\lambda+2G\right)\frac{\partial u_z}{\partial z}+\lambda\frac{\partial u_x}{\partial x}
\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq26">
<span class="eqno">(9.24)<a class="headerlink" href="#equation-ch09-eq26" title="Permalink to this equation">#</a></span>\[
\sigma_{xz}=G\left(\frac{\partial u_x}{\partial z}+\frac{\partial u_z}{\partial x}\right)
\]</div>
<p>These equations are known as the <em>elastodynamic</em> equations. They can be further simplified into a first-order hyperbolic system of equations by using velocity instead of displacement (Virieux, 1986):</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq27">
<span class="eqno">(9.25)<a class="headerlink" href="#equation-ch09-eq27" title="Permalink to this equation">#</a></span>\[
\frac{\partial v_x}{\partial t}=b\left(\frac{\partial \sigma_{xx}}{\partial x}+\frac{\partial\sigma_{xz}}{\partial z}\right)
\]</div>
<div class="math notranslate nohighlight" id="equation-ch09-eq28">
<span class="eqno">(9.26)<a class="headerlink" href="#equation-ch09-eq28" title="Permalink to this equation">#</a></span>\[
\frac{\partial v_z}{\partial t}=b\left(\frac{\partial \sigma_{xz}}{\partial x}+\frac{\partial\sigma_{zz}}{\partial z}\right)
\]</div>
<div class="math notranslate nohighlight" id="equation-ch09-eq29">
<span class="eqno">(9.27)<a class="headerlink" href="#equation-ch09-eq29" title="Permalink to this equation">#</a></span>\[
\frac{\partial\sigma_{xx}}{\partial t}=\left(\lambda+2G\right)\frac{\partial v_x}{\partial x}+\lambda\frac{\partial v_z}{\partial z}
\]</div>
<div class="math notranslate nohighlight" id="equation-ch09-eq30">
<span class="eqno">(9.28)<a class="headerlink" href="#equation-ch09-eq30" title="Permalink to this equation">#</a></span>\[
\frac{\partial\sigma_{zz}}{\partial t}=\left(\lambda+2G\right)\frac{\partial v_z}{\partial z}+\lambda\frac{\partial v_x}{\partial x}
\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq31">
<span class="eqno">(9.29)<a class="headerlink" href="#equation-ch09-eq31" title="Permalink to this equation">#</a></span>\[
\frac{\partial\sigma_{xz}}{\partial t}=G\left(\frac{\partial v_x}{\partial z}+\frac{\partial v_z}{\partial x}\right)
\]</div>
<p>where <span class="math notranslate nohighlight">\(v_x, \; v_z\)</span> are the particle velocities, and <span class="math notranslate nohighlight">\(b\)</span> is the buoyancy, the inverse of the density. Virieux (1986) solved Eqs. <a class="reference internal" href="#equation-ch09-eq27">(9.25)</a> to <a class="reference internal" href="#equation-ch09-eq31">(9.29)</a> using a finite-difference method and staggered grids. He also gave the numerical stability conditions of his scheme for different media.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The finite difference method is a numerical method for solving differential equations as differences between points in a grid of regular cells. Staggered grids are superimposed grids that are slightly shifted in location. In our case, the stress and velocity grids are slightly shifted.</p>
</div>
<p>The program <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/functions/CGeo_elastic.py">CGeo<span class="math notranslate nohighlight">\(\_\)</span>elastic</a> simulates the propagation of waves in elastic media. This code is implemented using Python classes, which are objects that can have both functions and data elements. There are four classes in the program: <code class="docutils literal notranslate"><span class="pre">Source</span></code> which implements the wave source, <code class="docutils literal notranslate"><span class="pre">Derivatives</span></code> which implements the finite differences that solve the derivatives, <code class="docutils literal notranslate"><span class="pre">Elastic</span></code><span class="math notranslate nohighlight">\(\_\)</span><code class="docutils literal notranslate"><span class="pre">model</span></code> which implements and plots the elastic model, and <code class="docutils literal notranslate"><span class="pre">Elastic</span></code><span class="math notranslate nohighlight">\(\_\)</span><code class="docutils literal notranslate"><span class="pre">waves</span></code> which simulates the elastic waves by solving Eqs. <a class="reference internal" href="#equation-ch09-eq27">(9.25)</a> to <a class="reference internal" href="#equation-ch09-eq31">(9.29)</a>.</p>
<p>The notebook <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/notebooks/ch9-4.ipynb">ch9-4</a> illustrates the use of the <code class="docutils literal notranslate"><span class="pre">CGeo</span></code><span class="math notranslate nohighlight">\(\_\)</span><code class="docutils literal notranslate"><span class="pre">elastic</span></code> program. We first import the necessary libraries and classes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">clear_output</span>

<span class="c1"># Import CGeo_elastic classes</span>
<span class="kn">import</span> <span class="nn">compgeo.CGeo_elastic</span> <span class="k">as</span> <span class="nn">ela</span>
</pre></div>
</div>
</div>
</div>
<p>We consider a region consisting of two materials with different seismic velocities but homogeneous densities separated by a 90corner. <span class="math notranslate nohighlight">\(V_p\)</span> is 6000 m/s in the overburden and 9000 m/s inside the corner. The density, <span class="math notranslate nohighlight">\(\rho\)</span>, is 2500 kg/m<span class="math notranslate nohighlight">\(^3\)</span>. The S-wave velocities are computed using the equations <span class="math notranslate nohighlight">\(V_p = \sqrt{\frac{\lambda + 2G}{\rho}}\)</span> and <span class="math notranslate nohighlight">\(V_s = \sqrt{\frac{G}{\rho}}\)</span> (Sheriff and Geldart, 1995), and assuming <span class="math notranslate nohighlight">\(\lambda = G\)</span>, which corresponds to a Poisson ratio <span class="math notranslate nohighlight">\(\nu = 0.25\)</span>. The model is discretized using 100 m grid spacing in the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(z\)</span> directions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Model size in grid cells</span>
<span class="n">nz</span> <span class="o">=</span> <span class="mi">249</span>
<span class="n">nx</span> <span class="o">=</span> <span class="mi">381</span>
<span class="n">dz</span> <span class="o">=</span> <span class="mi">100</span> 
<span class="n">dx</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Corner edge model with Poisson ratio = 0.25</span>
<span class="n">vpdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">nz</span><span class="p">,</span><span class="n">nx</span><span class="p">])</span><span class="o">*</span><span class="mi">6000</span>
<span class="n">vpdata</span><span class="p">[</span><span class="mi">89</span><span class="p">:,</span> <span class="mi">131</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">9000</span>
<span class="n">rhodata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">nz</span><span class="p">,</span><span class="n">nx</span><span class="p">])</span><span class="o">*</span><span class="mi">2500</span>
<span class="n">lam</span> <span class="o">=</span> <span class="n">rhodata</span><span class="o">*</span><span class="p">(</span><span class="n">vpdata</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mf">3.</span> 
<span class="n">G</span> <span class="o">=</span> <span class="n">lam</span> 
<span class="n">vsdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">G</span><span class="o">/</span><span class="n">rhodata</span><span class="p">)</span>

<span class="c1"># Initialize 2D elastic model class and plot model</span>
<span class="n">Model</span> <span class="o">=</span> <span class="n">ela</span><span class="o">.</span><span class="n">Elastic_model</span><span class="p">(</span><span class="n">vpdata</span><span class="p">,</span> <span class="n">vsdata</span><span class="p">,</span> 
                          <span class="n">rhodata</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dz</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> 
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">Model</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ch09_elasticity_86_0.png" src="_images/ch09_elasticity_86_0.png" />
</div>
</div>
<p>The source wavelet consists of a Ricker wavelet with a dominant frequency of <span class="math notranslate nohighlight">\(\sqrt{\frac{40}{\pi^2}} \approx 2\)</span> Hz. The time discretization and the number of time samples are <span class="math notranslate nohighlight">\(\Delta t = 0.005\)</span>, and <span class="math notranslate nohighlight">\(nt = 1201\)</span>, respectively. This gives a total modelling time of 6 seconds. The source is modelled as punctual explosion whose location is <span class="math notranslate nohighlight">\(x = 15000\)</span> m and <span class="math notranslate nohighlight">\(z=5800\)</span> m. Furthermore, seismic data is recorded right below the free surface at the top of the model:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sampling and modeling length (6 seconds = (nt-1)*dt)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">5e-3</span>
<span class="n">nt</span> <span class="o">=</span> <span class="mi">1201</span>

<span class="n">f0</span><span class="o">=</span><span class="p">(</span><span class="mi">40</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mf">.5</span>  <span class="c1"># Dominant frequency</span>
<span class="n">t0</span><span class="o">=</span><span class="mf">0.6</span> <span class="c1"># Time delay</span>

<span class="c1"># Source position in grid points</span>
<span class="n">sx</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">sz</span> <span class="o">=</span> <span class="mi">58</span>

<span class="c1"># Receiver depth in grid points for the recordings</span>
<span class="n">rz</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">Source</span> <span class="o">=</span> <span class="n">ela</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="n">nt</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sz</span><span class="p">)</span> <span class="c1"># Source class</span>
<span class="n">Source</span><span class="o">.</span><span class="n">Ricker</span><span class="p">(</span><span class="n">f0</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># Initializing a source wavelet</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">Source</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ch09_elasticity_88_0.png" src="_images/ch09_elasticity_88_0.png" />
</div>
</div>
<p>We then setup the finite difference scheme:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize the classes to solve the Elastodynamic equations</span>
<span class="n">Waves</span> <span class="o">=</span> <span class="n">ela</span><span class="o">.</span><span class="n">Elastic_waves</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span><span class="n">nt</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span> 
<span class="n">Derivative</span> <span class="o">=</span> <span class="n">ela</span><span class="o">.</span><span class="n">Derivatives</span><span class="p">()</span>

<span class="c1"># Create containers for snapshots </span>
<span class="c1"># These require lots of memory</span>
<span class="n">P_snaps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">nz</span><span class="p">,</span><span class="n">nx</span><span class="p">,</span><span class="n">nt</span><span class="p">])</span> <span class="c1"># pressure</span>
<span class="n">Vx_snaps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">nz</span><span class="p">,</span><span class="n">nx</span><span class="p">,</span><span class="n">nt</span><span class="p">])</span> <span class="c1"># vx</span>
<span class="n">Vz_snaps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">nz</span><span class="p">,</span><span class="n">nx</span><span class="p">,</span><span class="n">nt</span><span class="p">])</span> <span class="c1"># vz</span>

<span class="c1"># Create containers for seismograms</span>
<span class="c1"># just below the free surface</span>
<span class="n">P_record</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">nt</span><span class="p">,</span><span class="n">nx</span><span class="p">])</span> <span class="c1"># pressure</span>
<span class="n">Vx_record</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">nt</span><span class="p">,</span><span class="n">nx</span><span class="p">])</span> <span class="c1"># vx </span>
<span class="n">Vz_record</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">nt</span><span class="p">,</span><span class="n">nx</span><span class="p">])</span> <span class="c1"># vz</span>

<span class="c1"># Check stability of FD modeling scheme</span>
<span class="n">dtstab</span> <span class="o">=</span> <span class="n">Waves</span><span class="o">.</span><span class="n">Courant_stability</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Model</span><span class="o">.</span><span class="n">vp</span><span class="p">))</span>
<span class="k">if</span><span class="p">(</span><span class="n">dt</span> <span class="o">&gt;</span> <span class="n">dtstab</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The value of dt should not exceed&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;the stability limit of:&quot;</span><span class="p">,</span> 
                    <span class="n">dtstab</span><span class="p">,</span> <span class="s2">&quot;The value of dt was:&quot;</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, the elastodynamic waves are solved using an explicit leap frog method where the wavefields at the next time step are solved from the wavefields at the previous time step. You will be presented with a progress indicator, please wait for the program to finish:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Loop over time</span>
<span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nt</span><span class="p">):</span>
    <span class="c1"># Extrapolate waves one time step</span>
    <span class="n">Waves</span><span class="o">.</span><span class="n">forwardStep</span><span class="p">(</span><span class="n">Derivative</span><span class="p">,</span> <span class="n">Model</span><span class="p">)</span>
    
    <span class="c1"># Adding pressure source </span>
    <span class="n">Waves</span><span class="o">.</span><span class="n">insertPressure</span><span class="p">(</span><span class="n">Source</span><span class="p">,</span> <span class="n">it</span><span class="p">)</span>

    <span class="c1"># Adding force source(s)</span>
    <span class="c1"># Clockwise angle gives force direction (180 is down)</span>
    <span class="c1">#angle = 180 </span>
    <span class="c1">#Waves.insertForce(Source, Model, angle, it)    </span>
    
    <span class="c1"># Recording a seismogram </span>
    <span class="n">P_record</span><span class="p">[</span><span class="n">it</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Waves</span><span class="o">.</span><span class="n">recordPressure</span><span class="p">(</span><span class="n">rz</span><span class="p">)</span>
    <span class="n">Vx_record</span><span class="p">[</span><span class="n">it</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Waves</span><span class="o">.</span><span class="n">recordVelocity</span><span class="p">(</span><span class="n">rz</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">Vz_record</span><span class="p">[</span><span class="n">it</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Waves</span><span class="o">.</span><span class="n">recordVelocity</span><span class="p">(</span><span class="n">rz</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">)</span>
    
    <span class="c1"># Record snapshots</span>
    <span class="n">Vx_snaps</span><span class="p">[:,:,</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">Waves</span><span class="o">.</span><span class="n">Vx</span> 
    <span class="n">Vz_snaps</span><span class="p">[:,:,</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">Waves</span><span class="o">.</span><span class="n">Vz</span> 
    <span class="n">P_snaps</span><span class="p">[:,:,</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">Waves</span><span class="o">.</span><span class="n">Sxx</span> <span class="o">+</span> <span class="n">Waves</span><span class="o">.</span><span class="n">Szz</span><span class="p">)</span> 
            
    <span class="k">if</span><span class="p">(</span><span class="n">it</span> <span class="o">%</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">nt</span><span class="o">/</span><span class="mi">20</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Progress:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">it</span><span class="o">/</span><span class="p">(</span><span class="n">nt</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span> <span class="s1">&#39;%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Progress: 100.0 %
</pre></div>
</div>
</div>
</div>
<p>The results can be displayed in the form of numerical seismograms recorded just below the free surface. The left column corresponds to the <span class="math notranslate nohighlight">\(x\)</span>-component of the particle velocities (<span class="math notranslate nohighlight">\(v_x\)</span>), the middle column corresponds to the <span class="math notranslate nohighlight">\(z\)</span>-component of the particle velocities (<span class="math notranslate nohighlight">\(v_z\)</span>), and the right column corresponds to pressure (<span class="math notranslate nohighlight">\(\frac{\sigma_{xx} + \sigma_{zz}}{2}\)</span>). Both compressional and shear waves can be seen on the left and middle columns, whereas only compressional waves are visible on the right column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<span class="n">extents</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">nx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span> <span class="p">(</span><span class="n">nt</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># Vx</span>
<span class="n">vlim</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Vx_record</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Vx_record</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">vlim</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=-</span><span class="n">vlim</span><span class="p">,</span> 
             <span class="n">extent</span><span class="o">=</span><span class="n">extents</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Position (m)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Vx&quot;</span><span class="p">)</span>

<span class="c1"># Vz</span>
<span class="n">vlim</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Vz_record</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Vz_record</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">vlim</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=-</span><span class="n">vlim</span><span class="p">,</span> 
             <span class="n">extent</span><span class="o">=</span><span class="n">extents</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Position (m)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Vz&quot;</span><span class="p">)</span>

<span class="c1"># Pressure</span>
<span class="n">vlim</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">P_record</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">P_record</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">vlim</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=-</span><span class="n">vlim</span><span class="p">,</span> 
             <span class="n">extent</span><span class="o">=</span><span class="n">extents</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Position (m)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Pressure&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ch09_elasticity_94_0.png" src="_images/ch09_elasticity_94_0.png" />
</div>
</div>
<p>The results can also be shown as snapshots of the wave propagation at selected times. Again, the left column is <span class="math notranslate nohighlight">\(v_x\)</span>, the middle column is <span class="math notranslate nohighlight">\(v_z\)</span>, and the right column is pressure. Each row is a snapshot and time increases downwards. Compressional and shear waves are observed on the left and middle columns, whereas only compressional waves are visible on the right column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                       <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
<span class="n">extents</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">nx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span> <span class="p">(</span><span class="n">nz</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dz</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">snapit</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mf">0.995</span><span class="o">/</span><span class="n">dt</span><span class="p">))</span> <span class="c1"># initial time</span>
<span class="n">delta_snap</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mf">0.5</span><span class="o">/</span><span class="n">dt</span><span class="p">))</span> <span class="c1"># delta time</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span> <span class="c1"># 4 snaps</span>
    
    <span class="c1"># Vx</span>
    <span class="n">vlim</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Vx_snaps</span><span class="p">[:,:,</span><span class="n">snapit</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Vx_snaps</span><span class="p">[:,:,</span><span class="n">snapit</span><span class="p">],</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vlim</span><span class="p">,</span> 
                   <span class="n">vmax</span><span class="o">=-</span><span class="n">vlim</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extents</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Depth (m)&quot;</span><span class="p">)</span>
    
    <span class="c1"># Vz</span>
    <span class="n">vlim</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Vz_snaps</span><span class="p">[:,:,</span><span class="n">snapit</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Vz_snaps</span><span class="p">[:,:,</span><span class="n">snapit</span><span class="p">],</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vlim</span><span class="p">,</span> 
                   <span class="n">vmax</span><span class="o">=-</span><span class="n">vlim</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extents</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Vz, &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">((</span><span class="n">snapit</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; s&quot;</span><span class="p">)</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="nb">str</span><span class="p">((</span><span class="n">snapit</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; s&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    
    <span class="c1"># Pressure</span>
    <span class="n">vlim</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">P_snaps</span><span class="p">[:,:,</span><span class="n">snapit</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">P_snaps</span><span class="p">[:,:,</span><span class="n">snapit</span><span class="p">],</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vlim</span><span class="p">,</span> 
                   <span class="n">vmax</span><span class="o">=-</span><span class="n">vlim</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extents</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">snapit</span> <span class="o">=</span> <span class="n">snapit</span><span class="o">+</span><span class="n">delta_snap</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Vx&quot;</span><span class="p">);</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Pressure&quot;</span><span class="p">);</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Position (m)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Position (m)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Position (m)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ch09_elasticity_96_0.png" src="_images/ch09_elasticity_96_0.png" />
</div>
</div>
</section>
</section>
<section id="exercises">
<span id="ch09-3"></span><h2><span class="section-number">9.3. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">#</a></h2>
<ol>
<li><p>The tangential stress, <span class="math notranslate nohighlight">\(\sigma_{\eta\eta}\)</span>, at the surface of an elliptical hole under far field principal stresses, <span class="math notranslate nohighlight">\(\sigma_1\)</span> and <span class="math notranslate nohighlight">\(\sigma_3\)</span>, is given by (Jaeger et al., 2007):</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq32">
<span class="eqno">(9.30)<a class="headerlink" href="#equation-ch09-eq32" title="Permalink to this equation">#</a></span>\[
    \sigma_{\eta \eta}=\frac{2 a b\left(\sigma_{1}+\sigma_{3}\right)+\left(\sigma_{1}-\sigma_{3}\right)\left[\left(a^{2}-b^{2}\right) \cos 2 \beta-(a+b)^{2} \cos 2(\beta-\eta)\right]}{\left(a^{2}+b^{2}\right)-\left(a^{2}-b^{2}\right) \cos 2 \eta}
    \]</div>
<p>where <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are the major and minor axes of the hole, <span class="math notranslate nohighlight">\(\beta\)</span>  is the angle <span class="math notranslate nohighlight">\(\sigma_1\)</span> makes with the major axis of the hole (<a class="reference internal" href="#ch09-fig07"><span class="std std-numref">Figure 9.7</span></a>), and <span class="math notranslate nohighlight">\(\eta\)</span> is given by:</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq33">
<span class="eqno">(9.31)<a class="headerlink" href="#equation-ch09-eq33" title="Permalink to this equation">#</a></span>\[
    \tan\eta=\left(\frac{a}{b}\right)\tan\theta
    \]</div>
<p>where <span class="math notranslate nohighlight">\(\theta\)</span> is the angle a vector connecting the center of the hole and the point of observation makes with the long axis of the hole (<a class="reference internal" href="#ch09-fig07"><span class="std std-numref">Figure 9.7</span></a>).</p>
</li>
</ol>
<figure class="align-default" id="ch09-fig07">
<a class="reference internal image-reference" href="_images/ch09_fig07.png"><img alt="_images/ch09_fig07.png" src="_images/ch09_fig07.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 9.7 </span><span class="caption-text">Elliptical hole under far field stresses. Symbols are explained in the text.</span><a class="headerlink" href="#ch09-fig07" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Write a function that plots the tangential stress as function of $\theta$, on the surface of an elliptical hole under far field stresses, $\sigma_1$ and $\sigma_3$. Check your function with the three cases in Figure 8.6 of Jaeger et al. (2007).

:::{hint}
Start with function `hoop`, and modify the `geom` and `stress` entries to fit this new problem. You will need to implement Eq. {eq}`ch09_eq32` for the tangential stress. You can use values of $\theta$ from 0 to 180 and 1increment.
:::
</pre></div>
</div>
<ol>
<li><p>The elastic lithosphere of the Earth can be broken by major structures, such as fault systems bounding terrain boundaries. In this case, a broken plate model is more appropriate than the continuous plate model. The implementation of the broken plate model with a free end at <span class="math notranslate nohighlight">\(x=0\)</span>, and for a rectangular load is explained in Hetenyi (1946). First, we introduce the following terms:</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq34">
<span class="eqno">(9.32)<a class="headerlink" href="#equation-ch09-eq34" title="Permalink to this equation">#</a></span>\[\begin{split}
    \begin{gathered}
        A_{(\alpha,x)} = \exp(-x/\alpha)(\cos(x/\alpha) + \sin(x/\alpha)) \\ B_{(\alpha,x)} = \exp(-x/\alpha)\sin(x/\alpha) \\ 
        C_{(\alpha,x)} = \exp(-x/\alpha)(\cos(x/\alpha) - \sin(x/\alpha))
    \end{gathered}
    \end{split}\]</div>
<p>and then these terms:</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq35">
<span class="eqno">(9.33)<a class="headerlink" href="#equation-ch09-eq35" title="Permalink to this equation">#</a></span>\[\begin{split}
    \begin{gathered}
        aa = 2(B_{(\alpha,b')} - B_{(\alpha,a')}) + (C_{(\alpha,a')} - C_{(\alpha,b')}) \\ 
        bb = (B_{(\alpha,b')} - B_{(\alpha,a')}) + (C_{(\alpha,a')} - C_{(\alpha,b')})
    \end{gathered}
    \end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(a'\)</span> and <span class="math notranslate nohighlight">\(b'\)</span> are the distances from the free end of the plate, <span class="math notranslate nohighlight">\(x=0\)</span>, to the left and right borders of the load, respectively. The deflection <span class="math notranslate nohighlight">\(u\)</span> of any point along the beam (<span class="math notranslate nohighlight">\(x\geq 0\)</span>) is:</p>
<ul class="simple">
<li><p>If the point is under the load:
$<span class="math notranslate nohighlight">\(
  u = \frac{q}{2k}[(2-D_{(\alpha,a)}-D_{(\alpha,b)}) + bbA_{(\alpha,x)} - aaB_{(\alpha,x)}]
  \)</span>$ (ch09_eq36)</p></li>
<li><p>If the point is to the left of the load:
$<span class="math notranslate nohighlight">\(
  u = \frac{q}{2k}[(D_{(\alpha,a)}-D_{(\alpha,b)}) + bbA_{(\alpha,x)} - aaB_{(\alpha,x)}
  \)</span>$ (ch09_eq37)</p></li>
<li><p>If the point is to the right of the load:
$<span class="math notranslate nohighlight">\(
  u = \frac{q}{2k}[(D_{(\alpha,b)}-D_{(\alpha,a)}) + bbA_{(\alpha,x)} - aaB_{(\alpha,x)}
  \)</span>$ (ch09_eq38)</p></li>
</ul>
<p>where <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are the absolute distances from the point to the left and right borders of the load (<a class="reference internal" href="#ch09-fig05"><span class="std std-numref">Figure 9.5</span></a>c), and <span class="math notranslate nohighlight">\(D_{(\alpha,x)}\)</span> is defined in Eq. <a class="reference internal" href="#equation-ch09-eq12">(9.12)</a>.</p>
<p>Write a function that computes the deflection of a broken elastic lithosphere under a distribution of load columns. Check this function with the loads in <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/data/ch9-2/loads.txt">loads.txt</a>.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Modify function <code class="docutils literal notranslate"><span class="pre">flex2d</span></code> for the broken plate model. You will need to implement the new terms (Eqs. <a class="reference internal" href="#equation-ch09-eq34">(9.32)</a> and <a class="reference internal" href="#equation-ch09-eq35">(9.33)</a>), and modify the deflection according to Eqs. <code class="xref eq docutils literal notranslate"><span class="pre">ch09_eq36</span></code> to <code class="xref eq docutils literal notranslate"><span class="pre">ch09_eq38</span></code>.</p>
</div>
</li>
<li><p>The stress changes caused by an edge dislocation in an elastic half space in two dimensions are (Segall, 2010):</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq39">
<span class="eqno">(9.34)<a class="headerlink" href="#equation-ch09-eq39" title="Permalink to this equation">#</a></span>\[\begin{split}
    %\resizebox{1.05\hsize}{!}
    {\begin{aligned}
        \sigma_{11}=\frac{G s_{2}}{2 \pi(1-\nu)} &amp;\left\{\frac{x_{1}\left[\left(x_{2}-\xi_{2}\right)^{2}-x_{1}^{2}\right]}{r_{1}^{4}}-\frac{x_{1}\left[\left(x_{2}+\xi_{2}\right)^{2}-x_{1}^{2}\right]}{r_{2}^{4}}\right.\\
        +&amp;\left.\frac{4 \xi_{2} x_{1}}{r_{2}^{6}}\left[\left(2 \xi_{2}-x_{2}\right)\left(x_{2}+\xi_{2}\right)^{2}+\left(3 x_{2}+2 \xi_{2}\right) x_{1}^{2}\right]\right\} \\
        &amp;+\frac{G s_{1}}{2 \pi(1-\nu)}\left\{\frac{\left(x_{2}-\xi_{2}\right)\left[\left(x_{2}-\xi_{2}\right)^{2}+3 x_{1}^{2}\right]}{r_{1}^{4}}-\frac{\left(x_{2}+\xi_{2}\right)\left[\left(x_{2}+\xi_{2}\right)^{2}+3 x_{1}^{2}\right]}{r_{2}^{4}}\right.\\
        &amp;\left.+\frac{2 \xi_{2}}{r_{2}^{6}}\left[6 x_{2}\left(x_{2}+\xi_{2}\right) x_{1}^{2}-\left(x_{2}-\xi_{2}\right)\left(x_{2}+\xi_{2}\right)^{3}-x_{1}^{4}\right]\right\} \\ \\
        \sigma_{22}=\frac{-G s_{2}}{2 \pi(1-\nu)} &amp;\left\{\frac{x_{1}\left[3\left(x_{2}-\xi_{2}\right)^{2}+x_{1}^{2}\right]}{r_{1}^{4}}-\frac{x_{1}\left[3\left(x_{2}+\xi_{2}\right)^{2}+x_{1}^{2}\right]}{r_{2}^{4}}-\frac{4 \xi_{2} x_{2} x_{1}}{r_{2}^{6}}\left[3\left(x_{2}+\xi_{2}\right)^{2}-x_{1}^{2}\right]\right\} \\
        &amp;+\frac{G s_{1}}{2 \pi(1-\nu)}\left\{\frac{\left(x_{2}-\xi_{2}\right)\left[\left(x_{2}-\xi_{2}\right)^{2}-x_{1}^{2}\right]}{r_{1}^{4}}-\frac{\left(x_{2}+\xi_{2}\right)\left[\left(x_{2}+\xi_{2}\right)^{2}-x_{1}^{2}\right]}{r_{2}^{4}}\right.\\
        -&amp;\left.\frac{2 \xi_{2}}{r_{2}^{6}}\left[6 x_{2}\left(x_{2}+\xi_{2}\right) x_{1}^{2}-\left(3 x_{2}+\xi_{2}\right)\left(x_{2}+\xi_{2}\right)^{3}+x_{1}^{4}\right]\right\} \\ \\
        \sigma_{12}=\frac{G s_{2}}{2 \pi(1-\nu)} &amp;\left\{\frac{\left(x_{2}-\xi_{2}\right)\left[\left(x_{2}-\xi_{2}\right)^{2}-x_{1}^{2}\right]}{r_{1}^{4}}-\frac{\left(x_{2}+\xi_{2}\right)\left[\left(x_{2}+\xi_{2}\right)^{2}-x_{1}^{2}\right]}{r_{2}^{4}}\right.\\
        +&amp;\left.\frac{2 \xi_{2}}{r_{2}^{6}}\left[6 x_{2}\left(x_{2}+\xi_{2}\right) x_{1}^{2}-x_{1}^{4}+\left(\xi_{2}-x_{2}\right)\left(x_{2}+\xi_{2}\right)^{3}\right]\right\} \\
        &amp;+\frac{G s_{1}}{2 \pi(1-\nu)}\left\{\frac{x_{1}\left[\left(x_{2}-\xi_{2}\right)^{2}-x_{1}^{2}\right]}{r_{1}^{4}}-\frac{x_{1}\left[\left(x_{2}+\xi_{2}\right)^{2}-x_{1}^{2}\right]}{r_{2}^{4}}\right.\\
        &amp;\left.+\frac{4 \xi_{2} x_{2} x_{1}}{r_{2}^{6}}\left[3\left(x_{2}+\xi_{2}\right)^{2}-x_{1}^{2}\right]\right\}
    \end{aligned}\\$}
    \end{split}\]</div>
<p>All symbols are like in <a class="reference internal" href="#ch09-2-3"><span class="std std-ref">Section 9.2.3</span></a>. Note that, unlike displacements (Eq. <a class="reference internal" href="#equation-ch09-eq17">(9.15)</a>), stresses do not depend on the angles about the dislocation and its image (<span class="math notranslate nohighlight">\(\theta_1\)</span> and <span class="math notranslate nohighlight">\(\theta_2\)</span>) but do depend on the shear modulus (<span class="math notranslate nohighlight">\(G\)</span>).</p>
<ul>
<li><p>Write a function that calculates the stresses at observation points due to an edge dislocation. Hint: Add to the <code class="docutils literal notranslate"><span class="pre">disloc2d.py</span></code> module a function to calculate stress. Call this stress function from function <code class="docutils literal notranslate"><span class="pre">disloc2d</span></code></p></li>
<li><p>Calculate stresses for the same fault geometry and grid of observation points that you used to plot vectors of fault displacement in notebook <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/notebooks/ch9-3.ipynb">ch9-3</a>. Use 10 GPa for the shear modulus and 2 m of reverse-sense slip. Make plots of each of the three stress components: <span class="math notranslate nohighlight">\(\sigma_{11}\)</span>, <span class="math notranslate nohighlight">\(\sigma_{12}\)</span>, and <span class="math notranslate nohighlight">\(\sigma_{22}\)</span>. There are multiple ways you could make this plot. A simple way would be to use Pyplot <code class="docutils literal notranslate"><span class="pre">scatter</span></code> function with stress as the <code class="docutils literal notranslate"><span class="pre">c</span></code> (color) argument. A more advanced, but nicer looking way, would be to use <code class="docutils literal notranslate"><span class="pre">imshow</span></code>.</p></li>
<li><p>Calculate the three strain components <span class="math notranslate nohighlight">\(\varepsilon_{11}\)</span>, <span class="math notranslate nohighlight">\(\varepsilon_{12}\)</span>, and <span class="math notranslate nohighlight">\(\varepsilon_{22}\)</span>, and make plots of each. Eqs <a class="reference internal" href="#equation-ch09-eq17">(9.15)</a> and <a class="reference internal" href="#equation-ch09-eq39">(9.34)</a> are defined for a state of plane strain, in which <span class="math notranslate nohighlight">\(\varepsilon_{33}\)</span> = 0 but <span class="math notranslate nohighlight">\(\sigma_{33} \neq 0\)</span>. Solving Eq. <a class="reference internal" href="#equation-ch09-eq01">(9.1)</a> with <span class="math notranslate nohighlight">\(\varepsilon_{33} = 0\)</span> and writing the result in terms of <span class="math notranslate nohighlight">\(G\)</span> and <span class="math notranslate nohighlight">\(\nu\)</span> gives the following equations for plane strain:</p>
<div class="math notranslate nohighlight" id="equation-ch09-eq40">
<span class="eqno">(9.35)<a class="headerlink" href="#equation-ch09-eq40" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{gathered}
            \varepsilon_{11}=\frac{1}{2 G}\left[(1-\nu) \sigma_{11}-\nu \sigma_{22}\right] \\ 
            \varepsilon_{22}=\frac{1}{2 G}\left[(1-\nu) \sigma_{22}-\nu \sigma_{11}\right] \\
            \varepsilon_{12}=\frac{1}{2 G} \sigma_{12}
        \end{gathered}
        \end{split}\]</div>
</li>
<li><p>Change the sense of slip to normal and repeat the stress and  strain calculations. Compare the results to those from the reverse slip case.</p></li>
</ul>
</li>
<li><p>The example in notebook <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/notebooks/ch9-4.ipynb">ch9-4</a> considers elastic wave propagation in a region consisting of two materials with different seismic velocities but homogeneous densities.</p>
<ul class="simple">
<li><p>Change the elastic model, such that the seismic velocities are homogeneous, but the density is heterogeneous and larger inside the 90 corner.</p></li>
<li><p>Change the source from a punctual explosion to a downward force source.</p></li>
<li><p>Change the source to a lateral force source.</p></li>
</ul>
</li>
</ol>
</section>
<section id="references">
<span id="ch09-4"></span><h2><span class="section-number">9.4. </span>References<a class="headerlink" href="#references" title="Permalink to this headline">#</a></h2>
<p>Allmendinger, R.W. 2020. Modern Structural Practice: A structural
geology laboratory manual for the 21st century.
[<a class="reference external" href="https://www.rickallmendinger.net/download">Online</a>]. [Accessed
March, 2021].</p>
<p>Fossen, H. 2016. Structural Geology. Cambridge University Press.</p>
<p>Gudmunsson, A. 2011. Rock fractures in geological processes. Cambridge
University Press.</p>
<p>Hetenyi, M. 1946. Beams on Elastic Foundations. Theory with Applications
in the Fields of Civil and Mechanical Engineering. The University of
Michigan Press.</p>
<p>Hoek, E. 2006. Practical Rock Engineering. Available from this
<a class="reference external" href="https://www.rocscience.com/assets/resources/learning/hoek/Practical-Rock-Engineering-Full-Text.pdf">link</a>.</p>
<p>Jaeger, J.C., Cook, N.G.W. and Zimmerman, R.W. 2007. Fundamentals of
Rock Mechanics, fourth edition. Blackwell Publishing.</p>
<p>Pollard, D.D. and Fletcher, R.C. 2005. Fundamentals of Structural
Geology. Cambridge University Press.</p>
<p>Ragan, D.M. 2009. Structural Geology: An Introduction to Geometrical
Techniques. Cambridge University Press.</p>
<p>Segall, P. 2010. Earthquake and Volcano Deformation. Princeton
University Press.</p>
<p>Sheriff, R. and Geldart, L.P. 1995. Exploration Seismology, second
edition. Cambridge University Press.</p>
<p>Stein, R.S. and Barrientos, S.E. 1985. Planar High-Angle Faulting in the
Basin and Range: Geodetic Analysis of the 1983 Borah Peak, Idaho,
Earthquake. Journal of Geophysical Research 90, 11,355-11,366.</p>
<p>Turcotte, D.L. and Schubert, G. 1982. Geodynamics. Jon Wiley <span class="math notranslate nohighlight">\(\&amp;\)</span> Sons.</p>
<p>Van Der Pluijm, B.A. and Marshak, S. 2004. Earth Structure, second
edition. Norton.</p>
<p>Virieux, J. 1986. P-SV wave propagation in heterogeneous media:
Velocity-stress finite-difference method. Geophysics 51, 889-901.</p>
<p>Watts, A.B. 2001. Isostasy and Flexure of the Lithosphere. Cambridge
University Press.</p>
<p>Zoback, M.D. 2010. Reservoir Geomechanics. Cambridge University Press.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="ch08_strain.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">8. </span>Strain</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="notebooks/ch01/ch01_nb01.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Introduction to Python and Jupyter Notebooks</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Nestor Cardozo & Alex F. Antunes<br/>
  
      &copy; Copyright 2023.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>