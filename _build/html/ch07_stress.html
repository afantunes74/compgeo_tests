
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>7. Stress &#8212; Computational Geosciences</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="8. Strain" href="ch08_strain.html" />
    <link rel="prev" title="6. Tensors" href="ch06_tensors.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Computational Geosciences</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to the Computational Geosciences resource
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  GET STARTED
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="preface.html">
   Preface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="changelog.html">
   Changelog
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="todo.html">
   TODOs
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  CONTENTS
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="ch01_computation_geosciences.html">
   1. Computation in Geosciences
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch02_understanding_location.html">
   2. Understanding location
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch03_geological_features.html">
   3. Geological features
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch04_coordinate_systems_vectors.html">
   4. Coordinate systems and vectors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch05_transformations.html">
   5. Transformations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch06_tensors.html">
   6. Tensors
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   7. Stress
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch08_strain.html">
   8. Strain
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch09_elasticity.html">
   9. Elasticity
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  THE COMPANION NOTEBOOKS
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/ch01/ch01_nb01.html">
   Introduction to Python and Jupyter Notebooks
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=lab/tree/docs/ch07_stress.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fch07_stress.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/ch07_stress.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-stress-tensor">
   7.1. The stress tensor
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cauchys-law">
     7.1.1. Cauchy’s law
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stress-transformation">
     7.1.2. Stress transformation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#principal-axes-of-stress">
     7.1.3. Principal axes of stress
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mohr-circle-for-stress">
   7.2. Mohr circle for stress
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#special-states-of-stress">
     7.2.1. Special states of stress
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mean-and-deviatoric-stress">
   7.3. Mean and deviatoric stress
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#applications">
   7.4. Applications
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#normal-and-shear-tractions-on-a-plane">
     7.4.1. Normal and shear tractions on a plane
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-mohr-circle-for-stress-in-3d">
     7.4.2. The Mohr circle for stress in 3D
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   7.5. Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   7.6. References
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Stress</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-stress-tensor">
   7.1. The stress tensor
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cauchys-law">
     7.1.1. Cauchy’s law
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stress-transformation">
     7.1.2. Stress transformation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#principal-axes-of-stress">
     7.1.3. Principal axes of stress
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mohr-circle-for-stress">
   7.2. Mohr circle for stress
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#special-states-of-stress">
     7.2.1. Special states of stress
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mean-and-deviatoric-stress">
   7.3. Mean and deviatoric stress
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#applications">
   7.4. Applications
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#normal-and-shear-tractions-on-a-plane">
     7.4.1. Normal and shear tractions on a plane
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-mohr-circle-for-stress-in-3d">
     7.4.2. The Mohr circle for stress in 3D
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   7.5. Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   7.6. References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="stress">
<span id="ch07"></span><h1><span class="section-number">7. </span>Stress<a class="headerlink" href="#stress" title="Permalink to this headline">#</a></h1>
<p>Geoscientists and engineers are familiar with the concept of stress (other people too). Stress describes the forces per unit area, i.e. the tractions, acting on imaginary planes of varied orientations inside a body. These tractions and the stress occur at a particular instant of time.</p>
<section id="the-stress-tensor">
<span id="ch07-1"></span><h2><span class="section-number">7.1. </span>The stress tensor<a class="headerlink" href="#the-stress-tensor" title="Permalink to this headline">#</a></h2>
<p>A traction is defined as a force, <strong>f</strong>, divided by the area of the plane, A, on which it acts:</p>
<div class="math notranslate nohighlight" id="equation-ch07-eq01">
<span class="eqno">(7.1)<a class="headerlink" href="#equation-ch07-eq01" title="Permalink to this equation">#</a></span>\[
\mathbf{t}=\frac{\mathbf{f}}{A}
\]</div>
<p>A force of one Newton acting on one square meter is one Pascal (1 N/ m<sup>2</sup> = 1 Pa). A Pascal is very small, the atmospheric pressure is about <span class="math notranslate nohighlight">\(10^5\)</span> Pa. Therefore, we use a more convenient unit called Megapascal (1 MPa = <span class="math notranslate nohighlight">\(10^6\)</span> Pa).</p>
<p>In the subsurface, the vertical traction due to the weight of the overburden (<span class="math notranslate nohighlight">\(\sigma_v\)</span>) is equal to:</p>
<div class="math notranslate nohighlight" id="equation-ch07-eq02">
<span class="eqno">(7.2)<a class="headerlink" href="#equation-ch07-eq02" title="Permalink to this equation">#</a></span>\[
\label{eq7.2}
    \sigma_v=\rho g h
\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho\)</span> is the rock density, <span class="math notranslate nohighlight">\(g\)</span> is gravity, and <span class="math notranslate nohighlight">\(h\)</span> is depth. Rock density increases with depth, but assuming an average rock density of 2400 kg/ m<sup>3</sup>, <span class="math notranslate nohighlight">\(\sigma_v\)</span> is about 24 MPa at 1 km depth. 23-25 MPa/km is a reasonable value for the gradient of <span class="math notranslate nohighlight">\(\sigma_v\)</span> with depth.</p>
<p>If we now consider a point in space and a Cartesian coordinate system <span class="math notranslate nohighlight">\(\mathbf{X_1X_2X_3}\)</span> centered at this point (<a class="reference internal" href="#ch07-fig01"><span class="std std-numref">Figure 7.1</span></a>), the components of the stress tensor, <span class="math notranslate nohighlight">\(\boldsymbol{\sigma}\)</span>, are just the tractions on planes that are perpendicular to the axes of the coordinate system:</p>
<div class="math notranslate nohighlight" id="equation-ch07-eq03">
<span class="eqno">(7.3)<a class="headerlink" href="#equation-ch07-eq03" title="Permalink to this equation">#</a></span>\[\begin{split}
\sigma_{ij}=\begin{bmatrix}\sigma_{11}&amp;\sigma_{12}&amp;\sigma_{13}\\\sigma_{21}&amp;\sigma_{22}&amp;\sigma_{23}\\\sigma_{31}&amp;\sigma_{32}&amp;\sigma_{33}\end{bmatrix}
\end{split}\]</div>
<figure class="align-default" id="ch07-fig01">
<a class="reference internal image-reference" href="_images/ch07_fig01.png"><img alt="_images/ch07_fig01.png" src="_images/ch07_fig01.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 7.1 </span><span class="caption-text">The components of the stress tensor are the normal and shear tractions on planes perpendicular to the coordinate axes.</span><a class="headerlink" href="#ch07-fig01" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>For each component, the first index indicates the axis perpendicular to the plane, and the second index the axis to which the traction is parallel (<a class="reference internal" href="#ch07-fig01"><span class="std std-numref">Figure 7.1</span></a>). Tractions with equal indices (e.g. <span class="math notranslate nohighlight">\(\sigma_{11}\)</span>) act perpendicular to the plane and are called normal tractions, while tractions with different indices (e.g. <span class="math notranslate nohighlight">\(\sigma_{12}\)</span>) act parallel to the plane and are called shear tractions. Because normal tractions are predominantly compressive within the Earth (Eq. <a class="reference internal" href="#equation-ch07-eq02">(7.2)</a>), in geology we consider compressive normal tractions as positive and tensional normal tractions as negative. This is opposite to material science, where tensional normal tractions are considered positive.</p>
<p>From <a class="reference internal" href="#ch07-fig01"><span class="std std-numref">Figure 7.1</span></a> it is also clear that if the cube is in equilibrium and it does not rotate about one of the coordinates axis, the stress tensor must be symmetric (<span class="math notranslate nohighlight">\(\sigma_{ij}=\sigma_{ji}\)</span>).</p>
<section id="cauchys-law">
<span id="ch07-1-1"></span><h3><span class="section-number">7.1.1. </span>Cauchy’s law<a class="headerlink" href="#cauchys-law" title="Permalink to this headline">#</a></h3>
<p>The stress tensor relates two vectors, the traction on a plane, <span class="math notranslate nohighlight">\(\mathbf{t}\)</span>, and the pole to the plane, <span class="math notranslate nohighlight">\(\mathbf{p}\)</span> (<a class="reference internal" href="#ch07-fig02"><span class="std std-numref">Figure 7.2</span></a>). This is nicely expressed by Cauchy’s law (for a proof of this law see Allmendinger et al., 2012):</p>
<div class="math notranslate nohighlight" id="equation-ch07-eq04">
<span class="eqno">(7.4)<a class="headerlink" href="#equation-ch07-eq04" title="Permalink to this equation">#</a></span>\[
t_i=\sigma_{ij}p_j
\]</div>
<figure class="align-default" id="ch07-fig02">
<a class="reference internal image-reference" href="_images/ch07_fig02.png"><img alt="_images/ch07_fig02.png" src="_images/ch07_fig02.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 7.2 </span><span class="caption-text">Tractions <span class="math notranslate nohighlight">\(t_{i}\)</span> on a plane oblique to the coordinate axes. <span class="math notranslate nohighlight">\(\textbf{p}\)</span> is the pole to the plane.</span><a class="headerlink" href="#ch07-fig02" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Notice that <span class="math notranslate nohighlight">\(t_i\)</span> are tractions parallel to the axes of the coordinate system and <span class="math notranslate nohighlight">\(\mathbf{p}\)</span> is a unit vector defined by its direction cosines with respect to these axes (<a class="reference internal" href="#ch07-fig02"><span class="std std-numref">Figure 7.2</span></a>).</p>
<p>The function <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/functions/cauchy.py">cauchy</a> calculates the tractions <span class="math notranslate nohighlight">\(t_i\)</span> on a plane of any orientation in any coordinate system. <code class="docutils literal notranslate"><span class="pre">cauchy</span></code> uses function <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/functions/dircos_axes.py">dircos_axes</a> which calculates the direction cosines of the <span class="math notranslate nohighlight">\(\mathbf{X_1X_2X_3}\)</span> axes. To define the orientation of these axes, it is just necessary to give the trend and plunge of <span class="math notranslate nohighlight">\(\mathbf{X_1}\)</span> and the trend of <span class="math notranslate nohighlight">\(\mathbf{X_3}\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">compgeo.dircos_axes</span> <span class="kn">import</span> <span class="n">dircos_axes</span>
<span class="kn">from</span> <span class="nn">compgeo.sph_to_cart</span> <span class="kn">import</span> <span class="n">sph_to_cart</span>
<span class="kn">from</span> <span class="nn">compgeo.pole</span> <span class="kn">import</span> <span class="n">pole_from_plane</span>


<span class="k">def</span> <span class="nf">cauchy</span><span class="p">(</span><span class="n">stress</span><span class="p">,</span><span class="n">tx1</span><span class="p">,</span><span class="n">px1</span><span class="p">,</span><span class="n">tx3</span><span class="p">,</span><span class="n">strike</span><span class="p">,</span><span class="n">dip</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given the stress tensor in a X1X2X3 coordinate system,</span>
<span class="sd">    cauchy computes the X1X2X3 tractions on an arbitrarily</span>
<span class="sd">    oriented plane </span>
<span class="sd">    </span>
<span class="sd">    USE: t,pt = cauchy(stress,tx1,px1,tx3,strike,dip)</span>
<span class="sd">    </span>
<span class="sd">    stress = 3 x 3 stress tensor</span>
<span class="sd">    tx1 = trend of X1</span>
<span class="sd">    px1 = plunge of X1</span>
<span class="sd">    tx3 = trend of X3</span>
<span class="sd">    strike = strike of plane</span>
<span class="sd">    dip = dip of plane</span>
<span class="sd">    t = 1 x 3 vector with X1, X2 and X3 tractions</span>
<span class="sd">    pt = 1 x 3 vector with direction cosines of pole</span>
<span class="sd">        to plane with respect to X1X2X3</span>
<span class="sd">    </span>
<span class="sd">    NOTE = Plane orientation follows the right hand rule</span>
<span class="sd">    Input/Output angles are in radians</span>
<span class="sd">    </span>
<span class="sd">    Python function translated from the Matlab function</span>
<span class="sd">    Cauchy in Allmendinger et al. (2012)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Compute direction cosines of X1X2X3 with respect</span>
    <span class="c1"># to NED</span>
    <span class="n">dc</span> <span class="o">=</span> <span class="n">dircos_axes</span><span class="p">(</span><span class="n">tx1</span><span class="p">,</span><span class="n">px1</span><span class="p">,</span><span class="n">tx3</span><span class="p">)</span>
    
    <span class="c1"># Calculate direction cosines of pole to plane</span>
    <span class="n">trd</span><span class="p">,</span> <span class="n">plg</span> <span class="o">=</span> <span class="n">pole_from_plane</span><span class="p">(</span><span class="n">strike</span><span class="p">,</span><span class="n">dip</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">sph_to_cart</span><span class="p">(</span><span class="n">trd</span><span class="p">,</span><span class="n">plg</span><span class="p">)</span>
    
    <span class="c1"># Transform pole to plane to stress coordinates X1X2X3</span>
    <span class="c1"># The transformation matrix is the direction cosines of</span>
    <span class="c1"># X1X2X3</span>
    <span class="n">pt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">pt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">pt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            
    <span class="c1"># Calculate the tractions in stress coordinates X1X2X3</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="c1"># Compute tractions using Cauchy&quot;s law</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">stress</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">pt</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">pt</span>


<span class="k">def</span> <span class="nf">dircos_axes</span><span class="p">(</span><span class="n">tx1</span><span class="p">,</span><span class="n">px1</span><span class="p">,</span><span class="n">tx3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    dircos_axes calculates the direction cosines of a right</span>
<span class="sd">    handed, orthogonal X1X2X3 cartesian coordinate system</span>
<span class="sd">    of any orientation with respect to NED</span>
<span class="sd">    </span>
<span class="sd">    USE: dc = dircos_axes(tx1,px1,tx3)</span>
<span class="sd">    </span>
<span class="sd">    tx1 = trend of X1</span>
<span class="sd">    px1 = plunge of X1</span>
<span class="sd">    tx3 = trend of X3</span>
<span class="sd">    dc = 3 x 3 matrix containing the direction cosines</span>
<span class="sd">        of X1 (row 1), X2 (row 2), and X3 (row 3)</span>
<span class="sd">    </span>
<span class="sd">    Note: Input angles should be in radians</span>
<span class="sd">    </span>
<span class="sd">    Python function translated from the Matlab function</span>
<span class="sd">    DirCosAxes in Allmendinger et al. (2012)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Some constants</span>
    <span class="n">east</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="n">west</span> <span class="o">=</span> <span class="mf">3.0</span><span class="o">*</span><span class="n">east</span>
    <span class="c1"># tolerance for near zero values</span>
    <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-6</span> 
    
    <span class="c1"># Initialize matrix of direction cosines</span>
    <span class="n">dc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    
    <span class="c1"># Direction cosines of X1</span>
    <span class="n">dc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">dc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">dc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">sph_to_cart</span><span class="p">(</span><span class="n">tx1</span><span class="p">,</span><span class="n">px1</span><span class="p">)</span>
    
    <span class="c1"># Calculate plunge of axis 3</span>
    <span class="c1"># If axis 1 is horizontal</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">px1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">tx1</span><span class="o">-</span><span class="n">tx3</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dt</span> <span class="o">-</span> <span class="n">east</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dt</span> <span class="o">-</span> <span class="n">west</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="n">px3</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">px3</span> <span class="o">=</span> <span class="n">east</span>
    <span class="c1"># Else</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Since dot product X1 and X3 = 0</span>
        <span class="n">px3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">dc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">tx3</span><span class="p">)</span>
            <span class="o">+</span><span class="n">dc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">tx3</span><span class="p">))</span><span class="o">/</span><span class="n">dc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
    
    <span class="c1"># Direction cosines of X3</span>
    <span class="n">dc</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">dc</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">dc</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">sph_to_cart</span><span class="p">(</span><span class="n">tx3</span><span class="p">,</span><span class="n">px3</span><span class="p">)</span>
    
    <span class="c1"># X2 is the cross product of X3 and X1</span>
    <span class="n">dc</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">dc</span><span class="p">[</span><span class="mi">2</span><span class="p">,:],</span><span class="n">dc</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
    
    <span class="c1"># Make it a unit vector</span>
    <span class="n">dc</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">dc</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dc</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span>
    
    <span class="k">return</span> <span class="n">dc</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="stress-transformation">
<span id="ch07-1-2"></span><h3><span class="section-number">7.1.2. </span>Stress transformation<a class="headerlink" href="#stress-transformation" title="Permalink to this headline">#</a></h3>
<p>If we know the components of the stress tensor in one coordinate system <span class="math notranslate nohighlight">\(\mathbf{X_1X_2X_3}\)</span>, we can calculate the components of the tensor in another coordinate system <span class="math notranslate nohighlight">\(\mathbf{X'_1X'_2X'_3}\)</span> (<a class="reference internal" href="ch06_tensors.html#ch06-4"><span class="std std-ref">Section 6.4</span></a>):</p>
<div class="math notranslate nohighlight" id="equation-ch07-eq05">
<span class="eqno">(7.5)<a class="headerlink" href="#equation-ch07-eq05" title="Permalink to this equation">#</a></span>\[
\boldsymbol{\sigma '}=\mathbf{a}^{\mathbf{T}}\boldsymbol{\sigma}\mathbf{a}\quad \text{or}\quad \sigma'_{ij}=a_{ik}a_{jl}\sigma_{kl}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> is the transformation matrix between the new and the old coordinate system. The function <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/functions/transform_stress.py">transform_stress</a> tranforms the stress tensor from one coordinate system to another:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">compgeo.dircos_axes</span> <span class="kn">import</span> <span class="n">dircos_axes</span>


<span class="k">def</span> <span class="nf">transform_stress</span><span class="p">(</span><span class="n">stress</span><span class="p">,</span><span class="n">tx1</span><span class="p">,</span><span class="n">px1</span><span class="p">,</span><span class="n">tx3</span><span class="p">,</span><span class="n">ntx1</span><span class="p">,</span><span class="n">npx1</span><span class="p">,</span><span class="n">ntx3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    transform_stress transforms a stress tensor from</span>
<span class="sd">    old X1X2X3 to new X1&#39;X2&#39;X3&#39; coordinates</span>
<span class="sd">    </span>
<span class="sd">    nstress=transform_stress(stress,tx1,px1,tx3,ntx1,npx1,ntx3)</span>
<span class="sd">    </span>
<span class="sd">    stress = 3 x 3 stress tensor</span>
<span class="sd">    tx1 = trend of X1 </span>
<span class="sd">    px1 = plunge of X1 </span>
<span class="sd">    tx3 = trend of X3</span>
<span class="sd">    ntx1 = trend of X1&#39;</span>
<span class="sd">    npx1 = plunge of X1&#39;</span>
<span class="sd">    ntx3 = trend of X3&#39;</span>
<span class="sd">    nstress = 3 x 3 stress tensor in new coordinate system</span>
<span class="sd">    </span>
<span class="sd">    NOTE: All input angles should be in radians</span>
<span class="sd">    </span>
<span class="sd">    Python function translated from the Matlab function</span>
<span class="sd">    TransformStress in Allmendinger et al. (2012)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Direction cosines of axes of old coordinate system</span>
    <span class="n">odc</span> <span class="o">=</span> <span class="n">dircos_axes</span><span class="p">(</span><span class="n">tx1</span><span class="p">,</span><span class="n">px1</span><span class="p">,</span><span class="n">tx3</span><span class="p">)</span>
    
    <span class="c1"># Direction cosines of axes of new coordinate system</span>
    <span class="n">ndc</span> <span class="o">=</span> <span class="n">dircos_axes</span><span class="p">(</span><span class="n">ntx1</span><span class="p">,</span><span class="n">npx1</span><span class="p">,</span><span class="n">ntx3</span><span class="p">)</span>
    
    <span class="c1"># Transformation matrix between old and new</span>
    <span class="c1"># coordinate systems</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            
            <span class="c1"># Use dot product</span>
            <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ndc</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span><span class="n">odc</span><span class="p">[</span><span class="n">j</span><span class="p">,:])</span>
    
    <span class="c1"># Transform stress</span>
    <span class="n">nstress</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                    <span class="n">nstress</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">l</span><span class="p">]</span> <span class="o">*</span> <span class="n">stress</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">l</span><span class="p">]</span> \
                        <span class="o">+</span> <span class="n">nstress</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">nstress</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="principal-axes-of-stress">
<span id="ch07-1-3"></span><h3><span class="section-number">7.1.3. </span>Principal axes of stress<a class="headerlink" href="#principal-axes-of-stress" title="Permalink to this headline">#</a></h3>
<p>Since stress is a symmetric tensor, there is one orientation of the coordinate system for which the non-diagonal components of the tensor are zero, and only normal tractions act on the planes perpendicular to the coordinate axes (<a class="reference internal" href="#ch07-fig03"><span class="std std-numref">Figure 7.3</span></a>). These normal tractions are the principal stresses: <span class="math notranslate nohighlight">\(\sigma_1\)</span> is the maximum, <span class="math notranslate nohighlight">\(\sigma_2\)</span> is the intermediate, and <span class="math notranslate nohighlight">\(\sigma_3\)</span> is the minimum principal stress.</p>
<figure class="align-default" id="ch07-fig03">
<a class="reference internal image-reference" href="_images/ch07_fig03.png"><img alt="_images/ch07_fig03.png" src="_images/ch07_fig03.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 7.3 </span><span class="caption-text">Plane oblique to the principal stress coordinate system <span class="math notranslate nohighlight">\(\textbf{X_{1}X_{2}X_{3}}\)</span>. <span class="math notranslate nohighlight">\(\sigma_{1}\)</span>, <span class="math notranslate nohighlight">\(\sigma_{2}\)</span> and <span class="math notranslate nohighlight">\(\sigma_{3}\)</span> are the principal stresses, and <span class="math notranslate nohighlight">\(\sigma\)</span> and <span class="math notranslate nohighlight">\(\tau\)</span> are the normal and maximum shear tractions on the plane.</span><a class="headerlink" href="#ch07-fig03" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>As we saw in <a class="reference internal" href="ch06_tensors.html#ch06-2"><span class="std std-ref">Section 6.2</span></a>, finding the principal stresses is an eigenvalue problem. The function <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/functions/principal_stress.py">principal_stress</a> calculates the principal stresses and their orientations for a given stress tensor in a Cartesian coordinate system of any orientation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">compgeo.dircos_axes</span> <span class="kn">import</span> <span class="n">dircos_axes</span>
<span class="kn">from</span> <span class="nn">compgeo.cart_to_sph</span> <span class="kn">import</span> <span class="n">cart_to_sph</span>


<span class="k">def</span> <span class="nf">principal_stress</span><span class="p">(</span><span class="n">stress</span><span class="p">,</span><span class="n">tx1</span><span class="p">,</span><span class="n">px1</span><span class="p">,</span><span class="n">tx3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given the stress tensor in a X1X2X3 coordinate system</span>
<span class="sd">    principal_stress calculates the principal stresses and</span>
<span class="sd">    their orientations (trend and plunge) </span>
<span class="sd">    </span>
<span class="sd">    USE: pstress,dcp = principal_stress(stress,tx1,px1,tx3)</span>
<span class="sd">    </span>
<span class="sd">    stress = Symmetric 3 x 3 stress tensor</span>
<span class="sd">    tx1 = trend of X1</span>
<span class="sd">    px1 = plunge of X1</span>
<span class="sd">    tx3 = trend of X3</span>
<span class="sd">    pstress = 3 x 3 matrix containing the magnitude</span>
<span class="sd">        (column 1), trend (column 2), and plunge</span>
<span class="sd">        (column 3) of the    maximum (row 1),</span>
<span class="sd">        intermediate (row 2), and minimum (row 3)</span>
<span class="sd">        principal stresses</span>
<span class="sd">    dcp = 3 x 3 matrix with direction cosines of the</span>
<span class="sd">        principal stress directions: Max. (row 1),</span>
<span class="sd">        Int. (row 2), and Min. (row 3) with respect</span>
<span class="sd">        to North-East-Down</span>
<span class="sd">    </span>
<span class="sd">    NOTE: Input/Output angles are in radians</span>
<span class="sd">    </span>
<span class="sd">    Python function translated from the Matlab function</span>
<span class="sd">    PrincipalStress in Allmendinger et al. (2012)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Compute direction cosines of X1X2X3</span>
    <span class="n">dc</span> <span class="o">=</span> <span class="n">dircos_axes</span><span class="p">(</span><span class="n">tx1</span><span class="p">,</span><span class="n">px1</span><span class="p">,</span><span class="n">tx3</span><span class="p">)</span>
    
    <span class="c1"># Initialize pstress</span>
    <span class="n">pstress</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    
    <span class="c1"># Calculate the eigenvalues and eigenvectors</span>
    <span class="c1"># of the stress tensor</span>
    <span class="n">D</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">stress</span><span class="p">)</span>
    
    <span class="c1"># Fill principal stress magnitudes</span>
    <span class="n">pstress</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">D</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># Maximum principal stress</span>
    <span class="n">pstress</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Interm. principal stress</span>
    <span class="n">pstress</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># Minimum principal stress</span>
    
    <span class="c1"># The direction cosines of the principal stresses are</span>
    <span class="c1"># with respect to the X1X2X3 stress coordinate system,</span>
    <span class="c1"># so they need to be transformed to the NED coordinate</span>
    <span class="c1"># system</span>
    <span class="n">tv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">tv</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dc</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">V</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">tv</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
                
    
    <span class="c1"># Initialize dcp</span>
    <span class="n">dcp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    
    <span class="c1"># Direction cosines of principal stresses</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
        
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
            
            <span class="n">dcp</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">tv</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">2</span><span class="o">-</span><span class="n">i</span><span class="p">]</span>
        
        <span class="c1"># Avoid precision issues</span>
        <span class="c1"># Make sure the principal axes are unit vectors</span>
        <span class="n">dcp</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">dcp</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dcp</span><span class="p">[</span><span class="n">i</span><span class="p">,:])</span>
    
    <span class="c1"># Trend and plunge of principal stresses</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">pstress</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">pstress</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">cart_to_sph</span><span class="p">(</span><span class="n">dcp</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">dcp</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">dcp</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
    
    <span class="k">return</span> <span class="n">pstress</span><span class="p">,</span><span class="n">dcp</span>
</pre></div>
</div>
</div>
</div>
<p>If we know the principal stresses, and the direction cosines of the pole to the plane <span class="math notranslate nohighlight">\(\mathbf{p}\)</span> with respect to them (<a class="reference internal" href="#ch07-fig03"><span class="std std-numref">Figure 7.3</span></a>), it is possible to compute the normal, <span class="math notranslate nohighlight">\(\sigma\)</span>, and maximum shear, <span class="math notranslate nohighlight">\(\tau\)</span>, tractions acting on the plane (Ramsay, 1967):</p>
<div class="math notranslate nohighlight" id="equation-ch07-eq06">
<span class="eqno">(7.6)<a class="headerlink" href="#equation-ch07-eq06" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{gathered}
    \sigma=\sigma_{1} l^{2}+\sigma_{2} m^{2}+\sigma_{3} n^{2} \\
    \tau^{2}=\left(\sigma_{1}-\sigma_{2}\right)^{2} l^{2} m^{2}+\left(\sigma_{2}-\sigma_{3}\right)^{2} m^{2} n^{2}+\left(\sigma_{3}-\sigma_{1}\right)^{2} n^{2} l^{2}
\end{gathered}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(l\)</span>, <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(n\)</span> are the direction cosines of <span class="math notranslate nohighlight">\(\mathbf{p}\)</span> with respect to <span class="math notranslate nohighlight">\(\sigma_1\)</span>, <span class="math notranslate nohighlight">\(\sigma_2\)</span> and <span class="math notranslate nohighlight">\(\sigma_3\)</span>, respectively. Notice that this equation just tells us about the magnitude of the maximum shear traction. It does not say anything about the direction and sense of it. In <a class="reference internal" href="#ch07-4-1"><span class="std std-ref">Section 7.4.1</span></a>, we will see a more comprehensive way to solve this problem.</p>
<p>Let’s use the functions introduced so far to solve the following problem: The maximum, intermediate and minimum principal stresses are 40, 30, and 20 MPa, respectively. <span class="math notranslate nohighlight">\(\sigma_1\)</span> is vertical and <span class="math notranslate nohighlight">\(\sigma_3\)</span> is horizontal and trends N-S:</p>
<ol class="simple">
<li><p>Compute the tractions parallel to the principal stress directions, acting on a plane with orientation 040/65 (RHR).</p></li>
<li><p>Compute the normal and maximum shear tractions acting on the plane.</p></li>
<li><p>Compute the stress tensor on a new coordinate system with <span class="math notranslate nohighlight">\(\mathbf{X_1}\)</span> 030/45 and <span class="math notranslate nohighlight">\(\mathbf{X_3}\)</span> trending 210.</p></li>
<li><p>Demonstrate that these new components represent still the same tensor, by computing the principal stresses from the new components.</p></li>
</ol>
<p>The notebook <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/notebooks/ch7-1.ipynb">ch7-1</a> shows the solution to this problem:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

<span class="c1"># Import Cauchy, TransformStress and PrincipalStress</span>
<span class="kn">from</span> <span class="nn">compgeo.cauchy</span> <span class="kn">import</span> <span class="n">cauchy</span> 
<span class="kn">from</span> <span class="nn">compgeo.transform_stress</span> <span class="kn">import</span> <span class="n">transform_stress</span>
<span class="kn">from</span> <span class="nn">compgeo.principal_stress</span> <span class="kn">import</span> <span class="n">principal_stress</span>

<span class="c1"># Stress tensor in principal stress coordinate system</span>
<span class="n">stress</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">]])</span>

<span class="c1"># trend and plunge of X1, and trend of X3</span>
<span class="n">tx1</span><span class="p">,</span> <span class="n">px1</span><span class="p">,</span> <span class="n">tx3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="c1"># plane orientation</span>
<span class="n">strike</span><span class="p">,</span> <span class="n">dip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">([</span><span class="mi">40</span><span class="p">,</span> <span class="mi">65</span><span class="p">])</span>

<span class="c1"># X1, X2 and X3 tractions on the plane</span>
<span class="n">t</span><span class="p">,</span><span class="n">pt</span> <span class="o">=</span> <span class="n">cauchy</span><span class="p">(</span><span class="n">stress</span><span class="p">,</span><span class="n">tx1</span><span class="p">,</span><span class="n">px1</span><span class="p">,</span><span class="n">tx3</span><span class="p">,</span><span class="n">strike</span><span class="p">,</span><span class="n">dip</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;X1, X2 and X3 tractions = &quot;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Compute the normal and maximum shear tractions </span>
<span class="c1"># on the plane: Eq. 7.6</span>
<span class="n">l2</span> <span class="o">=</span> <span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
<span class="n">m2</span> <span class="o">=</span> <span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
<span class="n">n2</span> <span class="o">=</span> <span class="n">pt</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">stress</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">stress</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">s3</span> <span class="o">=</span> <span class="n">stress</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">s12</span> <span class="o">=</span> <span class="n">s1</span> <span class="o">-</span> <span class="n">s2</span>
<span class="n">s23</span> <span class="o">=</span> <span class="n">s2</span> <span class="o">-</span> <span class="n">s3</span>
<span class="n">s31</span> <span class="o">=</span> <span class="n">s3</span> <span class="o">-</span> <span class="n">s1</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">s1</span><span class="o">*</span><span class="n">l2</span> <span class="o">+</span> <span class="n">s2</span><span class="o">*</span><span class="n">m2</span> <span class="o">+</span> <span class="n">s3</span><span class="o">*</span><span class="n">n2</span>
<span class="n">tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">s12</span><span class="o">*</span><span class="n">s12</span><span class="o">*</span><span class="n">l2</span><span class="o">*</span><span class="n">m2</span> <span class="o">+</span> <span class="n">s23</span><span class="o">*</span><span class="n">s23</span><span class="o">*</span><span class="n">m2</span><span class="o">*</span><span class="n">n2</span> <span class="o">+</span> <span class="n">s31</span><span class="o">*</span><span class="n">s31</span><span class="o">*</span><span class="n">n2</span><span class="o">*</span><span class="n">l2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sigma = </span><span class="si">{:.3f}</span><span class="s2">, Tau = </span><span class="si">{:.3f}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span><span class="n">tau</span><span class="p">))</span>

<span class="c1"># New coordinate system</span>
<span class="c1"># trend and plunge of X&quot;1,and trend of X&quot;3</span>
<span class="n">ntx1</span><span class="p">,</span> <span class="n">npx1</span><span class="p">,</span> <span class="n">ntx3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">([</span><span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">210</span><span class="p">])</span>

<span class="c1"># Transform stress to new coordinate system</span>
<span class="n">nstress</span> <span class="o">=</span> <span class="n">transform_stress</span><span class="p">(</span><span class="n">stress</span><span class="p">,</span><span class="n">tx1</span><span class="p">,</span><span class="n">px1</span><span class="p">,</span><span class="n">tx3</span><span class="p">,</span><span class="n">ntx1</span><span class="p">,</span><span class="n">npx1</span><span class="p">,</span><span class="n">ntx3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Stress in new coord. system = </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> 
      <span class="n">nstress</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Principal stresses from new components</span>
<span class="n">pstress</span><span class="p">,</span> <span class="n">dcp</span> <span class="o">=</span> <span class="n">principal_stress</span><span class="p">(</span><span class="n">nstress</span><span class="p">,</span><span class="n">ntx1</span><span class="p">,</span><span class="n">npx1</span><span class="p">,</span><span class="n">ntx3</span><span class="p">)</span>
<span class="n">pstress</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">pstress</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sigma1 = </span><span class="si">{:.3f}</span><span class="s2">, Trend = </span><span class="si">{:.1f}</span><span class="s2">, Plunge = </span><span class="si">{:.1f}</span><span class="s2">&quot;</span>
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pstress</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">pstress</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">pstress</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sigma2 = </span><span class="si">{:.3f}</span><span class="s2">, Trend = </span><span class="si">{:.1f}</span><span class="s2">, Plunge = </span><span class="si">{:.1f}</span><span class="s2">&quot;</span>
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pstress</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">pstress</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">pstress</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sigma3 = </span><span class="si">{:.3f}</span><span class="s2">, Trend = </span><span class="si">{:.1f}</span><span class="s2">, Plunge = </span><span class="si">{:.1f}</span><span class="s2">&quot;</span>
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pstress</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">pstress</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">pstress</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X1, X2 and X3 tractions =  [16.905 20.828 11.651] 

Sigma = 28.392, Tau = 7.015

Stress in new coord. system = 
 [[31.25   3.062  8.75 ]
 [ 3.062 27.5   -3.062]
 [ 8.75  -3.062 31.25 ]] 

Sigma1 = 40.000, Trend = 143.1, Plunge = -90.0
Sigma2 = 30.000, Trend = 270.0, Plunge = -0.0
Sigma3 = 20.000, Trend = 180.0, Plunge = 0.0
</pre></div>
</div>
</div>
</div>
<p>The principal stresses computed from the new components of the stress tensor are the same as the input principal stresses. Try changing the orientations of the principal stresses in the notebook (e.g. <code class="docutils literal notranslate"><span class="pre">tx1</span></code> = 45, <code class="docutils literal notranslate"><span class="pre">px1</span></code> = 0). Check how the results change. This is a great way to understand the concepts introduced so far.</p>
</section>
</section>
<section id="mohr-circle-for-stress">
<span id="ch07-2"></span><h2><span class="section-number">7.2. </span>Mohr circle for stress<a class="headerlink" href="#mohr-circle-for-stress" title="Permalink to this headline">#</a></h2>
<p>As discussed in <a class="reference internal" href="ch06_tensors.html#ch06-4-1"><span class="std std-ref">Section 6.4.1</span></a>, the Mohr circle is derived by making a rotation about one of the principal axes of a symmetric tensor. In the case of stress, the rotation is about one of the principal stresses. In <a class="reference internal" href="#ch07-fig04"><span class="std std-numref">Figure 7.4</span></a>a, the old axes are parallel to the principal axes of the stress tensor, and the rotation is about the <span class="math notranslate nohighlight">\(\mathbf{X_2}\)</span> (<span class="math notranslate nohighlight">\(\sigma_2\)</span>) axis. If the amount of rotation <span class="math notranslate nohighlight">\(\theta\)</span> is such that the new <span class="math notranslate nohighlight">\(\mathbf{X'_1}\)</span> axis is parallel to the normal to the plane <span class="math notranslate nohighlight">\(\mathbf{n}\)</span> (<a class="reference internal" href="#ch07-fig04"><span class="std std-numref">Figure 7.4</span></a>b), the components <span class="math notranslate nohighlight">\(\sigma '_{11}\)</span> and <span class="math notranslate nohighlight">\(\sigma '_{13}\)</span> are the normal (<span class="math notranslate nohighlight">\(\sigma\)</span>) and shear (<span class="math notranslate nohighlight">\(\tau\)</span>) tractions on the plane, respectively. These tractions are given by:</p>
<div class="math notranslate nohighlight" id="equation-ch07-eq07">
<span class="eqno">(7.7)<a class="headerlink" href="#equation-ch07-eq07" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{gathered}
	\sigma=\frac{\sigma_1+\sigma_3}{2}+\frac{\sigma_1-\sigma_3}{2}\cos2\theta \\
	\tau=\frac{\sigma_1-\sigma_3}{2}\sin2\theta
\end{gathered}
\end{split}\]</div>
<p>which are similar to Eq. <a class="reference internal" href="ch06_tensors.html#equation-ch06-eq14">(6.14)</a> and define the Mohr circle for stress.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The sign change in the equation for <span class="math notranslate nohighlight">\(\tau\)</span> is due to our convention of considering compressional tractions as positive.</p>
</div>
<figure class="align-default" id="ch07-fig04">
<a class="reference internal image-reference" href="_images/ch07_fig04.png"><img alt="_images/ch07_fig04.png" src="_images/ch07_fig04.png" style="width: 650px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 7.4 </span><span class="caption-text">Rotation of the stress tensor about <span class="math notranslate nohighlight">\(\mathbf{X_2}\)</span>. <strong>a.</strong> The old coordinate system is parallel to the principal axes of the tensor. <strong>b.</strong> In the new coordinate system <span class="math notranslate nohighlight">\(\mathbf{X'_1}\)</span> is parallel to the normal to the plane of interest. Modified from Allmendinger et al. (2012).</span><a class="headerlink" href="#ch07-fig04" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The horizontal axis of the Mohr circle for stress is <span class="math notranslate nohighlight">\(\sigma\)</span> and the vertical axis is <span class="math notranslate nohighlight">\(\tau\)</span>. <span class="math notranslate nohighlight">\(\sigma\)</span> is positive if compressional, and <span class="math notranslate nohighlight">\(\tau\)</span> is positive if the sense of shear is anticlockwise (e.g. <a class="reference internal" href="#ch07-fig04"><span class="std std-numref">Figure 7.4</span></a>b). The x coordinate of the center, <span class="math notranslate nohighlight">\(C\)</span>, of the Mohr circle is <span class="math notranslate nohighlight">\((\sigma_1+\sigma_3)/2\)</span>, and the radius, <span class="math notranslate nohighlight">\(r\)</span>, is <span class="math notranslate nohighlight">\((\sigma_1-\sigma_3)/2\)</span> (<a class="reference internal" href="#ch07-fig05"><span class="std std-numref">Figure 7.5</span></a>).</p>
<figure class="align-default" id="ch07-fig05">
<a class="reference internal image-reference" href="_images/ch07_fig05.png"><img alt="_images/ch07_fig05.png" src="_images/ch07_fig05.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 7.5 </span><span class="caption-text">Mohr circle for stress for the situation shown in Fig. 7.4. The normal and shear tractions on the plane (point <span class="math notranslate nohighlight">\(P\)</span>) can be found by either measuring <span class="math notranslate nohighlight">\(2\theta\)</span> from <span class="math notranslate nohighlight">\(\sigma_{1}\)</span> or by tracing the plane from the pole of planes <span class="math notranslate nohighlight">\(O_{P}\)</span>.</span><a class="headerlink" href="#ch07-fig05" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>If the normal to the plane makes an angle <span class="math notranslate nohighlight">\(\theta\)</span> with respect to <span class="math notranslate nohighlight">\(\sigma_1\)</span> (<a class="reference internal" href="#ch07-fig04"><span class="std std-numref">Figure 7.4</span></a>), the normal and shear tractions on the plane can be found by drawing in the Mohr circle a radius <span class="math notranslate nohighlight">\(CP\)</span> at an angle <span class="math notranslate nohighlight">\(2\theta\)</span> with respect to <span class="math notranslate nohighlight">\(\sigma_1\)</span> (<a class="reference internal" href="#ch07-fig05"><span class="std std-numref">Figure 7.5</span></a>). The coordinates of point <span class="math notranslate nohighlight">\(P\)</span> are the normal and shear tractions on the plane.</p>
<p>If we draw lines from <span class="math notranslate nohighlight">\(\sigma_1\)</span> and <span class="math notranslate nohighlight">\(\sigma_3\)</span> parallel to the planes on which these tractions act, the lines will intersect at a point <span class="math notranslate nohighlight">\(O_P\)</span> (<a class="reference internal" href="#ch07-fig05"><span class="std std-numref">Figure 7.5</span></a>). This point is known as the pole for planes (Ragan, 2009) and it has a very useful property: A line drawn from <span class="math notranslate nohighlight">\(O_P\)</span> to any point <span class="math notranslate nohighlight">\(P\)</span> on the Mohr circle circumference is parallel to the plane on which the tractions given by <span class="math notranslate nohighlight">\(P\)</span> act (<a class="reference internal" href="#ch07-fig05"><span class="std std-numref">Figure 7.5</span></a>). Thus, from <span class="math notranslate nohighlight">\(O_P\)</span>, we can rapidly find out the tractions on any plane parallel to <span class="math notranslate nohighlight">\(\sigma_2\)</span>.</p>
<p>Notice that we can rotate the stress tensor about anyone of the three principal axes. Thus in 3D, the Mohr circle for stress consists of three circles, each one describing the rotation about one of the principal stresses. In <a class="reference internal" href="#ch07-4-2"><span class="std std-ref">Section 7.4.2</span></a> we will see how to plot the Mohr circle for stress in 3D.</p>
<section id="special-states-of-stress">
<span id="ch07-2-1"></span><h3><span class="section-number">7.2.1. </span>Special states of stress<a class="headerlink" href="#special-states-of-stress" title="Permalink to this headline">#</a></h3>
<p>There are some special states of stress that can be illustrated with the Mohr circle:</p>
<ul class="simple">
<li><p>Biaxial stress: Two of the principal stresses are non-zero and are different (<a class="reference internal" href="#ch07-fig06"><span class="std std-numref">Figure 7.6</span></a>a).</p></li>
<li><p>Triaxial stress: This is the most general type of stress. It has three non-zero, different principal stresses (<a class="reference internal" href="#ch07-fig06"><span class="std std-numref">Figure 7.6</span></a>b).</p></li>
<li><p>Cylindrical stress: When two of the principal stresses are equal and the third is different (<a class="reference internal" href="#ch07-fig06"><span class="std std-numref">Figure 7.6</span></a>c). If the two equal principal stresses are zero, the stress is known as uniaxial.</p></li>
<li><p>Hydrostatic stress: All three principal stresses have the same value (<a class="reference internal" href="#ch07-fig06"><span class="std std-numref">Figure 7.6</span></a>d). In this case, any direction is a principal axis (the stress tensor is a sphere), and there are no shear tractions on the body. This condition is typical of static fluids.</p></li>
<li><p>Pure shear stress: Two of the principal stresses are equal in magnitude but opposite in sign (one is compressional and the other is tensional), and the third is zero (<a class="reference internal" href="#ch07-fig06"><span class="std std-numref">Figure 7.6</span></a>e).</p></li>
</ul>
<figure class="align-default" id="ch07-fig06">
<a class="reference internal image-reference" href="_images/ch07_fig06.png"><img alt="_images/ch07_fig06.png" src="_images/ch07_fig06.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 7.6 </span><span class="caption-text">Mohr circle for several special states of stress. <strong>a.</strong> Biaxial, <strong>b.</strong> Triaxial, <strong>c.</strong> Cylindrical uniaxial, <strong>d.</strong> Hydrostatic, <strong>e.</strong> Pure shear. Modified from Allmendinger et al. (2012).</span><a class="headerlink" href="#ch07-fig06" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="mean-and-deviatoric-stress">
<span id="ch07-3"></span><h2><span class="section-number">7.3. </span>Mean and deviatoric stress<a class="headerlink" href="#mean-and-deviatoric-stress" title="Permalink to this headline">#</a></h2>
<p>The special states of stress above allow us to introduce two fundamental types of stress tensors, the mean stress and the deviatoric stress. The mean traction is the average of the three normal tractions (the elements in the diagonal of the stress tensor):</p>
<div class="math notranslate nohighlight" id="equation-ch07-eq08">
<span class="eqno">(7.8)<a class="headerlink" href="#equation-ch07-eq08" title="Permalink to this equation">#</a></span>\[
\sigma_m=\frac{\sigma_{11}+\sigma_{22}+\sigma_{33}}{3}
\]</div>
<p>Notice that the mean traction is the same regardless of the coordinate system because the sum of the normal tractions is the first invariant of the stress tensor (<a class="reference internal" href="ch06_tensors.html#ch06-2"><span class="std std-ref">Section 6.2</span></a>). Knowing the mean traction, we can express the stress tensor as the sum of two tensors:</p>
<div class="math notranslate nohighlight" id="equation-ch07-eq09">
<span class="eqno">(7.9)<a class="headerlink" href="#equation-ch07-eq09" title="Permalink to this equation">#</a></span>\[\begin{split}
\sigma_{ij}=\left[\begin{array}{ccc}\sigma_m &amp; 0 &amp; 0 \\ 0 &amp; \sigma_m &amp; 0 \\ 0 &amp; 0 &amp; \sigma_m\end{array}\right]+\left[\begin{array}{ccc}\sigma_{11}-\sigma_m &amp; \sigma_{12} &amp; \sigma_{13} \\ \sigma_{21} &amp; \sigma_{22}-\sigma_m &amp; \sigma_{23} \\ \sigma_{31} &amp; \sigma_{32} &amp; \sigma_{33}-\sigma_m\end{array}\right]
\end{split}\]</div>
<p>The tensor on the left is the mean stress. It is a hydrostatic state of stress that may cause a body to shrink or expand but, on first glance, it is difficult to see how it would change the shape of the body, unless the body is heterogeneous in strength. The tensor on the right is the deviatoric stress. It is the part of the stress tensor that causes distortion of the body. For a cylindrical state of stress (<a class="reference internal" href="#ch07-fig06"><span class="std std-numref">Figure 7.6</span></a>c), it is easy to visualize these tensors. The mean stress is represented by the center of the Mohr circle, while the deviatoric stress is represented by the same circle but centered at the origin.</p>
</section>
<section id="applications">
<span id="ch07-4"></span><h2><span class="section-number">7.4. </span>Applications<a class="headerlink" href="#applications" title="Permalink to this headline">#</a></h2>
<p>In this section we will look at a problem involving stress, namely calculating the magnitude and orientation of the normal and maximum shear tractions on a plane. This problem is crucial to any question involving faulting and fracturing in the upper crust. We will also use the proposed solution to draw the Mohr circle for stress in 3D.</p>
<section id="normal-and-shear-tractions-on-a-plane">
<span id="ch07-4-1"></span><h3><span class="section-number">7.4.1. </span>Normal and shear tractions on a plane<a class="headerlink" href="#normal-and-shear-tractions-on-a-plane" title="Permalink to this headline">#</a></h3>
<p><a class="reference internal" href="#ch07-fig07"><span class="std std-numref">Figure 7.7</span></a> illustrates the problem. We want to determine the normal and maximum shear tractions on a plane of any orientation, under a stress tensor with principal axes of any orientation. There are three coordinate systems involved: 1. The geographic coordinate system <span class="math notranslate nohighlight">\(\mathbf{NED}\)</span> where the data are input and the results are output, 2. The principal stress coordinate system which is defined by the orientation of the principal stresses <span class="math notranslate nohighlight">\(\sigma_1\)</span>, <span class="math notranslate nohighlight">\(\sigma_2\)</span> and <span class="math notranslate nohighlight">\(\sigma_3\)</span>, and 3. A coordinate system defined by the fault plane, with the pole to the plane, <span class="math notranslate nohighlight">\(\mathbf{p}\)</span>, as the first axis, the line of zero shear traction on the fault plane, <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>, as the second axis, and the line of maximum shear traction on the fault plane, <span class="math notranslate nohighlight">\(\mathbf{s}\)</span>, as the third axis.</p>
<figure class="align-default" id="ch07-fig07">
<a class="reference internal image-reference" href="_images/ch07_fig07.png"><img alt="_images/ch07_fig07.png" src="_images/ch07_fig07.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 7.7 </span><span class="caption-text">Lower hemisphere, equal area stereonet illustrating the three coordinate systems involved in determining the maximum shear traction on a fault plane with pole <strong>p</strong>. These coordinate systems are: <strong>NED</strong>, $\sigma_{1}\sigma_{2}\sigma_{3}, and <strong>pbs</strong>. <strong>b</strong> and <strong>s</strong> are the directions of zero and maximum shear traction, respectively. Modified from Allmendinger et al. (2012).</span><a class="headerlink" href="#ch07-fig07" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The solution to this problem consists of the following steps:</p>
<ol class="simple">
<li><p>Transform the stress tensor to principal stress coordinates. Here we can use the function <code class="docutils literal notranslate"><span class="pre">principal_stress</span></code>.</p></li>
<li><p>Transform the pole to the plane <span class="math notranslate nohighlight">\(\mathbf{p}\)</span> to principal stress coordinates.</p></li>
<li><p>Compute the traction vector <span class="math notranslate nohighlight">\(\mathbf{t}\)</span> (<a class="reference internal" href="#ch07-fig07"><span class="std std-numref">Figure 7.7</span></a>) in principal stress coordinates using Cauchy’s law (Eq. <a class="reference internal" href="#equation-ch07-eq04">(7.4)</a>).</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{p}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{t}\)</span> and the maximum shear traction <span class="math notranslate nohighlight">\(\mathbf{s}\)</span> fall along the same plane (<a class="reference internal" href="#ch07-fig07"><span class="std std-numref">Figure 7.7</span></a>). This plane is known as the <em>movement plane</em> (Marshak and Mitra, 1988). The pole to the movement plane is the line of zero shear traction <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>. Therefore, we can calculate <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> by the cross product of <span class="math notranslate nohighlight">\(\mathbf{t}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{p}\)</span>, and <span class="math notranslate nohighlight">\(\mathbf{s}\)</span> by the cross product of <span class="math notranslate nohighlight">\(\mathbf{p}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>.</p></li>
<li><p>Make a transformation matrix <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> between the principal stress coordinates and the fault plane coordinates. This matrix has as the first row <span class="math notranslate nohighlight">\(\mathbf{p}\)</span>, the second row <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>, and the third row <span class="math notranslate nohighlight">\(\mathbf{s}\)</span>.</p></li>
<li><p>Transform the stress tensor from principal stress coordinates to fault plane coordinates. For the transformed tensor, <span class="math notranslate nohighlight">\(\mathbf{X'_1}\)</span>  is the pole to the plane <span class="math notranslate nohighlight">\(\mathbf{p}\)</span>, and <span class="math notranslate nohighlight">\(\mathbf{X'_3}\)</span> is the direction of the maximum shear traction <span class="math notranslate nohighlight">\(\mathbf{s}\)</span>. Therefore, <span class="math notranslate nohighlight">\(\sigma'_{11}\)</span> is the normal traction on the plane, and <span class="math notranslate nohighlight">\(\sigma'_{13}\)</span> is the maximum shear traction on the plane.</p></li>
<li><p>Transform <span class="math notranslate nohighlight">\(\mathbf{p}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{s}\)</span> from principal stress coordinates to <span class="math notranslate nohighlight">\(\mathbf{NED}\)</span> coordinates and find their orientations (trend and plunge).</p></li>
</ol>
<p>The function <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/functions/shear_on_plane.py">shear_on_plane</a> follows these steps and computes the normal and maximum shear tractions on a plane of any orientation, and under a stress tensor of any orientation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">compgeo.principal_stress</span> <span class="kn">import</span> <span class="n">principal_stress</span>
<span class="kn">from</span> <span class="nn">compgeo.sph_to_cart</span> <span class="kn">import</span> <span class="n">sph_to_cart</span>
<span class="kn">from</span> <span class="nn">compgeo.cart_to_sph</span> <span class="kn">import</span> <span class="n">cart_to_sph</span>
<span class="kn">from</span> <span class="nn">compgeo.pole</span> <span class="kn">import</span> <span class="n">pole_from_plane</span>


<span class="k">def</span> <span class="nf">shear_on_plane</span><span class="p">(</span><span class="n">stress</span><span class="p">,</span><span class="n">tx1</span><span class="p">,</span><span class="n">px1</span><span class="p">,</span><span class="n">tx3</span><span class="p">,</span><span class="n">strike</span><span class="p">,</span><span class="n">dip</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    shear_on_plane calculates the direction and magnitudes of</span>
<span class="sd">    the normal and maximum shear tractions on an arbitrarily</span>
<span class="sd">    oriented plane</span>
<span class="sd">    </span>
<span class="sd">    tt,dctt,srat=shear_on_plane(stress,tx1,px1,tx3,strike,dip)</span>
<span class="sd">    </span>
<span class="sd">    stress = 3 x 3 stress tensor</span>
<span class="sd">    tx1 = trend of X1</span>
<span class="sd">    px1 = plunge of X1</span>
<span class="sd">    tx3 = trend of X3</span>
<span class="sd">    strike = strike of plane</span>
<span class="sd">    dip = dip of plane</span>
<span class="sd">    tt = 3 x 3 matrix with the magnitude (column 1),</span>
<span class="sd">        trend (column 2) and plunge (column 3) of the:</span>
<span class="sd">        normal traction on the plane (row 1), zero shear</span>
<span class="sd">        traction (row 2), and max. shear traction (row 3)</span>
<span class="sd">    dctt = 3 x 3 matrix with the direction cosines of unit</span>
<span class="sd">        vectors parallel to: normal traction on the plane</span>
<span class="sd">        (row 1), zero shear traction (row 2), and maximum</span>
<span class="sd">        shear traction (row 3) with respect to NED</span>
<span class="sd">    srat = stress ratio</span>
<span class="sd">    </span>
<span class="sd">    NOTE = Input stress tensor does not need to be along</span>
<span class="sd">        principal stress directions</span>
<span class="sd">        Plane orientation follows the right hand rule</span>
<span class="sd">        Input/Output angles are in radians</span>
<span class="sd">    </span>
<span class="sd">    Python function translated from the Matlab function</span>
<span class="sd">    shear_on_plane in Allmendinger et al. (2012)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Compute principal stresses and their orientations</span>
    <span class="n">pstress</span><span class="p">,</span> <span class="n">dcp</span> <span class="o">=</span> <span class="n">principal_stress</span><span class="p">(</span><span class="n">stress</span><span class="p">,</span><span class="n">tx1</span><span class="p">,</span><span class="n">px1</span><span class="p">,</span><span class="n">tx3</span><span class="p">)</span>
    
    <span class="c1"># Update stress tensor to principal stress directions</span>
    <span class="n">stress</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">stress</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pstress</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="c1"># Calculate stress ratio</span>
    <span class="n">srat</span> <span class="o">=</span> <span class="p">(</span><span class="n">stress</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">stress</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">stress</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">stress</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="c1"># Calculate direction cosines of pole to plane</span>
    <span class="n">trd</span><span class="p">,</span> <span class="n">plg</span> <span class="o">=</span> <span class="n">pole_from_plane</span><span class="p">(</span><span class="n">strike</span><span class="p">,</span><span class="n">dip</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">sph_to_cart</span><span class="p">(</span><span class="n">trd</span><span class="p">,</span><span class="n">plg</span><span class="p">)</span>
    
    <span class="c1"># transform pole to plane to  principal stress coordinates</span>
    <span class="n">pt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">pt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dcp</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">pt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    
    <span class="c1"># Calculate the tractions in principal stress coordinates</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># Compute tractions using Cauchy&#39;s law</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">stress</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">pt</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    
    <span class="c1"># Find the b axis by the cross product of t and pt</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">pt</span><span class="p">)</span>
    
    <span class="c1"># Find the max. shear traction orientation</span>
    <span class="c1"># by the cross product of pt and b</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
    
    <span class="c1"># Convert b and s to unit vectors</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    
    <span class="c1"># Now we can write the transformation matrix from</span>
    <span class="c1"># principal stress coordinates to plane coordinates</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">pt</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">b</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">s</span>
    
    <span class="c1"># Transform stress from principal to plane coordinates</span>
    <span class="c1"># Do it only for the first row since we are just</span>
    <span class="c1"># interested in the plane: sigma&#39;11 = normal traction,</span>
    <span class="c1"># sigma&#39;12 = zero, and sigma&#39;13 = max. shear traction</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">tt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">stress</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> \
        <span class="o">+</span> <span class="n">stress</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">stress</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
    
    <span class="c1"># Transform normal traction, zero shear</span>
    <span class="c1"># and max. shear traction to NED coords</span>
    <span class="n">dctt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">dctt</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dcp</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">pt</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">dctt</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
            <span class="n">dctt</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dcp</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">dctt</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
            <span class="n">dctt</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dcp</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">dctt</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
    
    <span class="c1"># Compute trend and plunge of normal traction,</span>
    <span class="c1"># zero shear, and max. shear traction on plane</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">tt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">tt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">cart_to_sph</span><span class="p">(</span><span class="n">dctt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">dctt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">dctt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
    
    <span class="k">return</span> <span class="n">tt</span><span class="p">,</span> <span class="n">dctt</span><span class="p">,</span> <span class="n">srat</span>
</pre></div>
</div>
</div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">shear_on_plane</span></code> also computes an important parameter called the principal stress ratio, <span class="math notranslate nohighlight">\(R\)</span> (<code class="docutils literal notranslate"><span class="pre">srat</span></code> in the function):</p>
<div class="math notranslate nohighlight" id="equation-ch07-eq10">
<span class="eqno">(7.10)<a class="headerlink" href="#equation-ch07-eq10" title="Permalink to this equation">#</a></span>\[
R=\frac{(\sigma_2-\sigma_1)}{(\sigma_3-\sigma_1)}
\]</div>
<p>when <span class="math notranslate nohighlight">\(R\)</span> is 1, <span class="math notranslate nohighlight">\(\sigma_2\)</span> is equal to <span class="math notranslate nohighlight">\(\sigma_3\)</span>; when <span class="math notranslate nohighlight">\(R\)</span> is 0, <span class="math notranslate nohighlight">\(\sigma_2\)</span> is equal to <span class="math notranslate nohighlight">\(\sigma_1\)</span>. This ratio is of key importance for predicting faulting and fracturing in the crust (Gephart, 1990; Morris and Ferrill, 2009). Let’s look at the influence of this parameter for the case illustrated in <a class="reference internal" href="#ch07-fig07"><span class="std std-numref">Figure 7.7</span></a>. Let’s assume <span class="math notranslate nohighlight">\(\sigma_1 = 50\)</span> MPa and <span class="math notranslate nohighlight">\(\sigma_3 = 10\)</span> MPa, and let’s vary <span class="math notranslate nohighlight">\(\sigma_2\)</span> between <span class="math notranslate nohighlight">\(\sigma_3\)</span> (<span class="math notranslate nohighlight">\(R=1\)</span>) and <span class="math notranslate nohighlight">\(\sigma_1\)</span> (<span class="math notranslate nohighlight">\(R=0\)</span>). The notebook <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/notebooks/ch7-2.ipynb">ch7-2</a> shows the solution to this problem:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

<span class="c1"># Import functions</span>
<span class="kn">from</span> <span class="nn">compgeo.shear_on_plane</span> <span class="kn">import</span> <span class="n">shear_on_plane</span>
<span class="kn">from</span> <span class="nn">compgeo.great_circle</span> <span class="kn">import</span> <span class="n">great_circle</span>
<span class="kn">from</span> <span class="nn">compgeo.st_coord_line</span> <span class="kn">import</span> <span class="n">st_coord_line</span>

<span class="c1"># Stress tensor in principal stress coordinate system</span>
<span class="c1"># start with R = 1, sigma2 = sigma3</span>
<span class="n">stress</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">]])</span>

<span class="c1"># Trend and plunge of sigma1, and trend of sigma3</span>
<span class="n">tx1</span><span class="p">,</span> <span class="n">px1</span><span class="p">,</span> <span class="n">tx3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">([</span><span class="mi">325</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">66</span><span class="p">])</span>

<span class="c1"># Plane orientation</span>
<span class="n">strike</span><span class="p">,</span> <span class="n">dip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">([</span><span class="mi">320</span><span class="p">,</span> <span class="mi">40</span><span class="p">])</span>

<span class="c1"># Number of R increments</span>
<span class="n">rinc</span> <span class="o">=</span> <span class="mi">11</span>

<span class="c1"># sigma2 increment</span>
<span class="n">sstep</span> <span class="o">=</span> <span class="p">(</span><span class="n">stress</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">stress</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">rinc</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Initialize array</span>
<span class="n">nort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">rinc</span><span class="p">)</span> <span class="c1"># normal tractions</span>
<span class="n">sht</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">rinc</span><span class="p">)</span> <span class="c1"># max. shear traction</span>
<span class="n">tsht</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">rinc</span><span class="p">)</span> <span class="c1"># trend max. shear traction</span>
<span class="n">psht</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">rinc</span><span class="p">)</span> <span class="c1"># plunge max. shear traction</span>
<span class="n">rval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">rinc</span><span class="p">)</span> <span class="c1"># R value</span>

<span class="c1"># Compute normal and shear tractions for all Rs</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">rinc</span><span class="p">):</span>
    <span class="n">stress</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">stress</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">sstep</span><span class="o">*</span><span class="n">i</span>
    
    <span class="c1"># Compute normal and maximum shear tractions on plane</span>
    <span class="n">tt</span><span class="p">,</span><span class="n">dctt</span><span class="p">,</span><span class="n">srat</span> <span class="o">=</span> <span class="n">shear_on_plane</span><span class="p">(</span><span class="n">stress</span><span class="p">,</span><span class="n">tx1</span><span class="p">,</span><span class="n">px1</span><span class="p">,</span>
                                  <span class="n">tx3</span><span class="p">,</span><span class="n">strike</span><span class="p">,</span><span class="n">dip</span><span class="p">)</span>
    <span class="c1"># Extract values</span>
    <span class="n">nort</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tt</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sht</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tt</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">tsht</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tt</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">psht</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tt</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">rval</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">srat</span>

<span class="c1"># Make a larger figure</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    
<span class="c1"># Plot fault plane and max. shear tractions</span>
<span class="c1"># orientations in a lower hemisphere, equal </span>
<span class="c1"># area stereonet</span>

<span class="c1"># Plot the primitive of the stereonet</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1"># unit radius</span>
<span class="n">th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">361</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="c1"># Plot center of circle</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;k+&quot;</span><span class="p">)</span>

<span class="c1"># Make axes equal and remove them</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>

<span class="c1"># Plot fault plane</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">great_circle</span><span class="p">(</span><span class="n">strike</span><span class="p">,</span><span class="n">dip</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">path</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">path</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span> 

<span class="c1"># Plot max. shear tractions orientations </span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">rinc</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">st_coord_line</span><span class="p">(</span><span class="n">tsht</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">psht</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s2">&quot;ks&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="mf">0.05</span><span class="p">,</span> <span class="s2">&quot;R = 1&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">rinc</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="mf">0.025</span><span class="p">,</span> <span class="s2">&quot;R = 0&quot;</span><span class="p">)</span>
    
<span class="c1"># Plot normal and shear tractions versus R</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rval</span><span class="p">,</span><span class="n">nort</span><span class="p">,</span><span class="s2">&quot;k-s&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Normal&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rval</span><span class="p">,</span><span class="n">sht</span><span class="p">,</span><span class="s2">&quot;k--s&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Shear&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Stress ratio, R&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Stress magnitude (MPa)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ch07_stress_50_0.png" src="_images/ch07_stress_50_0.png" />
</div>
</div>
<p>This is Figure 6.9 of Allmendinger et al. (2012). The stereonet shows the fault plane and the maximum shear traction for <span class="math notranslate nohighlight">\(R=0\)</span> to <span class="math notranslate nohighlight">\(1\)</span>. The graph to the right shows the variation of the normal and shear tractions with <span class="math notranslate nohighlight">\(R\)</span>. Notice that <span class="math notranslate nohighlight">\(R=0.5\)</span> gives the lowest shear traction. In one of the exercises of <a class="reference internal" href="#ch07-5"><span class="std std-ref">Section 7.5</span></a>, you will explore more the significance of the principal stress ratio.</p>
</section>
<section id="the-mohr-circle-for-stress-in-3d">
<span id="ch07-4-2"></span><h3><span class="section-number">7.4.2. </span>The Mohr circle for stress in 3D<a class="headerlink" href="#the-mohr-circle-for-stress-in-3d" title="Permalink to this headline">#</a></h3>
<p>We can also use the solution above to draw a Mohr circle for stress in 3D. Here is important to determine the sense of the maximum shear traction. According to our convention, anticlockwise shear is positive, and clockwise shear is negative. The function <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/functions/mohr_circle_stress.py">mohr_circle_stress</a> draws the Mohr circle in 3D for a given stress tensor and stress coordinate system. It also plots and outputs the normal and maximum shear tractions on a group of input planes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">compgeo.principal_stress</span> <span class="kn">import</span> <span class="n">principal_stress</span>
<span class="kn">from</span> <span class="nn">compgeo.sph_to_cart</span> <span class="kn">import</span> <span class="n">sph_to_cart</span>
<span class="kn">from</span> <span class="nn">compgeo.cart_to_sph</span> <span class="kn">import</span> <span class="n">cart_to_sph</span>
<span class="kn">from</span> <span class="nn">compgeo.pole</span> <span class="kn">import</span> <span class="n">pole_from_plane</span>


<span class="k">def</span> <span class="nf">mohr_circle_stress</span><span class="p">(</span><span class="n">stress</span><span class="p">,</span><span class="n">tx1</span><span class="p">,</span><span class="n">px1</span><span class="p">,</span><span class="n">tx3</span><span class="p">,</span><span class="n">planes</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given the stress tensor in a X1X2X3 coordinate system,</span>
<span class="sd">    and a group of n planes, mohr_circle_stress draws the Mohr</span>
<span class="sd">    Circle for stress (including the planes). It</span>
<span class="sd">    also returns the normal and max. shear tractions on the</span>
<span class="sd">    planes and their orientations</span>
<span class="sd">    </span>
<span class="sd">    ns,ons,fig,ax=mohr_circle_stress(stress,tx1,px1,tx3,planes)</span>
<span class="sd">    </span>
<span class="sd">    stress = 3 x 3 stress tensor</span>
<span class="sd">    tx1 = trend of X1</span>
<span class="sd">    px1 = plunge of X1</span>
<span class="sd">    tx3 = trend of X3</span>
<span class="sd">    planes =  n x 2 vector with strike and dip of planes</span>
<span class="sd">    ns = n x 2 vector with the normal and max. shear</span>
<span class="sd">        tractions on the planes</span>
<span class="sd">    ons = n x 4 vector with the trend and plunge of the</span>
<span class="sd">        normal traction (columns 1 and 2), and the</span>
<span class="sd">        max. shear traction (columns 3 and 4)</span>
<span class="sd">        </span>
<span class="sd">    fig and ax are handles to the figure and axes</span>
<span class="sd">    </span>
<span class="sd">    NOTE = Planes orientation follows the right hand rule</span>
<span class="sd">        Input and output angles are in radians</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># tolerance for near zero values</span>
    <span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-6</span>
    
    <span class="c1"># Compute principal stresses and their orientations</span>
    <span class="n">pstress</span><span class="p">,</span> <span class="n">dcp</span> <span class="o">=</span> <span class="n">principal_stress</span><span class="p">(</span><span class="n">stress</span><span class="p">,</span><span class="n">tx1</span><span class="p">,</span><span class="n">px1</span><span class="p">,</span><span class="n">tx3</span><span class="p">)</span>
    
    <span class="c1"># Update stress tensor to principal stresses</span>
    <span class="n">stress</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">stress</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pstress</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="c1"># Make figure</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    
    <span class="c1"># Draw sigma1-sigma3 circle</span>
    <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">stress</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">stress</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">stress</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">stress</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="n">th</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">costh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
    <span class="n">sinth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">costh</span> <span class="o">+</span> <span class="n">c</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">sinth</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s2">&quot;k-&quot;</span><span class="p">)</span>
    
    <span class="c1"># Draw sigma1-sigma2 circle</span>
    <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">stress</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">stress</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">stress</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">stress</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">costh</span> <span class="o">+</span> <span class="n">c</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">sinth</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s2">&quot;k-&quot;</span><span class="p">)</span>
    
    <span class="c1"># Draw sigma2-sigma3 circle</span>
    <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">stress</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">stress</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">stress</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">stress</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">costh</span> <span class="o">+</span> <span class="n">c</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">sinth</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s2">&quot;k-&quot;</span><span class="p">)</span>
    
    <span class="c1"># Initialize pole to plane</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="c1"># Initialize vectors with normal and</span>
    <span class="c1"># max. shear tractions</span>
    <span class="n">ns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">planes</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">ons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">planes</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">4</span><span class="p">))</span>
    
    <span class="c1"># Compute normal and max. shear tractions</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">planes</span><span class="p">,</span><span class="mi">0</span><span class="p">)):</span>
        
        <span class="c1"># Calculate direction cosines of pole to plane</span>
        <span class="n">trd</span><span class="p">,</span> <span class="n">plg</span> <span class="o">=</span> <span class="n">pole_from_plane</span><span class="p">(</span><span class="n">planes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">planes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">sph_to_cart</span><span class="p">(</span><span class="n">trd</span><span class="p">,</span> <span class="n">plg</span><span class="p">)</span>
        
        <span class="c1"># trend and plunge of pole = dir. normal traction</span>
        <span class="n">ons</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">ons</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">trd</span><span class="p">,</span> <span class="n">plg</span>
        
        <span class="c1"># transform pole to  principal stress coordinates</span>
        <span class="n">pt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">pt</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">dcp</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">pt</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        
        <span class="c1"># Calculate the tractions in principal stress</span>
        <span class="c1"># coordinates</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">t</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">stress</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">pt</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        
        <span class="c1"># Find the b and s axes</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">pt</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    
        <span class="c1"># Transformation matrix from principal</span>
        <span class="c1"># stress coordinates to plane coordinates</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">pt</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">b</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">s</span>
        
        <span class="c1"># normal and max. shear tractions</span>
        <span class="n">ns</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">stress</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">stress</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>\
            <span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="n">stress</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">ns</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">stress</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">stress</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>\
            <span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="n">stress</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
        
        <span class="c1"># Calculate direction cosines of max.</span>
        <span class="c1"># shear traction with respect to NED</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">ds</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">dcp</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">ds</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        
        <span class="c1"># trend and plunge of max. shear traction</span>
        <span class="n">ons</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">ons</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">cart_to_sph</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ds</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        
        <span class="c1"># Cross product of pole and max. shear traction</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">ds</span><span class="p">)</span>
        
        <span class="c1"># Make clockwise shear traction negative</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ps</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span> <span class="c1"># Dip slip</span>
            <span class="k">if</span> <span class="n">ds</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span> <span class="c1"># Normal slip</span>
                <span class="k">if</span> <span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">pt</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
                    <span class="n">ns</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1.0</span>
            <span class="k">else</span><span class="p">:</span>   <span class="c1"># Reverse slip</span>
                <span class="k">if</span> <span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">pt</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">:</span>
                    <span class="n">ns</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1.0</span>
        <span class="k">else</span><span class="p">:</span>   <span class="c1"># Oblique slip</span>
            <span class="k">if</span> <span class="n">ps</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">ns</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1.0</span>
    
    <span class="c1"># Plot planes</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ns</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">ns</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s2">&quot;ks&quot;</span><span class="p">)</span>
    
    <span class="c1"># Make axes equal and plot grid</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span> <span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    
    <span class="c1"># Move x-axis to center and y-axis to origin</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="s2">&quot;zero&quot;</span><span class="p">)</span>
    
    <span class="c1"># Eliminate upper and right axes</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
    
    <span class="c1"># show ticks in the left and lower axes only</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
    
    <span class="c1"># Add labels at end of axes</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\sigma$&quot;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\tau$&quot;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">ns</span><span class="p">,</span> <span class="n">ons</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s use this function to solve the following problem: <span class="math notranslate nohighlight">\(\sigma_1\)</span>, <span class="math notranslate nohighlight">\(\sigma_2\)</span>, and <span class="math notranslate nohighlight">\(\sigma_3\)</span> are 50, 30, and 10 MPa, respectively. <span class="math notranslate nohighlight">\(\sigma_1\)</span> is horizontal and trends E-W, while <span class="math notranslate nohighlight">\(\sigma_3\)</span> is vertical. Plot on the Mohr circle the tractions on the following planes (RHR): 000/30, 000/45, 000/60, 180/30, 180/45, 180/60, 045/30, 045/45, 045/60, 135/30, 135/45 and 135/60. The notebook <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/notebooks/ch7-3.ipynb">ch7-3</a> shows the solution to this problem:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

<span class="c1"># Import mohr_circle_stress</span>
<span class="kn">from</span> <span class="nn">compgeo.mohr_circle_stress</span> <span class="kn">import</span> <span class="n">mohr_circle_stress</span>


<span class="c1"># Stress tensor in principal stress coordinate system</span>
<span class="n">stress</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">]])</span>

<span class="c1"># Trend and plunge of sigma1, and trend of sigma3</span>
<span class="n">tx1</span><span class="p">,</span> <span class="n">px1</span><span class="p">,</span> <span class="n">tx3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">([</span><span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span>

<span class="c1"># Planes</span>
<span class="n">planes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">12</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># Strikes in degrees</span>
<span class="n">planes</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">planes</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">180</span>
<span class="n">planes</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">45</span>
<span class="n">planes</span><span class="p">[</span><span class="mi">9</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">135</span>

<span class="c1"># Dips in degrees</span>
<span class="n">planes</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">planes</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">45</span>
<span class="n">planes</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">60</span>

<span class="c1"># Convert to radians</span>
<span class="n">planes</span> <span class="o">=</span> <span class="n">planes</span> <span class="o">*</span> <span class="n">pi</span><span class="o">/</span><span class="mi">180</span>
 
<span class="c1"># Plot Mohr circle</span>
<span class="n">ns</span><span class="p">,</span> <span class="n">ons</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">mohr_circle_stress</span><span class="p">(</span><span class="n">stress</span><span class="p">,</span><span class="n">tx1</span><span class="p">,</span><span class="n">px1</span><span class="p">,</span><span class="n">tx3</span><span class="p">,</span><span class="n">planes</span><span class="p">)</span>

<span class="c1"># Print normal and shear tractions</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Strike&quot;</span><span class="p">,</span><span class="s2">&quot;Dip&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\u03C3</span><span class="s2">&quot;</span><span class="p">,</span><span class="s2">&quot;Trend&quot;</span><span class="p">,</span><span class="s2">&quot;Plunge&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\u03C4</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="s2">&quot;Trend&quot;</span><span class="p">,</span><span class="s2">&quot;Plunge&quot;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># return to degrees</span>
<span class="n">planes</span> <span class="o">=</span> <span class="n">planes</span> <span class="o">*</span> <span class="mi">180</span><span class="o">/</span><span class="n">pi</span>
<span class="n">ons</span> <span class="o">=</span> <span class="n">ons</span> <span class="o">*</span> <span class="mi">180</span><span class="o">/</span><span class="n">pi</span>

<span class="c1"># print</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">planes</span><span class="p">,</span><span class="mi">0</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">planes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">planes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ns</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ons</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ons</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ns</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ons</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ons</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
          <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Strike	Dip	σ	Trend	Plunge	τ	Trend	Plunge
0.0	30.0	20.00	270.0	60.0	17.32	270.0	-30.0
0.0	45.0	30.00	270.0	45.0	20.00	270.0	-45.0
0.0	60.0	40.00	270.0	30.0	17.32	270.0	-60.0
180.0	30.0	20.00	90.0	60.0	-17.32	90.0	-30.0
180.0	45.0	30.00	90.0	45.0	-20.00	90.0	-45.0
180.0	60.0	40.00	90.0	30.0	-17.32	90.0	-60.0
45.0	30.0	17.50	315.0	60.0	-13.92	291.0	-27.8
45.0	45.0	25.00	315.0	45.0	-16.58	281.3	-39.8
45.0	60.0	32.50	315.0	30.0	-15.61	261.9	-46.1
135.0	30.0	17.50	45.0	60.0	13.92	69.0	-27.8
135.0	45.0	25.00	45.0	45.0	16.58	78.7	-39.8
135.0	60.0	32.50	45.0	30.0	15.61	98.1	-46.1
</pre></div>
</div>
<img alt="_images/ch07_stress_55_1.png" src="_images/ch07_stress_55_1.png" />
</div>
</div>
<p>N-S planes parallel to <span class="math notranslate nohighlight">\(\sigma_2\)</span> plot on the <span class="math notranslate nohighlight">\(\sigma_1\)</span>-<span class="math notranslate nohighlight">\(\sigma_3\)</span> circle. Planes dipping east show positive, anticlockwise shear, while planes dipping west show negative, clockwise shear. Another way to visualize this is using the pole to planes, <span class="math notranslate nohighlight">\(O_P\)</span>. With <span class="math notranslate nohighlight">\(\sigma_1\)</span> horizontal and <span class="math notranslate nohighlight">\(\sigma_3\)</span> vertical, <span class="math notranslate nohighlight">\(O_P\)</span> is at <span class="math notranslate nohighlight">\(\sigma_1\)</span> (<a class="reference internal" href="#ch07-fig05"><span class="std std-numref">Figure 7.5</span></a>). From <span class="math notranslate nohighlight">\(O_P\)</span> you can trace N-S planes of any dip to the E or W, and verify that E dipping planes have anticlockwise shear, while W dipping planes have clockwise shear. Planes non-parallel to <span class="math notranslate nohighlight">\(\sigma_2\)</span> are more difficult to visualize. On the NE planes dipping to the SE the shear tractions are clockwise, while on the SE planes dipping to the SW the shear tractions are anticlockwise. These planes plot inside the <span class="math notranslate nohighlight">\(\sigma_1\)</span>-<span class="math notranslate nohighlight">\(\sigma_3\)</span> circle but outside the <span class="math notranslate nohighlight">\(\sigma_2\)</span>-<span class="math notranslate nohighlight">\(\sigma_3\)</span> and <span class="math notranslate nohighlight">\(\sigma_1\)</span>-<span class="math notranslate nohighlight">\(\sigma_2\)</span> circles (in fact no plane will plot inside these internal circles).</p>
</section>
</section>
<section id="exercises">
<span id="ch07-5"></span><h2><span class="section-number">7.5. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">#</a></h2>
<ol class="simple">
<li><p>This is exercise 6 in chapter 6 of Allmendinger et al. (2012): In the Oseberg field, North Sea, the principal stresses are oriented <span class="math notranslate nohighlight">\(\sigma_1\)</span> = 080/00, <span class="math notranslate nohighlight">\(\sigma_2\)</span> = 000/90, and <span class="math notranslate nohighlight">\(\sigma_3\)</span> = 170/00. If at 2 km depth, <span class="math notranslate nohighlight">\(\sigma_1\)</span> = 50 MPa, <span class="math notranslate nohighlight">\(\sigma_2\)</span> = 40 MPa, and <span class="math notranslate nohighlight">\(\sigma_3\)</span> = 30 MPa, what are the normal and shear tractions on a plane oriented 040/65 (RHR)?</p></li>
</ol>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Use function <code class="docutils literal notranslate"><span class="pre">shear_on_plane</span></code>.</p>
</div>
<ol class="simple">
<li><p>Morris and Ferrill (2009) discuss the importance of the intermediate principal stress, <span class="math notranslate nohighlight">\(\sigma_2\)</span>, for faulting. Let’s look at their first example: The maximum and minimum principal stresses are 95 MPa and 25 MPa, respectively. <span class="math notranslate nohighlight">\(\sigma_1\)</span> is vertical and <span class="math notranslate nohighlight">\(\sigma_3\)</span> is horizontal and trends E-W. Compute the normal and maximum shear tractions acting on three planes with orientation (RHR) 180/45, 090/45 and 135/45, and for principal stress ratios, <span class="math notranslate nohighlight">\(R\)</span>, between 0 and 1. Display your results graphically in a lower hemisphere equal area stereonet showing the maximum shear directions on the planes, and a graph of <span class="math notranslate nohighlight">\(R\)</span> versus the normal and maximum shear tractions. How do these tractions vary with <span class="math notranslate nohighlight">\(R\)</span> on the N-S and E-W planes? How do they vary on the SE-NW plane?</p></li>
</ol>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>This problem is similar to the notebook <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/notebooks/ch7-2.ipynb">ch7-2</a>. Modify the notebook for the new stress and the three planes. Use different colors for the planes.</p>
</div>
<ol>
<li><p>The slip tendency is the ratio of the maximum shear traction to the normal traction on a plane (<span class="math notranslate nohighlight">\(S_t=\tau/\sigma\)</span>). It is a proxy for the tendency of a surface to undergo slip under a given stress field (Morris et al., 1996). Write a Python function that for a given stress tensor and stress coordinate system, plots a lower hemisphere equal area stereonet and a Mohr circle colored by slip tendency. The function should work as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">slip_tendency(stress,tx1,px1,tx3)</span></code></p>
<p>where <code class="docutils literal notranslate"><span class="pre">stress</span></code> is the stress tensor, <code class="docutils literal notranslate"><span class="pre">tx1</span></code> and <code class="docutils literal notranslate"><span class="pre">px1</span></code> are the trend and plunge of <span class="math notranslate nohighlight">\(\mathbf{X_1}\)</span>, and <code class="docutils literal notranslate"><span class="pre">tx3</span></code> is the trend of <span class="math notranslate nohighlight">\(\mathbf{X_3}\)</span>. Use the function to graph the slip tendency for the stress tensor in the notebook <a class="reference external" href="https://github.com/nfcd/compGeo/blob/master/source/notebooks/ch7-3.ipynb">ch7-3</a>. <a class="reference internal" href="#ch07-fig08"><span class="std std-numref">Figure 7.8</span></a> shows how the output of the function should look like. Based on your results, at which dip angle would you expect the N-S to slip? Will planes with the maximum possible shear traction (<span class="math notranslate nohighlight">\(\sigma_1-\sigma_3\)</span>) slip?</p>
<figure class="align-default" id="ch07-fig08">
<a class="reference internal image-reference" href="_images/ch07_fig08.png"><img alt="_images/ch07_fig08.png" src="_images/ch07_fig08.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 7.8 </span><span class="caption-text">Slip tendency for the stress tnesor in the notebook [[ch7-3]]. Left is lower hemisphere equal area stereonet, and right is Mohr circle. Figure made with the program [[<code class="docutils literal notranslate"><span class="pre">GeoKalk</span></code>]] by Nestor Cardozo.</span><a class="headerlink" href="#ch07-fig08" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Use the function <code class="docutils literal notranslate"><span class="pre">mohr_circle_stress</span></code> as the base of your new function. In the new function, calculate the normal and shear tractions on a set of planes varying in strike from 0 to 360and dip from 0 to 90. A 1increment in strike and dip is sufficient. Plot each pole colored by slip tendency on a stereonet and a Mohr circle. Use a color scale bar similar to <a class="reference internal" href="#ch07-fig08"><span class="std std-numref">Figure 7.8</span></a>. Since you will be handling about 30,000 planes and since the direction and sense of the maximum shear traction in this case are not relevant, you can consider calculating the normal and maximum shear tractions using Eq. <a class="reference internal" href="#equation-ch07-eq06">(7.6)</a>.</p>
</div>
</li>
</ol>
</section>
<section id="references">
<span id="ch07-6"></span><h2><span class="section-number">7.6. </span>References<a class="headerlink" href="#references" title="Permalink to this headline">#</a></h2>
<p>Allmendinger, R.W., Cardozo, N. and Fisher, D.M. 2012. Structural
Geology Algorithms: Vectors and Tensors. Cambridge University Press.</p>
<p>Gephart, J.W. 1990. Stress and the direction of slip on fault planes.
Tectonics 9, 845-858.</p>
<p>Marshak, S. and Mitra, G. 1988. Basic Methods of Structural Geology.
Prentice Hall.</p>
<p>Morris, A.P., Ferrill, D.A. and Henderson, D.B. 1996. Slip-tendency
analysis and fault reactivation. Geology 24, 275-278.</p>
<p>Morris, A.P. and Ferrill, D.A. 2009. The importance of the effective
intermediate principal stress (<span class="math notranslate nohighlight">\(\sigma'_2\)</span>) to fault slip patterns.
Journal of Structural Geology 31, 950-959.</p>
<p>Ragan, D.M. 2009. Structural Geology: An Introduction to Geometrical
Techniques. Cambridge University Press.</p>
<p>Ramsay, J.G. 1967. Folding and Fracturing of Rocks. McGraw-Hill, New
York.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="ch06_tensors.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">6. </span>Tensors</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="ch08_strain.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">8. </span>Strain</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Nestor Cardozo & Alex F. Antunes<br/>
  
      &copy; Copyright 2023.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>